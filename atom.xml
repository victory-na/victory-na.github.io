<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>中系少女豆瓣酱</title>
  
  <subtitle>[object Object]</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-02-28T01:50:05.821Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>中系少女豆瓣酱</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>基于element开发穿梭树</title>
    <link href="http://example.com/2024/02/01/%E5%9F%BA%E4%BA%8Eelement%E5%BC%80%E5%8F%91%E7%A9%BF%E6%A2%AD%E6%A0%91/"/>
    <id>http://example.com/2024/02/01/%E5%9F%BA%E4%BA%8Eelement%E5%BC%80%E5%8F%91%E7%A9%BF%E6%A2%AD%E6%A0%91/</id>
    <published>2024-02-01T11:36:30.000Z</published>
    <updated>2024-02-28T01:50:05.821Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基于element开发穿梭树"><a href="#基于element开发穿梭树" class="headerlink" title="基于element开发穿梭树"></a><strong>基于element开发穿梭树</strong></h1><blockquote><p><img src="https://cdn.nlark.com/yuque/0/2024/png/38618045/1706671465497-63fa63f7-706e-442a-abb7-662ec84c0f69.png#averageHue=%230e396c&clientId=ub0fcd40e-6a86-4&from=paste&height=307&id=u8d1c9802&originHeight=307&originWidth=569&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65211&status=done&style=none&taskId=u9f2f698f-ddb2-4674-a476-23853731d51&title=&width=569" alt="image.png"><br>需求：开发左侧是树形列表，可搜索可选择，通过加入右侧添加到右侧列表，右侧列表选中加入左侧删除右侧逸轩数据</p></blockquote><h2 id="一、开发左边搜索以及树形列表"><a href="#一、开发左边搜索以及树形列表" class="headerlink" title="一、开发左边搜索以及树形列表"></a>一、开发左边搜索以及树形列表</h2><p>通过element组件el-tree开发树形图，树形filter-node-method进行数据过滤实现搜索功能</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">  &lt;!-- 左边html --&gt;</span><br><span class="line">  &lt;div class=&quot;leftTree&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;list&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;left_lowline&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;left_title&quot;&gt;用户列表&lt;/p&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 搜索 --&gt;</span><br><span class="line">      &lt;div class=&quot;left_input&quot;&gt;</span><br><span class="line">        &lt;el-input</span><br><span class="line">          v-model=&quot;filterText&quot;</span><br><span class="line">          class=&quot;w-50 m-2&quot;</span><br><span class="line">          placeholder=&quot;搜索&quot;</span><br><span class="line">          clearable</span><br><span class="line">          icon=&quot;el-icon-search&quot;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;el-button</span><br><span class="line">            slot=&quot;append&quot;</span><br><span class="line">            type=&quot;primary&quot;</span><br><span class="line">            size=&quot;small&quot;</span><br><span class="line">            @click=&quot;search(filterText)&quot;</span><br><span class="line">            &gt;搜索&lt;/el-button</span><br><span class="line">          &gt;</span><br><span class="line">        &lt;/el-input&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;el-tree</span><br><span class="line">        ref=&quot;treeRef&quot;</span><br><span class="line">        :data=&quot;fromData&quot;</span><br><span class="line">        show-checkbox</span><br><span class="line">        :node-key=&quot;nodeKey&quot;</span><br><span class="line">        highlight-current</span><br><span class="line">        :props=&quot;defaultProps&quot;</span><br><span class="line">        v-slot=&quot;&#123; node, data &#125;&quot;</span><br><span class="line">        :filter-node-method=&quot;filterNode&quot;</span><br><span class="line">      &gt;</span><br><span class="line">        &lt;!-- &lt;div&gt;&#123;&#123; data.corgName &#125;&#125; // 父节点&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;&#123;&#123; data.userName &#125;&#125; // 子节点&lt;/div&gt; --&gt;</span><br><span class="line">        &#123;&#123; data[defaultProps.label] &#125;&#125;</span><br><span class="line">      &lt;/el-tree&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  // 左边js</span><br><span class="line">search(val) &#123;</span><br><span class="line">    this.$refs.treeRef.filter(val);</span><br><span class="line">  &#125;,</span><br><span class="line">  filterNode(value, data) &#123;</span><br><span class="line">    if (!value) return true;</span><br><span class="line">    return data.label.indexOf(value) !== -1;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><h2 id="二、中间按钮开发"><a href="#二、中间按钮开发" class="headerlink" title="二、中间按钮开发"></a>二、中间按钮开发</h2><p>穿梭框的主要功能在中间按钮上面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 中间按钮 --&gt;</span><br><span class="line">   &lt;div class=&quot;btnDiv&quot;&gt;</span><br><span class="line">     &lt;div class=&quot;mg-20&quot; @click=&quot;toRight()&quot;&gt;</span><br><span class="line">       &lt;el-button type=&quot;primary&quot; size=&quot;small&quot;</span><br><span class="line">         &gt;加入右侧 &lt;i class=&quot;el-icon-arrow-right el-icon--right&quot;&gt;&lt;/i</span><br><span class="line">       &gt;&lt;/el-button&gt;</span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">     &lt;div class=&quot;mg-20&quot; @click=&quot;toLeft()&quot;&gt;</span><br><span class="line">       &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;</span><br><span class="line">         &gt;加入左侧 &lt;i class=&quot;el-icon-arrow-left el-icon--right&quot;&gt;&lt;/i</span><br><span class="line">       &gt;&lt;/el-button&gt;</span><br><span class="line">     &lt;/div&gt;</span><br><span class="line">   &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   // 去右边</span><br><span class="line">   toRight() &#123;</span><br><span class="line">     // 获取树形点击数据</span><br><span class="line">     const checkNodes = this.$refs.treeRef.getCheckedNodes(true, false);</span><br><span class="line">     const newArr = this.toData.concat(checkNodes);</span><br><span class="line">     let obj = &#123;&#125;;</span><br><span class="line">     let peon = newArr.reduce((cur, next) =&gt; &#123;</span><br><span class="line">       obj[next[this.nodeKey]]</span><br><span class="line">         ? &quot;&quot;</span><br><span class="line">         : (obj[next[this.nodeKey]] = true &amp;&amp; cur.push(next));</span><br><span class="line">       return cur;</span><br><span class="line">     &#125;, []); // 设置cur默认类型为数组，并且初始值为空的数组</span><br><span class="line">     console.log(peon);</span><br><span class="line">     this.toData = peon;</span><br><span class="line">     this.$refs.treeRef.setCheckedKeys([], false);</span><br><span class="line">     this.checkVal();</span><br><span class="line">     this.fromData.forEach((item) =&gt; &#123;</span><br><span class="line">       item.children.forEach((left) =&gt; &#123;</span><br><span class="line">         this.toData.forEach((right) =&gt; &#123;</span><br><span class="line">           if (left.id == right.id) &#123;</span><br><span class="line">             // 已选的不可重复勾选</span><br><span class="line">             left.disabled = true;</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;);</span><br><span class="line">       &#125;);</span><br><span class="line">     &#125;);</span><br><span class="line">   &#125;,</span><br><span class="line">   // 去左边</span><br><span class="line">   toLeft() &#123;</span><br><span class="line">     for (var i = 0; i &lt; this.toData.length; i++) &#123;</span><br><span class="line">       if (this.toData[i].active) &#123;</span><br><span class="line">         this.toData[i].active = false;</span><br><span class="line">         this.toData.splice(i, 1);</span><br><span class="line">         i -= 1;</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     this.fromData.forEach((item) =&gt; &#123;</span><br><span class="line">       item.children.forEach((left) =&gt; &#123;</span><br><span class="line">         left.disabled = false;</span><br><span class="line">         this.toData.forEach((right) =&gt; &#123;</span><br><span class="line">           if (left.id == right.id) &#123;</span><br><span class="line">             left.disabled = false;</span><br><span class="line">           &#125;</span><br><span class="line">         &#125;);</span><br><span class="line">       &#125;);</span><br><span class="line">     &#125;);</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure><h2 id="三、右侧列表渲染"><a href="#三、右侧列表渲染" class="headerlink" title="三、右侧列表渲染"></a>三、右侧列表渲染</h2><p>右侧主要是选择数据list渲染</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 右边 --&gt;</span><br><span class="line">    &lt;div class=&quot;rightTree&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;list&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;left_lowline&quot;&gt;</span><br><span class="line">          &lt;p class=&quot;left_title&quot;&gt;已选列表&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;mg-10&quot;&gt;</span><br><span class="line">          &lt;div</span><br><span class="line">            class=&quot;right_item&quot;</span><br><span class="line">            :class=&quot;[&#x27;item&#x27;, &#123; active: item.active &#125;]&quot;</span><br><span class="line">            v-for=&quot;(item, index) in toData&quot;</span><br><span class="line">            :key=&quot;index&quot;</span><br><span class="line">          &gt;</span><br><span class="line">            &lt;el-checkbox v-model=&quot;item.active&quot;&gt;&#123;&#123;</span><br><span class="line">              item[defaultProps.label]</span><br><span class="line">            &#125;&#125;&lt;/el-checkbox&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure><h2 id="四、全部代码"><a href="#四、全部代码" class="headerlink" title="四、全部代码"></a>四、全部代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- // 封装组件 --&gt;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;tree-transfer pdb-30&quot;&gt;</span><br><span class="line">    &lt;!-- 左边 --&gt;</span><br><span class="line">    &lt;div class=&quot;leftTree&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;list&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;left_lowline&quot;&gt;</span><br><span class="line">          &lt;p class=&quot;left_title&quot;&gt;用户列表&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 搜索 --&gt;</span><br><span class="line">        &lt;div class=&quot;left_input&quot;&gt;</span><br><span class="line">          &lt;el-input</span><br><span class="line">            v-model=&quot;filterText&quot;</span><br><span class="line">            class=&quot;w-50 m-2&quot;</span><br><span class="line">            placeholder=&quot;搜索&quot;</span><br><span class="line">            clearable</span><br><span class="line">            icon=&quot;el-icon-search&quot;</span><br><span class="line">            &gt;</span><br><span class="line">            &lt;el-button</span><br><span class="line">              slot=&quot;append&quot;</span><br><span class="line">              type=&quot;primary&quot;</span><br><span class="line">              size=&quot;small&quot;</span><br><span class="line">              @click=&quot;search(filterText)&quot;</span><br><span class="line">              &gt;搜索&lt;/el-button</span><br><span class="line">                   &gt;</span><br><span class="line">          &lt;/el-input&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;el-tree</span><br><span class="line">          ref=&quot;treeRef&quot;</span><br><span class="line">          :data=&quot;fromData&quot;</span><br><span class="line">          show-checkbox</span><br><span class="line">          :node-key=&quot;nodeKey&quot;</span><br><span class="line">          highlight-current</span><br><span class="line">          :props=&quot;defaultProps&quot;</span><br><span class="line">          v-slot=&quot;&#123; node, data &#125;&quot;</span><br><span class="line">          :filter-node-method=&quot;filterNode&quot;</span><br><span class="line">          &gt;</span><br><span class="line">          &#123;&#123; data[defaultProps.label] &#125;&#125;</span><br><span class="line">        &lt;/el-tree&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 中间按钮 --&gt;</span><br><span class="line">    &lt;div class=&quot;btnDiv&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;mg-20&quot; @click=&quot;toRight()&quot;&gt;</span><br><span class="line">        &lt;el-button type=&quot;primary&quot; size=&quot;small&quot;</span><br><span class="line">          &gt;加入右侧 &lt;i class=&quot;el-icon-arrow-right el-icon--right&quot;&gt;&lt;/i</span><br><span class="line">                                                                &gt;&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;mg-20&quot; @click=&quot;toLeft()&quot;&gt;</span><br><span class="line">        &lt;el-button size=&quot;small&quot; type=&quot;primary&quot;</span><br><span class="line">          &gt;加入左侧 &lt;i class=&quot;el-icon-arrow-left el-icon--right&quot;&gt;&lt;/i</span><br><span class="line">                                                               &gt;&lt;/el-button&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 右边 --&gt;</span><br><span class="line">    &lt;div class=&quot;rightTree&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;list&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;left_lowline&quot;&gt;</span><br><span class="line">          &lt;p class=&quot;left_title&quot;&gt;已选列表&lt;/p&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;mg-10&quot;&gt;</span><br><span class="line">          &lt;div</span><br><span class="line">            class=&quot;right_item&quot;</span><br><span class="line">            :class=&quot;[&#x27;item&#x27;, &#123; active: item.active &#125;]&quot;</span><br><span class="line">            v-for=&quot;(item, index) in toData&quot;</span><br><span class="line">            :key=&quot;index&quot;</span><br><span class="line">            &gt;</span><br><span class="line">            &lt;el-checkbox v-model=&quot;item.active&quot;&gt;&#123;&#123;</span><br><span class="line">              item[defaultProps.label]</span><br><span class="line">              &#125;&#125;&lt;/el-checkbox&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    props: &#123;</span><br><span class="line">      nodeKey: &#123;</span><br><span class="line">        type: String,</span><br><span class="line">        default: () =&gt; &#123;</span><br><span class="line">          return &quot;&quot;;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      fromData: &#123;</span><br><span class="line">        type: Array,</span><br><span class="line">        default: () =&gt; &#123;</span><br><span class="line">          return [</span><br><span class="line">            &#123;</span><br><span class="line">              label: &quot;一级 1&quot;,</span><br><span class="line">              id: 1,</span><br><span class="line">              children: [</span><br><span class="line">                &#123;</span><br><span class="line">                  id: 2,</span><br><span class="line">                  label: &quot;二级 1-1&quot;,</span><br><span class="line">                  children: [</span><br><span class="line">                    &#123;</span><br><span class="line">                      id: 3,</span><br><span class="line">                      label: &quot;三级 1-1-1&quot;,</span><br><span class="line">                    &#125;,</span><br><span class="line">                  ],</span><br><span class="line">                &#125;,</span><br><span class="line">              ],</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              id: 4,</span><br><span class="line">              label: &quot;一级 2&quot;,</span><br><span class="line">              children: [</span><br><span class="line">              &#123;</span><br><span class="line">                id: 5,</span><br><span class="line">                label: &quot;二级 2-1&quot;,</span><br><span class="line">                children: [</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: 6,</span><br><span class="line">                    label: &quot;三级 2-1-1&quot;,</span><br><span class="line">                  &#125;,</span><br><span class="line">                ],</span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                id: 7,</span><br><span class="line">                label: &quot;二级 2-2&quot;,</span><br><span class="line">                children: [</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: 8,</span><br><span class="line">                    label: &quot;三级 2-2-1&quot;,</span><br><span class="line">                  &#125;,</span><br><span class="line">                ],</span><br><span class="line">              &#125;,</span><br><span class="line">            ],</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            id: 9,</span><br><span class="line">            label: &quot;一级 3&quot;,</span><br><span class="line">            children: [</span><br><span class="line">              &#123;</span><br><span class="line">                id: 10,</span><br><span class="line">                label: &quot;二级 3-1&quot;,</span><br><span class="line">                children: [</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: 11,</span><br><span class="line">                    label: &quot;三级 3-1-1&quot;,</span><br><span class="line">                  &#125;,</span><br><span class="line">                ],</span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                id: 12,</span><br><span class="line">                label: &quot;二级 3-2&quot;,</span><br><span class="line">                children: [</span><br><span class="line">                  &#123;</span><br><span class="line">                    id: 13,</span><br><span class="line">                    label: &quot;三级 3-2-1&quot;,</span><br><span class="line">                  &#125;,</span><br><span class="line">                ],</span><br><span class="line">              &#125;,</span><br><span class="line">            ],</span><br><span class="line">          &#125;,</span><br><span class="line">        ];</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    defaultProps: &#123;</span><br><span class="line">      type: Object,</span><br><span class="line">      default: () =&gt; &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          children: &quot;children&quot;,</span><br><span class="line">          label: &quot;label&quot;,</span><br><span class="line">          disabled: &quot;disabled&quot;,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      filterText: &quot;&quot;,</span><br><span class="line">      toData: [],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;&#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    // 去右边</span><br><span class="line">    toRight() &#123;</span><br><span class="line">      const checkNodes = this.$refs.treeRef.getCheckedNodes(true, false);</span><br><span class="line">      console.log(checkNodes);</span><br><span class="line">      const newArr = this.toData.concat(checkNodes);</span><br><span class="line">      let obj = &#123;&#125;;</span><br><span class="line">      let peon = newArr.reduce((cur, next) =&gt; &#123;</span><br><span class="line">        obj[next[this.nodeKey]]</span><br><span class="line">          ? &quot;&quot;</span><br><span class="line">          : (obj[next[this.nodeKey]] = true &amp;&amp; cur.push(next));</span><br><span class="line">        return cur;</span><br><span class="line">      &#125;, []); // 设置cur默认类型为数组，并且初始值为空的数组</span><br><span class="line">      console.log(peon);</span><br><span class="line">      this.toData = peon;</span><br><span class="line">      this.$refs.treeRef.setCheckedKeys([], false);</span><br><span class="line">      this.checkVal();</span><br><span class="line"></span><br><span class="line">      this.fromData.forEach((item) =&gt; &#123;</span><br><span class="line">        item.children.forEach((left) =&gt; &#123;</span><br><span class="line">          this.toData.forEach((right) =&gt; &#123;</span><br><span class="line">            if (left.id == right.id) &#123;</span><br><span class="line">              // 已选的不可重复勾选</span><br><span class="line">              left.disabled = true;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // 去左边</span><br><span class="line">    toLeft() &#123;</span><br><span class="line">      for (var i = 0; i &lt; this.toData.length; i++) &#123;</span><br><span class="line">        if (this.toData[i].active) &#123;</span><br><span class="line">          this.toData[i].active = false;</span><br><span class="line">          this.toData.splice(i, 1);</span><br><span class="line">          i -= 1;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      this.checkVal();</span><br><span class="line"></span><br><span class="line">      this.fromData.forEach((item) =&gt; &#123;</span><br><span class="line">        item.children.forEach((left) =&gt; &#123;</span><br><span class="line">          left.disabled = false;</span><br><span class="line">          this.toData.forEach((right) =&gt; &#123;</span><br><span class="line">            if (left.id == right.id) &#123;</span><br><span class="line">              left.disabled = false;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // 右侧item点击</span><br><span class="line">    checkNode(item) &#123;</span><br><span class="line">      item.active = !item.active;</span><br><span class="line">    &#125;,</span><br><span class="line">    // 返回父组件</span><br><span class="line">    checkVal() &#123;</span><br><span class="line">      this.$emit(&quot;checkVal&quot;, this.toData);</span><br><span class="line">    &#125;,</span><br><span class="line">    search(val) &#123;</span><br><span class="line">      this.$refs.treeRef.filter(val);</span><br><span class="line">    &#125;,</span><br><span class="line">    filterNode(value, data) &#123;</span><br><span class="line">      if (!value) return true;</span><br><span class="line">      return data.label.indexOf(value) !== -1;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    if (this.toData.length &gt; 0) &#123;</span><br><span class="line">      this.toData = this.$refs.treeRef.getCheckedNodes(false, false);</span><br><span class="line">      this.$refs.treeRef.setCheckedKeys([], false);</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(this);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.tree-transfer &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  align-items: center;</span><br><span class="line">  justify-content: center;</span><br><span class="line">  .leftTree,</span><br><span class="line">  .rightTree &#123;</span><br><span class="line">    border: 1px solid #2a94fd;</span><br><span class="line">    height: 330px;</span><br><span class="line">    width: 250px;</span><br><span class="line">    background: #062f5b;</span><br><span class="line">  &#125;</span><br><span class="line">  .left_lowline &#123;</span><br><span class="line">    padding: 10px;</span><br><span class="line">    background: #2a94fd;</span><br><span class="line">    color: #fff;</span><br><span class="line">  &#125;</span><br><span class="line">  .left_input &#123;</span><br><span class="line">    margin: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">  .el-tree &#123;</span><br><span class="line">    margin: 10px;</span><br><span class="line">    background: transparent;</span><br><span class="line">    color: #fff;</span><br><span class="line">    height: 180px;</span><br><span class="line">    overflow-y: scroll;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .right_item &#123;</span><br><span class="line">    margin: 10px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.tree-transfer &#123;</span><br><span class="line">  .el-tree-node:focus &gt; .el-tree-node__content,</span><br><span class="line">  .el-tree--highlight-current .el-tree-node.is-current &gt; .el-tree-node__content,</span><br><span class="line">  .el-tree-node__content:hover,</span><br><span class="line">  .el-upload-list__item:hover &#123;</span><br><span class="line">    background-color: #000000 !important;</span><br><span class="line">  &#125;</span><br><span class="line">  .el-checkbox__label &#123;</span><br><span class="line">    color: #fff !important;</span><br><span class="line">  &#125;</span><br><span class="line">  .el-input-group__append,</span><br><span class="line">  .el-input-group__prepend &#123;</span><br><span class="line">    background-color: #2a94fd !important;</span><br><span class="line">    color: #ffffff !important;</span><br><span class="line">    border: 1px solid #2a94fd !important;</span><br><span class="line">  &#125;</span><br><span class="line">  .el-checkbox__inner &#123;</span><br><span class="line">    border: 1px solid #2a94fd;</span><br><span class="line">    background: transparent;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基于element开发穿梭树&quot;&gt;&lt;a href=&quot;#基于element开发穿梭树&quot; class=&quot;headerlink&quot; title=&quot;基于element开发穿梭树&quot;&gt;&lt;/a&gt;&lt;strong&gt;基于element开发穿梭树&lt;/strong&gt;&lt;/h1&gt;&lt;blockqu</summary>
      
    
    
    
    <category term="element" scheme="http://example.com/categories/element/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="element" scheme="http://example.com/tags/element/"/>
    
  </entry>
  
  <entry>
    <title>echarts地图绘制以及下钻</title>
    <link href="http://example.com/2023/12/17/echarts%E5%9C%B0%E5%9B%BE%E7%BB%98%E5%88%B6%E4%BB%A5%E5%8F%8A%E4%B8%8B%E9%92%BB/"/>
    <id>http://example.com/2023/12/17/echarts%E5%9C%B0%E5%9B%BE%E7%BB%98%E5%88%B6%E4%BB%A5%E5%8F%8A%E4%B8%8B%E9%92%BB/</id>
    <published>2023-12-17T05:20:10.000Z</published>
    <updated>2024-02-28T01:36:24.195Z</updated>
    
    <content type="html"><![CDATA[<h1 id="echarts地图绘制以及下钻"><a href="#echarts地图绘制以及下钻" class="headerlink" title="echarts地图绘制以及下钻"></a>echarts地图绘制以及下钻</h1><blockquote><p>echarts绘制地图</p><p>引入省市区数据</p><p>进行地图下钻</p></blockquote><h2 id="一、准备地图数据"><a href="#一、准备地图数据" class="headerlink" title="一、准备地图数据"></a>一、准备地图数据</h2><p>首先需要准备你要制作地图及其下属县市的地图json数据，可以去这里进行地图下载（DataV.GeoAtlas地理小工具系列）。</p><h2 id="二、渲染地图"><a href="#二、渲染地图" class="headerlink" title="二、渲染地图"></a>二、渲染地图</h2><p>准备一个地图容器</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div v-loading=<span class="string">&quot;loading&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;map-wrap&quot;</span>&gt;</span><br><span class="line">   <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:id</span>=<span class="string">&quot;id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;mapMain&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">   &lt;!-- <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-show</span>=<span class="string">&quot;mapLevels == 3&quot;</span> <span class="attr">id</span>=<span class="string">&quot;amapcontainer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> --&gt;</span><br><span class="line"> &lt;/div&gt;</span><br></pre></td></tr></table></figure><p>之后引入省的json数据以及定义好本地各市的json数据。我这边是和后端商议把数据存到后端通过接口去获取的，推荐这种方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//初始化获取省级数据 </span></span><br><span class="line"><span class="built_in">this</span>.mapJson = <span class="keyword">await</span> <span class="built_in">this</span>.$api.getMapList(&#123; <span class="attr">cityCode</span>: <span class="string">&quot;0000&quot;</span> &#125;);</span><br><span class="line"><span class="comment">//后续获取地市数据以及区县数据通过接口入参更改</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>之后就可以进行地图的构建及渲染。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">label: <span class="built_in">require</span>(<span class="string">&quot;@/assets/images/img/map_label.png&quot;</span>),</span><br><span class="line"><span class="attr">label2</span>: <span class="built_in">require</span>(<span class="string">&quot;@/assets/images/img/map_label-a.png&quot;</span>),</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.myChart) &#123;</span><br><span class="line">     <span class="comment">// 取消点击事件</span></span><br><span class="line">     <span class="built_in">this</span>.myChart.off(<span class="string">&quot;click&quot;</span>);</span><br><span class="line">     <span class="built_in">this</span>.myChart.clear();</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="built_in">this</span>.myChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="built_in">this</span>.id));</span><br><span class="line">&#125;</span><br><span class="line">      <span class="built_in">this</span>.option = &#123;</span><br><span class="line">        <span class="attr">geo</span>: &#123;</span><br><span class="line">          <span class="attr">map</span>: <span class="string">&quot;江西&quot;</span>,</span><br><span class="line">          <span class="attr">zoom</span>: <span class="number">0.79</span>,</span><br><span class="line">          <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">            <span class="attr">normal</span>: &#123;</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&quot;transparent&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">series</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;scatter&quot;</span>,</span><br><span class="line">            <span class="attr">coordinateSystem</span>: <span class="string">&quot;geo&quot;</span>,</span><br><span class="line">            <span class="attr">geoIndex</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">data</span>: mapdata,</span><br><span class="line">            <span class="attr">symbol</span>: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">              <span class="keyword">return</span> scatterImg;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">symbolSize</span>: <span class="number">30</span>,</span><br><span class="line">            <span class="attr">symbolOffset</span>: [<span class="number">10</span>, <span class="number">0</span>],</span><br><span class="line">            <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&quot;#1dfd28&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">label</span>: &#123;</span><br><span class="line">              <span class="attr">normal</span>: &#123;</span><br><span class="line">                <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">formatter</span>: <span class="string">&quot;&#123;b&#125;&quot;</span>,</span><br><span class="line">                <span class="attr">fontSize</span>: <span class="number">18</span>,</span><br><span class="line">                <span class="attr">position</span>: <span class="string">&quot;top&quot;</span>,</span><br><span class="line">                <span class="attr">backgroundColor</span>: &#123;</span><br><span class="line">                  <span class="attr">image</span>: <span class="built_in">this</span>.label,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">offset</span>: [<span class="number">0</span>, <span class="number">5</span>],</span><br><span class="line">                <span class="attr">align</span>: <span class="string">&quot;center&quot;</span>,</span><br><span class="line">                <span class="attr">fontFamily</span>: <span class="string">&quot;youshebiaoti&quot;</span>,</span><br><span class="line">                <span class="attr">padding</span>: [<span class="number">6</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">10</span>],</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">                <span class="attr">margin</span>: [<span class="number">20</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">20</span>],</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">emphasis</span>: &#123;</span><br><span class="line">                <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">backgroundColor</span>: &#123;</span><br><span class="line">                  <span class="attr">image</span>: <span class="built_in">this</span>.label2,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">map</span>: <span class="string">&quot;江西&quot;</span>,</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&quot;map&quot;</span>,</span><br><span class="line">            <span class="attr">zoom</span>: <span class="number">0.79</span>,</span><br><span class="line">            <span class="attr">data</span>: mapdata,</span><br><span class="line">            <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">              <span class="attr">normal</span>: &#123;</span><br><span class="line">                <span class="attr">areaColor</span>: <span class="string">&quot;transparent&quot;</span>,</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&quot;transparent&quot;</span>,</span><br><span class="line">                <span class="attr">borderWidth</span>: <span class="string">&quot;2.8&quot;</span>,</span><br><span class="line">                <span class="attr">borderColor</span>: <span class="string">&quot;#b4eafc&quot;</span>,</span><br><span class="line">                <span class="attr">shadowColor</span>: <span class="string">&quot;#07a4f8&quot;</span>,</span><br><span class="line">                <span class="attr">shadowOffsetX</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">shadowOffsetY</span>: <span class="number">4</span>,</span><br><span class="line">                <span class="attr">shadowBlur</span>: <span class="number">8</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">emphasis</span>: &#123;</span><br><span class="line">                <span class="attr">label</span>: &#123;</span><br><span class="line">                  <span class="attr">show</span>: <span class="literal">false</span>,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">areaColor</span>: <span class="string">&quot;#ce9735&quot;</span>, <span class="comment">//鼠标选择区域颜色</span></span><br><span class="line">                <span class="attr">shadowOffsetX</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">shadowOffsetY</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">shadowBlur</span>: <span class="number">10</span>,</span><br><span class="line">                <span class="attr">shadowColor</span>: <span class="string">&quot;rgba(255, 255, 255, 0.3)&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">select</span>: &#123;</span><br><span class="line">              <span class="attr">label</span>: &#123;</span><br><span class="line">                <span class="attr">show</span>: <span class="literal">false</span>,</span><br><span class="line">                <span class="attr">backgroundColor</span>: &#123;</span><br><span class="line">                  <span class="attr">image</span>: <span class="built_in">this</span>.label2,</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">              <span class="attr">itemStyle</span>: &#123;</span><br><span class="line">                <span class="attr">areaColor</span>: <span class="string">&quot;#ce9735&quot;</span>, <span class="comment">//鼠标选择区域颜色</span></span><br><span class="line">                <span class="attr">shadowOffsetX</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">shadowOffsetY</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">shadowBlur</span>: <span class="number">10</span>,</span><br><span class="line">                <span class="attr">shadowColor</span>: <span class="string">&quot;rgba(255, 255, 255, 0.3)&quot;</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="built_in">this</span>.myChart.setOption(<span class="built_in">this</span>.option);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>鼠标移入移出定义颜色以及图标颜色</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.myChart.off(<span class="string">&quot;mouseover&quot;</span>);</span><br><span class="line"><span class="built_in">this</span>.myChart.on(<span class="string">&quot;mouseover&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!e.data) &#123;</span><br><span class="line">    <span class="built_in">this</span>.mapdata.map(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.symbolSize == <span class="number">40</span>) &#123;</span><br><span class="line">        item.selected = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">this</span>.myChart.setOption(<span class="built_in">this</span>.option, <span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// this.$emit(&#x27;handle-map&#x27;, this.mapdata[e.dataIndex]);</span></span><br><span class="line">  <span class="built_in">this</span>.mapdata.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!(<span class="built_in">this</span>.idxs &amp;&amp; <span class="built_in">this</span>.idxs == index)) &#123;</span><br><span class="line">      item.symbol = item.name == e.name ? scatterHImg : scatterImg;</span><br><span class="line">      item.label =</span><br><span class="line">        item.name == e.name</span><br><span class="line">          ? &#123; <span class="attr">backgroundColor</span>: &#123; <span class="attr">image</span>: scatterHBg &#125; &#125;</span><br><span class="line">          : &#123; <span class="attr">backgroundColor</span>: &#123; <span class="attr">image</span>: scatterBg &#125; &#125;;</span><br><span class="line">      item.symbolSize = item.name == e.name ? <span class="number">40</span> : <span class="number">30</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">this</span>.myChart.setOption(<span class="built_in">this</span>.option, <span class="literal">true</span>);</span><br><span class="line">  <span class="built_in">this</span>.myChart.dispatchAction(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;highlight&quot;</span>,</span><br><span class="line">    <span class="attr">seriesIndex</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">dataIndex</span>: e.dataIndex,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">this</span>.myChart.on(<span class="string">&quot;mouseout&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> chooseCode =</span><br><span class="line">    <span class="built_in">this</span>.mapLevels == <span class="number">1</span></span><br><span class="line">      ? <span class="built_in">this</span>.cityCode</span><br><span class="line">      : <span class="built_in">this</span>.mapLevels == <span class="number">2</span></span><br><span class="line">      ? <span class="built_in">this</span>.countyCode</span><br><span class="line">      : <span class="built_in">this</span>.wgCode;</span><br><span class="line">  <span class="built_in">this</span>.mapdata.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">    item.symbol = chooseCode == item.code ? scatterHImg : scatterImg;</span><br><span class="line">    item.label =</span><br><span class="line">      chooseCode == item.code</span><br><span class="line">        ? &#123; <span class="attr">backgroundColor</span>: &#123; <span class="attr">image</span>: scatterHBg &#125; &#125;</span><br><span class="line">        : &#123; <span class="attr">backgroundColor</span>: &#123; <span class="attr">image</span>: scatterBg &#125; &#125;;</span><br><span class="line">    item.symbolSize = chooseCode == item.code ? <span class="number">40</span> : <span class="number">30</span>;</span><br><span class="line">    item.selected = chooseCode == item.code ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">this</span>.myChart.setOption(<span class="built_in">this</span>.option, <span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="三、地图的下钻"><a href="#三、地图的下钻" class="headerlink" title="三、地图的下钻"></a>三、地图的下钻</h2><p>​        给地图绑定点击事件，点击选择当前地图数据，双击进行下钻，之后更换当前地图的json数据</p><p>点击选择数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.myChart.on(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!e.data) &#123;</span><br><span class="line">          <span class="built_in">this</span>.mapdata.map(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (item.symbolSize == <span class="number">40</span>) &#123;</span><br><span class="line">              item.selected = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="built_in">this</span>.myChart.setOption(<span class="built_in">this</span>.option, <span class="literal">true</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.mapdata.map(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">          item.symbol = item.name == e.name ? scatterHImg : scatterImg;</span><br><span class="line">          item.symbolSize = item.name == e.name ? <span class="number">40</span> : <span class="number">30</span>;</span><br><span class="line">          item.selected = item.name == e.name ? <span class="literal">true</span> : <span class="literal">false</span>;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.mapLevels == <span class="number">1</span>) &#123;</span><br><span class="line">          <span class="built_in">this</span>.mapLabels = e.data.name + <span class="string">&quot;市&quot;</span>;</span><br><span class="line">          <span class="built_in">this</span>.cityCode = e.data.code;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.mapLevels == <span class="number">2</span>) &#123;</span><br><span class="line">          <span class="built_in">this</span>.countyCode = e.data.code;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">this</span>.wgCode = e.data.code;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.myChart.setOption(<span class="built_in">this</span>.option, <span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">this</span>.myChart.dispatchAction(&#123;</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;highlight&quot;</span>,</span><br><span class="line">          <span class="attr">seriesIndex</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">dataIndex</span>: e.dataIndex,</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="built_in">this</span>.idxs = e.dataIndex;</span><br><span class="line">        <span class="built_in">this</span>.refash();</span><br><span class="line">        sessionStorage.setItem(<span class="string">&quot;cityCode&quot;</span>, <span class="built_in">this</span>.cityCode);</span><br><span class="line">        sessionStorage.setItem(<span class="string">&quot;countyCode&quot;</span>, <span class="built_in">this</span>.countyCode);</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure><p>双击进行下钻</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>.mapLevels == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.mapLabels = params.data.name + <span class="string">&quot;市&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.cityCode = params.data.code;</span><br><span class="line">    <span class="built_in">this</span>.mapLevels = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">this</span>.cityNum = params.dataIndex;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.mapLevels == <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (defaultSettings.mapThreeLevel) &#123;</span><br><span class="line">    <span class="built_in">this</span>.mapLevels = <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">this</span>.countyCode = params.data.code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下钻的时候切换当前的mapLevels，通过监听改变数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">  <span class="function"><span class="title">mapLabels</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.$emit(<span class="string">&quot;update:mapLabel&quot;</span>, newVal);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function"><span class="title">mapLevels</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(newVal, <span class="string">&quot;更新level&quot;</span>);</span><br><span class="line">    <span class="built_in">this</span>.levelChange(newVal);</span><br><span class="line">    <span class="built_in">this</span>.$emit(<span class="string">&quot;update:mapLevel&quot;</span>, newVal);</span><br><span class="line">    sessionStorage.setItem(<span class="string">&quot;mapLabel&quot;</span>, newVal);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="title">levelChange</span>(<span class="params">newVal</span>)</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.loading = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">if</span> (newVal == <span class="number">0</span>) <span class="keyword">return</span> (<span class="built_in">this</span>.mapLevels = <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> (newVal == <span class="number">1.5</span>) <span class="keyword">return</span> (<span class="built_in">this</span>.mapLevels = <span class="number">2</span>);</span><br><span class="line">  <span class="keyword">if</span> (newVal == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.mapJson = <span class="keyword">await</span> <span class="built_in">this</span>.$api.getMapList(&#123; <span class="attr">cityCode</span>: <span class="string">&quot;0000&quot;</span> &#125;);</span><br><span class="line">    <span class="built_in">this</span>.mapdata = <span class="built_in">this</span>.baseMapdata;</span><br><span class="line">    <span class="built_in">this</span>.cityCode = <span class="string">&quot;0000&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.countyCode = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.mapLabels = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.wgCode = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (newVal == <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="comment">// this.mapLabels = &quot;&quot;;</span></span><br><span class="line">    <span class="built_in">this</span>.baseMapdata.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (item.code == <span class="built_in">this</span>.cityCode) &#123;</span><br><span class="line">        <span class="built_in">this</span>.cityNum = index;</span><br><span class="line">        <span class="built_in">this</span>.mapLabels = item.name + <span class="string">&quot;市&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">this</span>.countyCode = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.wgCode = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.mapJson = <span class="keyword">await</span> <span class="built_in">this</span>.$api.getMapList(&#123;</span><br><span class="line">      <span class="attr">cityCode</span>: <span class="built_in">this</span>.cityCode,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">this</span>.getMapData();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (newVal == <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="built_in">this</span>.wgCode = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="built_in">this</span>.mapJson = <span class="keyword">await</span> <span class="built_in">this</span>.$api.getMapList(&#123;</span><br><span class="line">      <span class="attr">cityCode</span>: <span class="built_in">this</span>.cityCode,</span><br><span class="line">      <span class="attr">countyCode</span>: <span class="built_in">this</span>.countyCode,</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">this</span>.getMapData();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.mapdata.map(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      item.symbol = scatterImg;</span><br><span class="line">      item.symbolSize = <span class="number">30</span>;</span><br><span class="line">      item.selected = <span class="literal">false</span>;</span><br><span class="line">      item.label = &#123; <span class="attr">backgroundColor</span>: &#123; <span class="attr">image</span>: scatterBg &#125; &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="built_in">this</span>.refash();</span><br><span class="line">    <span class="built_in">this</span>.drawMap(<span class="built_in">this</span>.mapJson, <span class="built_in">this</span>.mapdata);</span><br><span class="line">  &#125;, <span class="number">500</span>);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>四、完整代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div v-loading=&quot;loading&quot; class=&quot;map-wrap&quot;&gt;</span><br><span class="line">    &lt;img</span><br><span class="line">      ref=&quot;cityBgc&quot;</span><br><span class="line">      v-if=&quot;mapLevels == 2&quot;</span><br><span class="line">      class=&quot;cityBgc&quot;</span><br><span class="line">      :class=&quot;&#x27;city&#x27; + cityNum&quot;</span><br><span class="line">      :src=&quot;baseMapdata[cityNum].img&quot;</span><br><span class="line">      alt=&quot;&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;div :id=&quot;id&quot; class=&quot;mapMain&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;!-- &lt;div v-show=&quot;mapLevels == 3&quot; id=&quot;amapcontainer&quot;&gt;&lt;/div&gt; --&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import * as echarts from &quot;echarts&quot;;</span><br><span class="line">// import mapJson from &quot;@/assets/js/jiangxi.json&quot;;</span><br><span class="line">import &quot;echarts-gl&quot;;</span><br><span class="line">// 高德地图</span><br><span class="line">import AMapLoader from &quot;@amap/amap-jsapi-loader&quot;;</span><br><span class="line">window._AMapSecurityConfig = &#123;</span><br><span class="line">  securityJsCode: &quot;7abb8639b7646c39faed982a0f18442a&quot;, // &#x27;「申请的安全密钥」&#x27;,</span><br><span class="line">&#125;;</span><br><span class="line">var piePatternSrc =</span><br><span class="line">  &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyODIwYzUxMy1hYjk5LTE1NDEtYTk1Ni1lOWE4MDdlZTY4M2UiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTYwOTE3MDFFQURCMTFFQzhGRjhGOEVGN0NCMjVCQzciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTYwOTE3MDBFQURCMTFFQzhGRjhGOEVGN0NCMjVCQzciIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NGVhZTRmY2ItYzE1Ny1jNjQ1LTgzOTgtOTM2YTk0M2QxNDMxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI4MjBjNTEzLWFiOTktMTU0MS1hOTU2LWU5YTgwN2VlNjgzZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhOhos0AAABBSURBVHjaNMoxDoAwEAPBNZxB+f8L6WgpScElOYktLI1kXfeDOMKSvszob0/hPaaZbu0EFmrDNlXm8sZfPRgCDAAriw4EHt+HWgAAAABJRU5ErkJggg==&quot;;</span><br><span class="line">var piePatternImg = new Image();</span><br><span class="line">piePatternImg.src = piePatternSrc;</span><br><span class="line">var patternSrc =</span><br><span class="line">  &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAIAAAACDbGyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyODIwYzUxMy1hYjk5LTE1NDEtYTk1Ni1lOWE4MDdlZTY4M2UiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RjRENTQzNDlFQUY3MTFFQzhFMDNFNjI4MzExMjBCQkMiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RjRENTQzNDhFQUY3MTFFQzhFMDNFNjI4MzExMjBCQkMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NGVhZTRmY2ItYzE1Ny1jNjQ1LTgzOTgtOTM2YTk0M2QxNDMxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI4MjBjNTEzLWFiOTktMTU0MS1hOTU2LWU5YTgwN2VlNjgzZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PifD0UMAAAA4SURBVHjaLIvBDQAgDALB1O4/gfs0cSax1d6LcMAVm6T7JHCkwQINYWleKFJaS/1Olp8yvcAVYADRHwpwESUINQAAAABJRU5ErkJggg==&quot;;</span><br><span class="line">var patternImg = new Image();</span><br><span class="line">patternImg.src = patternSrc;</span><br><span class="line">var scatterImg =</span><br><span class="line">  &quot;image://data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAXCAYAAAAGAx/kAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA2LTEzVDE3OjEzOjExKzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNi0xM1QxNzoxOToyMSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wNi0xM1QxNzoxOToyMSswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozNWFlOWE3OS04NDBjLTc4NDItOGRiYy1kNzhhMDIxODlmZDAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MzVhZTlhNzktODQwYy03ODQyLThkYmMtZDc4YTAyMTg5ZmQwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6MzVhZTlhNzktODQwYy03ODQyLThkYmMtZDc4YTAyMTg5ZmQwIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozNWFlOWE3OS04NDBjLTc4NDItOGRiYy1kNzhhMDIxODlmZDAiIHN0RXZ0OndoZW49IjIwMjItMDYtMTNUMTc6MTM6MTErMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5XZjhKAAAEXklEQVQ4jW2UW2xUVRSGv7XnzJlpT6ctvSG01IhALZQUlVsMCspdMSYqiaDxCSLBBzWQSGoCQUzgBTVeMCIGMJUoGIGamCAk1mgoBIJigsXCtKWlLbS003banjkzZ/b2gbYplp2sl531/3utf61/i7MzZgPC+CM8rWYyUW3kT72ObvM9d8x+4ApgxiU7O2OhcQQr1RSy1G6aeYIhMgngobBRxiWariPONqB1LKEahYexWa5msMnaT7dqoJWnyQDycclFEyFBlsAcawlzAg0UyFdA2fiKNgSmkZRfaaEQi3bUmEfGHgMoNCEmUePHgGLAjCQLB9JRLrKdPFyKCOMAWf8LB4gA0wnTpj3gvRG8dY/Q0fQRYupRZslKpmOTJICHRoYrsVHk+pprapBL+hhQPV4jAM+k8M1HNOJxjmwUmkLABopSkNuvSQWy+d0MYvgYSN+PSLAR+nQLmh0M4nMGmyaEHE8gJaSybX7WSXrNdmxaRnFjiO6S2AjZWLj+KZIcBFLUo+gMBSEoXNQJmsxBcjlDEDWKAbGwhy+CCDaBrZXkzyugotFN9+xtCmi3Dwcw9FjBYEO6Z8Mizv/rEf6pGY2H4KMBAvaybUHCqPcXStHWSl6cHJEV0RTUe6Y56kpDX4L5qTw8/4LxyzPNt0+WSXDZJFn5ylScBKbtakx8BMTZG3OOrZFZToZ5uW6Afz68qf8eTEkaMGgUWFvQZh1X9TfMNJ+i0A9nkrW5WOZVhGXCX7dN9bt1dMjJ+t7KHMe8+mWH+aXmDh0YpDxLhT6rcNbmh+SlfkNJ1SnXrloY7nAcanY0uNW13X4ckLdLpXxVrlTW3jBfSN3N3l2Hbpmz1bdNM5r02snBiR+UZR654qYn7OtIOPVumgFf84hj8cYD4aHF2cHkgZbE67uvJaIEULsekvlzM8WW442xba/Vmxo0SQzq0uLsr492JxfuaXOt8R6H9UUhXVUcbqmo7V8NUBgm41CZrFeNCTrQ+Bg0BlMUVgs+aXet+/oMONLlqbClJm2YEirEoLuSeJ0p060Azch3oDCJNEMPhtSYVbtnZckNgC3I5X4/jtwdfdqIr0rCFCIERnIbB9P7Ds+IuPeQDUdeQKgui7itCX3iQl/aBSQoBIps8q1SWyYumUB+bY/pxKBXnI8fPr0gEvxtds6b5+MpfSHuZ2qQWY41tDQnaLV7+sdn6+J7AI3C2lwiZRkiMTnbFFvep1hUFdUnGwZlYLjNwDMFVuSdqRlPFYRkGgarL2VufNfu/XGoNXlrWAa1NE8KtxTzXFecw1L6eU/W0TWyOg6V1bep/aHLtGPu9o4Z9qIgmFEdQVBvlUj5ilzm+p6cfKHGXBZndywTGzn+vFREMlnT6NJ/adBcOx0zbdEESRgeh4LHs4gsyZUpj2XJ9AKLZEvMnNh4mlaSGHF2xsIjxl01jfCmmcwO2swRkVJP43sGTwliC2Fb0GltrncOcHHLOXO9t0/SJDEkMf8BTArYUHzYMZcAAAAASUVORK5CYII=&quot;;</span><br><span class="line">var scatterHImg =</span><br><span class="line">  &quot;image://data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAwCAYAAACfbhNRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFHGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTA2LTEzVDE3OjEzOjM2KzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMi0wNi0xM1QxNzoxOTo1NSswODowMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMi0wNi0xM1QxNzoxOTo1NSswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3MWRkOTZkNi1hZDMxLTcyNDctYWQyYi01MWFmYzc1ZDU5OTUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzFkZDk2ZDYtYWQzMS03MjQ3LWFkMmItNTFhZmM3NWQ1OTk1IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6NzFkZDk2ZDYtYWQzMS03MjQ3LWFkMmItNTFhZmM3NWQ1OTk1Ij4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDo3MWRkOTZkNi1hZDMxLTcyNDctYWQyYi01MWFmYzc1ZDU5OTUiIHN0RXZ0OndoZW49IjIwMjItMDYtMTNUMTc6MTM6MzYrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7Hui0PAAAKbklEQVRYhZ2YeZAdRRnAfz0982beufv2XvcIJBISIiKYSNQSoiKWWJ5llaV/eJb/oGV54I1HyT+WR2F5i4ulIBiVAgVELKyUFGpJCBGFXUNCrt3NHsme75yz2z/ekbezbzcpu2pqvunp+b7f93X3190j3DHygKBWxCYybeR2RbeRW+/rZKPFWOt14XoDw7N4gG6Oy0HehonV0sbYRM+6OuGO0d3G+w2joQbpDE9wL8d5EaBJAR1gbcMxU3xXLfBz7RNcZBQ0gHDH6NnA8Brj0Qi90Tj3M0sGPxZ0E0gCeTBHMawc90XzfIOA4AIATYjeTSBEsIPr9AHuoEqFAFD1VkZdNlpgJOAAaRB9GM4gc9EMbyYi3ARCC3eMvnbe+7t4A4/xM0KWiVpUiLrxzYanASTqMF0YzotYUMu8Q5cobATRv8bzUb6kn+J9RFSaXotY+ON1DbkVrPFchyEDyWEsXeYtapETcYgB3Us28Pglk7yYEE20iZf/TzGojRsHyEOin4QM+bo6x33axzcBEYT8kUU6MdCY9Q/insU9PF/axWl9afnGV/hOjq8aGiua4S4TENLgo1GW20WWfl1ANcdAPOStqlrNCkQMQ69Lb0kgA7oXMl0INcej0Vn2A6IGsch/nQkeqZrsE/sYVfMIQiCM+dGYEXGZdXW19rIeWQfoBDOPcPKsRKcpqzm+SEjUhABEeBk/TR1jS/kRPPu19HshnXhowpj37QZhvGhq09VCkAHdic72g19gOpihKELu1SFhQ0szhWqLMOrgR7ZFKnicOTnBKasfrVPURngCsFvuVkt9/ErWPKcf6INsH+XgHC+IMhXD4wU1y59pmZFr8ng0xKS0+YOUGBRwg4c4luugLHJ15WbLZdW9jdelgDzQC5l+dNpkPpxlWgREho+nVvhhq811EIAIh3nAFpSRCFElLD5EQh2C7Ai1+d4ahVY5CWSBbrAGINsFlUUEJTwDMEIcHfCgLrMatyncMbawdmUzjGVy6hgP+g5WY6ZoC3LvhkIJRADNXCLqUUiAzkCuH4pnQBRAmiAkWKC1x1+iM3yN80lKNeR2Sy0qT8lKcIdQeJgIJAgNxV9D7hSkuhA6gcBEkECQQ+gcItcPxSNgFs73liWR2mdCFfhpG1truoM4SPAyfps2OSfLTGMhGjuB4jii8iDk8qCzIDrBzEPOAP85hBMhLA2mCZbEp8y09tmvi5xt1d8qGy0VxF9GPXzB7kLKAs8j8DHqMNVaVKzDkOlHyFlQM2CJegQkwgg5oytMasGz6ixPtLHRlNtFoilH/ZwRFv8yu5CmxwnhsUStG8CAcAbUvyHhgSFqXaYTgMtRfEraIqkr/Kadg+0iQaxhQ9LBpXzLcsiINKaULBirzDTGCRJh1DdzWiC0iUuJIyhQkm7lc69a5mTMeDwSbbtjHVSU4vNmRCqUDGqHFCusCIjq+UFoCXgUKeIhGdYSWxs8rRZ4bBO9Tf3tIrEuKlEPU0Y3xwCNBOGAdini4WobTZGV+joAIUo75FSJ/UQXtym4EERzbQwGuC29lYRQ+JiARGAQ4lFFNhc4pR1C5bNfF5i6GADqeWKNsQ1ANIDy+ITTQdWosIKJwKrnitrwruiQc8pgQi3y8GYOxUu7SGzYOMrzApcxZTm4iVVmtUVtpQw5xyqrqos+tcKPCXAvoHPNccCIVbSTWz/UoctXxfVcJhwQASsolvBRepBe7XGPLjEf07EpQAMiThqX44q0OMqX5SB5Uds3GEiEkkypBR7ezIF2ANTHxIVOSHEFIszzpL6BZVGtLUIqT1JXuYdw3clrnQPt7BmbvGzdXTYXOrtra9becuOwWXnXd8XNXCFso1vq1LNWKTEea9vOmbgtAB3fV6/d1gKWRBijNw3Sc9Uu1+nbVhDCCaNyUWnf70kdfRT36KsLw7eumiPpm+2oOC9Xp8aZfvSot3q6fBEgzWPgFs6n1daTs2Fve8ewGrxu35Jhd6x6p09FpcNTVmW8mIrKQhKRS5UGhEfPWd0zXjW7TZ3Z3ZtJbR/NmH0D2fLUYY785EmvvOTSsndouZp1wh1jNA6QkEhx9Vf2LmW3XbsUPD9emXvg6HAwqdJeWeNiEAKq2V7Xj31Cp4VekZ1iMbMnk+t84zV9MpmyT9x3vzd14NxmIMIdYyQWAWG/6rZ9087ozsXSfQd65/9e6i4taVwkIcJ2epLs+PhuUpduBZmFqEDp+EmO/uCw5y9UMVG6U3DaGhV6+L3bh4wdu7LHfna3d+ZvS20gNKCEO8ZwK4R9zWd3zfTsvnFm+Rd/2HL2b9XcSgGqGLa0E+y98/107Hw3q+MRCweTBCUDK6Po3lOl8yWS1fHfcPAjd3vKC0gRTeVGjGD0IztGjUu3p5++5U6vMO+1AxHuGENNgEy3tfjKOz82Uf774yMzd88MrsxpShi2aTq87k+3U57cydOfc7zSAvFiZ3rg5d90SQ1NcOCmT3si8ulEHem60swO3XLD1uLUUe+ft/6jHYSxpmLHzdsKRlAQ1X/MDfpzIVUiFHDtnW/Fnd8ZPvHhtgAAXmmB8IkPOXgLV7D3jrfgoykS9Vemg/nSU/9azlx+9QbdsRYiygwNzfvFuYxfDPBQBGgUkBl+MxPfd6L4sS9WIgVMfM8hveUmFJoAnQtXo0r12bO+sG17+PrMhSCUK3NJNwwLQqkIhaofczXClFzs/wIdgLQsQKOItDC0KZQKTVxSw/YFI5GIvLIhk45ybEg0p5DCW3qcF3/AvyiIbR/0cc89DihMqApHFVVSyFCauLPVjSBoPFiV+clBp2dkSvUY1YSjsVBIQg7d8it69p6199wW2pZsa9tOCOzdXwvp27vIwU/ejSTCQi9YvVjJPV22IPAmD7T9XSRvfSvphiKzcnxVD739ujMqsaCYLfVG8xoPHbnLobl0+M9c9qGtXPGpATPdp007J830AGbPSzG3vSdkz+0BTt9Bnv7Mp7zl8RUcVDXvcKzzCnMo/87XjLhT/4kmH5lsdbpxNdYOALzlk35P+ZnHdnXsvuGQe+J+0RWWdzChKBB5C4cW+ePrP23v+MAljLz9tfRddyXCyKFVgaAwwZEfHvCeHzuJQUQKVe5KM5m/XCRy7901IJw0z377qRZb6/JET/3F+dT9unveNJ3o3f7MuYf/tM39a2GodErnCgWBhyCoZ9ZaEq79o6lt+3X914BazHRxomunFNn379ruXHJV7+S9d3lHfjHfYpg4RHccwrak4NU/uX42eem1E6UTB6Pi/mP9lVk14M7QGayCX/+T01g7TPBStlg0u1nN9Ytp85rMJfmbXjEi7c6Oyd//zvvv2GybCNAK0RWDaMiGffVnR1Z6972pJGV6pjp7bKFy+GQyfKaQo4L0fIRSBkJoz0mJs3pAZlOvGOhOXX55H7mB3uDUIfHcd57wFp73OL94sRFEfgOIhmzYV31m2O+66mUFq39HoEPpGWFZE3iRDrUpTJkQVlKqRMbW7nxn9fR/OH7Pc97sk5U2xjeE6NwAIn6vddXWt3WQvzKPTCfBEGg/pDpTZOqhRW912m9VfgHjzbr/AWFUFe9v0UUSAAAAAElFTkSuQmCC&quot;;</span><br><span class="line">var scatterBg =</span><br><span class="line">  &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAAbCAYAAADGfCe4AAAEpElEQVRYhaWYvaskRRDAf7W37+19KAb+A4IG74y8CwwMFJMLX2CgYHKZf4CI+DTRaEUwUsHMUOMFOTCWOw5EzG4xMhCEE0G89873dne2pKd7Zmpru2fmsGF3uquruuuru6pLbt678wtwTeFc4JEiFeiW+K2Av4E1EPqVQBVwgVOQDeimmQM5Bb2Q2K+0ppcV6FnCCetuBN0q/BvXlQTXZo3ztH+AbQXZarfHNv00zAsaeFEB1RpW/wJtGsa/qcJzwGvAI+CZAJeIpDUGzIDDRKBp0TC4FpmJG6apaVwzMtgIIHBZW0WwTf1JhGslaS7C9Woc1wJsoqLi3tIqrp1XaelaA2hSWKOQ7TQx/Nvy+CR0n4pykeSrBa/YbRdES9pWHS3mZwT1JFLdWca2HCyqNjRLLy127GmGtoNImpe2l+CTqSF7HfiyM7k1f/HXaLlaHp9Uhq6x2mly9a2BBSU9drhrA6vMvgG2cXys0k/dGudG5m36XkyuzB5OZYSak88Xploau1QDu2qEa5gPsKcN05U5b5U7e5bO4uSUrgavNZBuqgcTJ5kYBMuxFSAnjFeUZOBFJY5oY+k01590Pr/DoGfSE/v5klC+iaPPMZ9ba+z6FreVY+L2ygnnhSr1/w9Dlom+28rOifvijk/rkZMRHJUEzzFRGlt4bssc3J71EptSctGMJYsM9rlVaVMGXE4zlhnjEX3K3nPRHUvqrqJKLjN08eQE6GtjXFozv6ELLSd4sOQOX32WsK3kciXavjNdUkrJTcfwtiNHzl37BLDj0oVUujhKZ6e09/h0qYAnjbuOJPC31hiGfBOzzpPE3awAPXu0eNpjydJ57LPaUFjxaz9pUjA+LMlOr7OklNDyF0nuHJVcMZdEjI2NffBiE92ntWndWYZwKPuxeOr6Obf08Jz75vYuxcw93hxznbsKPH+0mP8AvAn8mtFwLnZ6wcfENd/vCwt2ndK5dVlplq864/lA4Xvgk6PF/GfgFvAx8E+Bkb58cygEiWN6KESMclfjollFh2Tga+CmwAvAT0eL+avXF59+k6oF3420pg/GpaRgKJT4W3xU2maA2btCbty7Y+lugX4O3BfkQ0UfLo9PXkyWfck9Urfu3effer6/GXg/Dn39up4PzX3lYPrA3K610sK5fBn4XdEfQW4fLeZL4C3gXeDPEc8jf1nYyybnrrk+Hi55S/W1Lo2zlrTVEYHrCp/FrEHeV3S5PD4Jr/p3gNvApcKrXQvWGnr9D83lrOkrA3vfYEnnrjkLyduCvqfIt4J+kUqJdUtCT43FDlN1rxlPUrnDWuGKO2sHaQ01NDN3ti+78UHCszQNH019p64wyuzwjyEhG26eBT4CbgBfhZtXkga1jq91/bXR3soUlZpy5eNmHMqdiq7TGcXUTFd92XrHSz9WZnYy9cQ+OifIX+lMvgLyRqrJVqkAPQtjQTapCBwILkldM2WN6gapNV8LlgRsNB7664Qb9lqDBmHXyWMukjICzkqjIjbaFbVX7lIL6+y5ci1klNz+N4Lu6e4u6N1OEeVo0KYo9aEuKbCcFkksfLdbp/5Eu6SmcdNcyEpegyrwHzdCxPS7nMn3AAAAAElFTkSuQmCC&quot;;</span><br><span class="line">var scatterHBg =</span><br><span class="line">  &quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEoAAAAjCAYAAAAzK5zjAAAGIUlEQVRogbWaTYhcRRDHf72b3biTGGMQRIMDiiB+gKeAonhVEAQFPXhTUS+CHlQMeBTBi5BDxIsgHkTBi5CTJy+eRCE3QRAMKPEiJOtk3a9p6TfdM/XqVX/MmBS8mfe6q6urqqv+3e91O/8N9wKngX8AT5+2gYNYkuoOIq+kUHcN2GdVChJcoW2t/gbTEeAV4D1gGtXx3f1MsWksJ/73eRbP4f9QlU+j464a5RNgL7aZlbnuXvOG+x1gN+qC6Gti6LDX8S50TFcaWFm2H/m9qAu/O7g5T6LJEcH0B3B5Lmim2M3AmnJOaLNlGDSKvJLWgVuUk8J1XBis66aVulIbfekBsgZ42nOgU8+z6/IRYdR54KPrHObr0Sk6pbeiwyWFHo8p3nB/FNgQSqfyY/jOMBkpG4o38d8k2qX/9QzvprA+tHsAQ1m4xFvAKRWu6f9v4cSUChMjhPciZmnjrhgyd2IaeIGT4flfxQtjhY03HrNuzzsKXgYeUp5ehKrrlQUsS2WJpzU1Do1U0m0Pe2WXzPaT6FjZ/34cgEVqzfScDOyZYdqBGtQZfh3lBLdyD5v91Gsl1xtl17nJLzG6OsqslpLHCR6dJsT0OGo4+Xjv2XWDekpMUNph6Z/5/ZQRh112DcC3RlphIgBKA0sOKpVLpznlQOk0VJ1rkC1badl9Dj8YiI5aHWUJtpTO8dr8fq60K8gjGiBJOrc0ODkn6kheBICz9W91lFas5IyWyJHqaWOtCNOpnYu8nE5aDzeQn3i9rf+qqaeftXE55UqUUXHej5WK+t4iXe+MQXO9WoPWetW1LvOUM0IbaSdQ4ltgiCYddbWXHXnfMmhVy5OjfKZ7LaDVlXIe1Abao+cLo9ynRUQstHbq2epBl+WdbczhtdTTuWylGuZoa/itOdmZ+FZ2ms6D5Wbfoc7J0UZvq4A5RqqVni05OarhUGmicMa9bl8GfzeP7JWXB0PF7GS1saivZAlDcjhUXjr05aZ7S5aFn/QGIgM/a0YjS5EcT8lQq8Ocojn+3L3L1lpyh/XL6NGRdFRdnBS8mKFaHZCLilwvpeiUXw1yk5Ar1C8z63W85dSrz4KI0G/tuBQLlqyWlX8OF+trtz5fFsPWTHXrlDO2tlJuWUl7FaW1NwF60dMvH0rO91fkWiuILTXMpUXLorAEqKW63KxmzlJmX4tZTZbUBm8A5jmm1gWcVq7ltUXPVvqSr0Q6ylr10Fytk0+PrNT7VHzdrK9iy0BuRVz+laZflsOvfgR4426oi+QargVrS2GVeq8CTzHmE+A+4AsDLyyDqlOrgQEtbUsRItc9Lf1br01yRV+dfIKjvgIuAncDF4AvGXffp18CHgd+yjReZvWtZ5VaOms5LbNay+xoldfgZR5RF/GcAd6JKfd8dNzrjPkReKy79/zVoIRtQD892sG3X1qK6nx9DYX84BuU+WE7pV74uP4x8HCMqrAXdw74nrt4kDGf47q6cyvsBnsj8C2Myq+p+umiZ62y08trwdkX/2EMVd/1fgeeBV4A/gTO4PgB+JAxe4y7HeVHgO8qBuYwSAN1btYrydb1y+CcVdb0nSO3PPg2Rtf5KPhN6NIwgP0vjHkOeBH4zchvvebRSjatWwrGeRWZuZTMOan0ZmhFYXUdFQ5ovA08EQE9QPzXcTa8g3GXoo8CH8S9NdlVa0S1km5nLWydqF1mopGUfYUKp1laKGw/vwa8H7e9r0YHfdbtp13itngiJilzQi0St9T29Ubcj/Ni9Eexfdpb2xIypvPtcj8/H7AW9/PkntxIPW9GvrSXtx43fafCaVKGj21mdmww4iT3s8WFVkclujOeT3g6Cv0ZOAv8qvi2hcHXj0ovMqtSWU7YUn8j4PWyjkr0ZHTYaWMr3fe2smflO2qL+yBGpeSRZxjSkaGJkrctRn6qzi14cWZBLkOuqQjaxbMvEnUq2qQh2I3lJ4FnwmmWVR1FDPN3o6CRMuiYUGLZYz1TcdZKn0vwhXrryI8+syXLvCjT5fr6X45ahgIepdwPFII9nA2QFDApYEigoFzAEoljgeSxoIQngS/xJNyShgYZEi8Dv2wTKLRJMhOGLs6FwZX/ANcWAu8hXbR0AAAAAElFTkSuQmCC&quot;;</span><br><span class="line"></span><br><span class="line">import &#123; getUserInfo &#125; from &quot;../utils/auth&quot;;</span><br><span class="line">import &#123; debounce &#125; from &quot;../utils/common&quot;;</span><br><span class="line">const defaultSettings = require(&quot;@/settings.js&quot;);</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;echart-map&quot;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    id: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &quot;main&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">    mapLabel: &#123;</span><br><span class="line">      type: String,</span><br><span class="line">      default: &quot;南昌&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">    mapLevel: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: 0,</span><br><span class="line">    &#125;,</span><br><span class="line">    idx: &#123;</span><br><span class="line">      type: Number,</span><br><span class="line">      default: null,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      label: require(&quot;@/assets/images/img/map_label.png&quot;),</span><br><span class="line">      label2: require(&quot;@/assets/images/img/map_label-a.png&quot;),</span><br><span class="line">      label3: require(&quot;@/assets/images/img/map-addr.png&quot;),</span><br><span class="line">      label4: require(&quot;@/assets/images/img/map-addr2.png&quot;),</span><br><span class="line">      mapLabels: this.mapLabel,</span><br><span class="line">      mapLevels: this.mapLevel,</span><br><span class="line">      idxs: this.idx,</span><br><span class="line">      mapJson: null,</span><br><span class="line">      mapBgc: require(&quot;@/assets/images/img/map3.png&quot;),</span><br><span class="line">      baseMapdata: [</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;南昌&quot;,</span><br><span class="line">          value: [115.892151, 28.676493],</span><br><span class="line">          code: &quot;791&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/南昌.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;宜春&quot;,</span><br><span class="line">          value: [114.391136, 27.8043],</span><br><span class="line">          code: &quot;795&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/宜春.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;萍乡&quot;,</span><br><span class="line">          value: [113.852186, 27.622946],</span><br><span class="line">          code: &quot;799&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/萍乡.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;新余&quot;,</span><br><span class="line">          value: [114.930835, 27.810834],</span><br><span class="line">          code: &quot;790&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/新余.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;吉安&quot;,</span><br><span class="line">          value: [114.986373, 27.111699],</span><br><span class="line">          code: &quot;796&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/吉安.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;赣州&quot;,</span><br><span class="line">          value: [114.940278, 25.85097],</span><br><span class="line">          code: &quot;797&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/赣州.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;抚州&quot;,</span><br><span class="line">          value: [116.358351, 27.98385],</span><br><span class="line">          code: &quot;794&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/抚州.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;鹰潭&quot;,</span><br><span class="line">          value: [117.033838, 28.238638],</span><br><span class="line">          code: &quot;701&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/鹰潭.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;上饶&quot;,</span><br><span class="line">          value: [117.971185, 28.44442],</span><br><span class="line">          code: &quot;793&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/上饶.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;九江&quot;,</span><br><span class="line">          value: [115.992811, 29.712034],</span><br><span class="line">          code: &quot;792&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/九江.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          name: &quot;景德镇&quot;,</span><br><span class="line">          value: [117.214664, 29.29256],</span><br><span class="line">          code: &quot;798&quot;,</span><br><span class="line">          img: require(&quot;@/assets/images/bgc/景德镇.png&quot;),</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">      mapdata: this.baseMapdata,</span><br><span class="line">      cityNum: 0,</span><br><span class="line">      option: &#123;&#125;,</span><br><span class="line">      cityCode: &quot;0000&quot;,</span><br><span class="line">      countyCode: &quot;&quot;,</span><br><span class="line">      wgCode: &quot;&quot;,</span><br><span class="line">      loading: false,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">    sessionStorage.setItem(&quot;cityCode&quot;, &quot;0000&quot;);</span><br><span class="line">    sessionStorage.setItem(&quot;countyCode&quot;, &quot;&quot;);</span><br><span class="line">    sessionStorage.setItem(&quot;mapLevel&quot;, 1);</span><br><span class="line">    sessionStorage.setItem(&quot;mapLabel&quot;, &quot;&quot;);</span><br><span class="line">    this.$nextTick(() =&gt; &#123;</span><br><span class="line">      this.initMap();</span><br><span class="line">      // this.refash();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">    mapLabels(newVal) &#123;</span><br><span class="line">      this.$emit(&quot;update:mapLabel&quot;, newVal);</span><br><span class="line">    &#125;,</span><br><span class="line">    mapLevel(newVal) &#123;</span><br><span class="line">      console.log(newVal, &quot;levelChabge&quot;);</span><br><span class="line">      this.mapLevels = this.mapLevel;</span><br><span class="line">      sessionStorage.setItem(&quot;mapLevel&quot;, newVal);</span><br><span class="line">    &#125;,</span><br><span class="line">    mapLevels(newVal) &#123;</span><br><span class="line">      console.log(newVal, &quot;更新level&quot;);</span><br><span class="line">      this.levelChange(newVal);</span><br><span class="line">      this.$emit(&quot;update:mapLevel&quot;, newVal);</span><br><span class="line">      sessionStorage.setItem(&quot;mapLabel&quot;, newVal);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    async initMap() &#123;</span><br><span class="line">      this.loading = true;</span><br><span class="line">      let userInfo = getUserInfo();</span><br><span class="line">      this.cityCode = userInfo.cityCode;</span><br><span class="line">      this.countyCode = userInfo.countyCode || &quot;&quot;;</span><br><span class="line">      let level = 1;</span><br><span class="line">      if (this.cityCode != &quot;0000&quot;) &#123;</span><br><span class="line">        level = 2;</span><br><span class="line">        if (this.countyCode) &#123;</span><br><span class="line">          level = 3;</span><br><span class="line">          this.mapLabels = userInfo.cityName;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.levelChange(level);</span><br><span class="line">      &#125;</span><br><span class="line">      this.mapLevels = level;</span><br><span class="line">      sessionStorage.setItem(&quot;cityCode&quot;, this.cityCode);</span><br><span class="line">      sessionStorage.setItem(&quot;countyCode&quot;, this.countyCode);</span><br><span class="line">    &#125;,</span><br><span class="line">    drawMap(json, mapdata) &#123;</span><br><span class="line">      if (this.myChart) &#123;</span><br><span class="line">        // 取消点击事件</span><br><span class="line">        this.myChart.off(&quot;click&quot;);</span><br><span class="line">        this.myChart.clear();</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.myChart = echarts.init(document.getElementById(this.id));</span><br><span class="line">      &#125;</span><br><span class="line">      this.myChart.on(&quot;dblclick&quot;, async (params) =&gt; &#123;</span><br><span class="line">        this.dblclick(params);</span><br><span class="line">      &#125;);</span><br><span class="line">      this.myChart.on(&quot;click&quot;, (e) =&gt; &#123;</span><br><span class="line">        if (!e.data) &#123;</span><br><span class="line">          this.mapdata.map((item) =&gt; &#123;</span><br><span class="line">            if (item.symbolSize == 40) &#123;</span><br><span class="line">              item.selected = true;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          this.myChart.setOption(this.option, true);</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        this.mapdata.map((item) =&gt; &#123;</span><br><span class="line">          item.symbol = item.name == e.name ? scatterHImg : scatterImg;</span><br><span class="line">          item.symbolSize = item.name == e.name ? 40 : 30;</span><br><span class="line">          item.selected = item.name == e.name ? true : false;</span><br><span class="line">        &#125;);</span><br><span class="line">        if (this.mapLevels == 1) &#123;</span><br><span class="line">          this.mapLabels = e.data.name + &quot;市&quot;;</span><br><span class="line">          this.cityCode = e.data.code;</span><br><span class="line">        &#125; else if (this.mapLevels == 2) &#123;</span><br><span class="line">          this.countyCode = e.data.code;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          this.wgCode = e.data.code;</span><br><span class="line">        &#125;</span><br><span class="line">        this.myChart.setOption(this.option, true);</span><br><span class="line">        this.myChart.dispatchAction(&#123;</span><br><span class="line">          type: &quot;highlight&quot;,</span><br><span class="line">          seriesIndex: 0,</span><br><span class="line">          dataIndex: e.dataIndex,</span><br><span class="line">        &#125;);</span><br><span class="line">        this.idxs = e.dataIndex;</span><br><span class="line">        this.refash();</span><br><span class="line">        sessionStorage.setItem(&quot;cityCode&quot;, this.cityCode);</span><br><span class="line">        sessionStorage.setItem(&quot;countyCode&quot;, this.countyCode);</span><br><span class="line">      &#125;);</span><br><span class="line">      echarts.registerMap(&quot;江西&quot;, json, &#123;&#125;);</span><br><span class="line">      var areaColor = &quot;&quot;;</span><br><span class="line">      areaColor = &quot;transparent&quot;;</span><br><span class="line"></span><br><span class="line">      // if (this.mapLevels == 1) &#123;</span><br><span class="line">      //     areaColor = &#x27;transparent&#x27;</span><br><span class="line">      // &#125; else &#123;</span><br><span class="line">      //     areaColor = &#123;</span><br><span class="line">      //         type: &#x27;radial&#x27;,</span><br><span class="line">      //         x: 0.7,</span><br><span class="line">      //         y: 0.7,</span><br><span class="line">      //         r: 0.8,</span><br><span class="line">      //         colorStops: [&#123;</span><br><span class="line">      //             offset: 0, color: &#x27;#235393&#x27; // 0% 处的颜色</span><br><span class="line">      //         &#125;, &#123;</span><br><span class="line">      //             offset: 1, color: &#x27;rgb(1, 117, 206)&#x27; // 100% 处的颜色</span><br><span class="line">      //         &#125;],</span><br><span class="line">      //         global: false // 缺省为 false</span><br><span class="line">      //     &#125;</span><br><span class="line">      // &#125;</span><br><span class="line">      this.option = &#123;</span><br><span class="line">        geo: &#123;</span><br><span class="line">          map: &quot;江西&quot;,</span><br><span class="line">          zoom: 0.79,</span><br><span class="line">          itemStyle: &#123;</span><br><span class="line">            normal: &#123;</span><br><span class="line">              color: areaColor,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        series: [</span><br><span class="line">          &#123;</span><br><span class="line">            type: &quot;scatter&quot;,</span><br><span class="line">            coordinateSystem: &quot;geo&quot;,</span><br><span class="line">            geoIndex: 0,</span><br><span class="line">            data: mapdata,</span><br><span class="line">            symbol: function (params) &#123;</span><br><span class="line">              return scatterImg;</span><br><span class="line">            &#125;,</span><br><span class="line">            symbolSize: 30,</span><br><span class="line">            symbolOffset: [10, 0],</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              color: &quot;#1dfd28&quot;,</span><br><span class="line">            &#125;,</span><br><span class="line">            label: &#123;</span><br><span class="line">              normal: &#123;</span><br><span class="line">                show: true,</span><br><span class="line">                formatter: &quot;&#123;b&#125;&quot;,</span><br><span class="line">                fontSize: 18,</span><br><span class="line">                position: &quot;top&quot;,</span><br><span class="line">                backgroundColor: &#123;</span><br><span class="line">                  image: this.label,</span><br><span class="line">                &#125;,</span><br><span class="line">                offset: [0, 5],</span><br><span class="line">                align: &quot;center&quot;,</span><br><span class="line">                fontFamily: &quot;youshebiaoti&quot;,</span><br><span class="line">                padding: [6, 8, 6, 10],</span><br><span class="line">                color: &quot;#fff&quot;,</span><br><span class="line">                margin: [20, 0, 0, -20],</span><br><span class="line">              &#125;,</span><br><span class="line">              emphasis: &#123;</span><br><span class="line">                show: true,</span><br><span class="line">                backgroundColor: &#123;</span><br><span class="line">                  image: this.label2,</span><br><span class="line">                &#125;,</span><br><span class="line">                color: &quot;#fff&quot;,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            map: &quot;江西&quot;,</span><br><span class="line">            type: &quot;map&quot;,</span><br><span class="line">            zoom: 0.79,</span><br><span class="line">            data: mapdata,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              normal: &#123;</span><br><span class="line">                areaColor: areaColor,</span><br><span class="line">                color: &quot;transparent&quot;,</span><br><span class="line">                borderWidth: &quot;2.8&quot;,</span><br><span class="line">                borderColor: &quot;#b4eafc&quot;,</span><br><span class="line">                shadowColor: &quot;#07a4f8&quot;,</span><br><span class="line">                shadowOffsetX: 0,</span><br><span class="line">                shadowOffsetY: 4,</span><br><span class="line">                shadowBlur: 8,</span><br><span class="line">              &#125;,</span><br><span class="line">              emphasis: &#123;</span><br><span class="line">                label: &#123;</span><br><span class="line">                  show: false,</span><br><span class="line">                &#125;,</span><br><span class="line">                areaColor: &quot;#ce9735&quot;, //鼠标选择区域颜色</span><br><span class="line">                shadowOffsetX: 0,</span><br><span class="line">                shadowOffsetY: 0,</span><br><span class="line">                shadowBlur: 10,</span><br><span class="line">                shadowColor: &quot;rgba(255, 255, 255, 0.3)&quot;,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            select: &#123;</span><br><span class="line">              label: &#123;</span><br><span class="line">                show: false,</span><br><span class="line">                backgroundColor: &#123;</span><br><span class="line">                  image: this.label2,</span><br><span class="line">                &#125;,</span><br><span class="line">                color: &quot;#fff&quot;,</span><br><span class="line">              &#125;,</span><br><span class="line">              itemStyle: &#123;</span><br><span class="line">                areaColor: &quot;#ce9735&quot;, //鼠标选择区域颜色</span><br><span class="line">                shadowOffsetX: 0,</span><br><span class="line">                shadowOffsetY: 0,</span><br><span class="line">                shadowBlur: 10,</span><br><span class="line">                shadowColor: &quot;rgba(255, 255, 255, 0.3)&quot;,</span><br><span class="line">              &#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;;</span><br><span class="line">      this.myChart.setOption(this.option);</span><br><span class="line">      // if (this.mapLevels == 1) &#123;</span><br><span class="line">      //   this.myChart.dispatchAction(&#123;</span><br><span class="line">      //     type: &quot;highlight&quot;,</span><br><span class="line">      //     seriesIndex: 0,</span><br><span class="line">      //     dataIndex: 0,</span><br><span class="line">      //   &#125;);</span><br><span class="line">      //   this.myChart.dispatchAction(&#123;</span><br><span class="line">      //     type: &quot;highlight&quot;,</span><br><span class="line">      //     seriesIndex: 1,</span><br><span class="line">      //     dataIndex: 0,</span><br><span class="line">      //   &#125;);</span><br><span class="line">      // &#125;</span><br><span class="line">      this.myChart.off(&quot;mouseover&quot;);</span><br><span class="line">      this.myChart.on(&quot;mouseover&quot;, (e) =&gt; &#123;</span><br><span class="line">        if (!e.data) &#123;</span><br><span class="line">          this.mapdata.map((item) =&gt; &#123;</span><br><span class="line">            if (item.symbolSize == 40) &#123;</span><br><span class="line">              item.selected = true;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;);</span><br><span class="line">          this.myChart.setOption(this.option, true);</span><br><span class="line">          return;</span><br><span class="line">        &#125;</span><br><span class="line">        // this.$emit(&#x27;handle-map&#x27;, this.mapdata[e.dataIndex]);</span><br><span class="line">        this.mapdata.map((item, index) =&gt; &#123;</span><br><span class="line">          if (!(this.idxs &amp;&amp; this.idxs == index)) &#123;</span><br><span class="line">            item.symbol = item.name == e.name ? scatterHImg : scatterImg;</span><br><span class="line">            item.label =</span><br><span class="line">              item.name == e.name</span><br><span class="line">                ? &#123; backgroundColor: &#123; image: scatterHBg &#125; &#125;</span><br><span class="line">                : &#123; backgroundColor: &#123; image: scatterBg &#125; &#125;;</span><br><span class="line">            item.symbolSize = item.name == e.name ? 40 : 30;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        this.myChart.setOption(this.option, true);</span><br><span class="line">        this.myChart.dispatchAction(&#123;</span><br><span class="line">          type: &quot;highlight&quot;,</span><br><span class="line">          seriesIndex: 1,</span><br><span class="line">          dataIndex: e.dataIndex,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">      this.myChart.on(&quot;mouseout&quot;, (e) =&gt; &#123;</span><br><span class="line">        let chooseCode =</span><br><span class="line">          this.mapLevels == 1</span><br><span class="line">            ? this.cityCode</span><br><span class="line">            : this.mapLevels == 2</span><br><span class="line">            ? this.countyCode</span><br><span class="line">            : this.wgCode;</span><br><span class="line">        this.mapdata.map((item, index) =&gt; &#123;</span><br><span class="line">          item.symbol = chooseCode == item.code ? scatterHImg : scatterImg;</span><br><span class="line">          item.label =</span><br><span class="line">            chooseCode == item.code</span><br><span class="line">              ? &#123; backgroundColor: &#123; image: scatterHBg &#125; &#125;</span><br><span class="line">              : &#123; backgroundColor: &#123; image: scatterBg &#125; &#125;;</span><br><span class="line">          item.symbolSize = chooseCode == item.code ? 40 : 30;</span><br><span class="line">          item.selected = chooseCode == item.code ? true : false;</span><br><span class="line">        &#125;);</span><br><span class="line">        this.myChart.setOption(this.option, true);</span><br><span class="line">      &#125;);</span><br><span class="line">      window.addEventListener(&quot;resize&quot;, () =&gt; &#123;</span><br><span class="line">        if (this.myChart &amp;&amp; this.myChart.resize) &#123;</span><br><span class="line">          this.myChart.resize();</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">      this.loading = false;</span><br><span class="line">    &#125;,</span><br><span class="line">    initAMap(center, areaName) &#123;</span><br><span class="line">      AMapLoader.reset();</span><br><span class="line">      AMapLoader.load(&#123;</span><br><span class="line">        key: &quot;e23eebb87715448f86d21ccbfa9fad8e&quot;, // 申请好的Web端开发者Key，首次调用 load 时必填</span><br><span class="line">        version: &quot;2.0&quot;, // 指定要加载的 JSAPI 的版本，缺省时默认为 1.4.15</span><br><span class="line">        plugins: [</span><br><span class="line">          &quot;AMap.Scale&quot;,</span><br><span class="line">          &quot;AMap.ToolBar&quot;,</span><br><span class="line">          &quot;AMap.ControlBar&quot;,</span><br><span class="line">          &quot;AMap.Geocoder&quot;,</span><br><span class="line">          &quot;AMap.Marker&quot;,</span><br><span class="line">          &quot;AMap.CitySearch&quot;,</span><br><span class="line">          &quot;AMap.Geolocation&quot;,</span><br><span class="line">          &quot;AMap.AutoComplete&quot;,</span><br><span class="line">          &quot;AMap.InfoWindow&quot;,</span><br><span class="line">        ], // 需要使用的的插件列表，如比例尺&#x27;AMap.Scale&#x27;等</span><br><span class="line">      &#125;)</span><br><span class="line">        .then((AMap) =&gt; &#123;</span><br><span class="line">          // 获取到作为地图容器的DOM元素，创建地图实例</span><br><span class="line">          var that = this;</span><br><span class="line">          that.map = new AMap.Map(&quot;amapcontainer&quot;, &#123;</span><br><span class="line">            //设置地图容器id</span><br><span class="line">            scrollWheel: true,</span><br><span class="line">            viewMode: &quot;2D&quot;,</span><br><span class="line">            resizeEnable: true,</span><br><span class="line">            zoom: 20,</span><br><span class="line">            maxZoom: 30,</span><br><span class="line">            minZoom: 0,</span><br><span class="line">            mapStyle: &quot;amap://styles/darkblue&quot;,</span><br><span class="line">            center: center,</span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">          AMap.plugin(&quot;AMap.DistrictSearch&quot;, function () &#123;</span><br><span class="line">            var district = new AMap.DistrictSearch(&#123;</span><br><span class="line">              // 返回行政区边界坐标等具体信息</span><br><span class="line">              extensions: &quot;all&quot;,</span><br><span class="line">              // 设置查询行政区级别为 区</span><br><span class="line">              level: &quot;district&quot;,</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            district.search(areaName, function (status, result) &#123;</span><br><span class="line">              var bounds = result.districtList[0].boundaries;</span><br><span class="line">              var polygons = [];</span><br><span class="line">              if (bounds) &#123;</span><br><span class="line">                for (var i = 0, l = bounds.length; i &lt; l; i++) &#123;</span><br><span class="line">                  var polygon = new AMap.Polygon(&#123;</span><br><span class="line">                    map: that.map,</span><br><span class="line">                    strokeWeight: 1,</span><br><span class="line">                    path: bounds[i],</span><br><span class="line">                    fillOpacity: 0.4,</span><br><span class="line">                    fillColor: &quot;#009afb&quot;,</span><br><span class="line">                    strokeColor: &quot;#b4eafc&quot;,</span><br><span class="line">                    strokeWeight: 3,</span><br><span class="line">                  &#125;);</span><br><span class="line">                  polygons.push(polygon);</span><br><span class="line">                &#125;</span><br><span class="line">                that.map.setFitView();</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">        .catch((e) =&gt; &#123;</span><br><span class="line">          console.log(e);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    // 双击地图防抖</span><br><span class="line">    dblclick: debounce(function (params) &#123;</span><br><span class="line">      //注意这里传入function不能用箭头函数 否则this指向不对</span><br><span class="line">      if (this.mapLevels == 1) &#123;</span><br><span class="line">        this.mapLabels = params.data.name + &quot;市&quot;;</span><br><span class="line">        this.cityCode = params.data.code;</span><br><span class="line">        this.mapLevels = 2;</span><br><span class="line">        this.cityNum = params.dataIndex;</span><br><span class="line">      &#125; else if (this.mapLevels == 2) &#123;</span><br><span class="line">        if (defaultSettings.mapThreeLevel) &#123;</span><br><span class="line">          this.mapLevels = 3;</span><br><span class="line">          this.countyCode = params.data.code;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      // 如果方法里面用到了await 可在debounce里面传入的函数前面加上 async</span><br><span class="line">    &#125;, 100),</span><br><span class="line">    // level变化</span><br><span class="line">    async levelChange(newVal) &#123;</span><br><span class="line">      this.loading = true;</span><br><span class="line">      if (newVal == 0) return (this.mapLevels = 1);</span><br><span class="line">      if (newVal == 1.5) return (this.mapLevels = 2);</span><br><span class="line">      if (newVal == 1) &#123;</span><br><span class="line">        this.mapJson = await this.$api.getMapList(&#123; cityCode: &quot;0000&quot; &#125;);</span><br><span class="line">        this.mapdata = this.baseMapdata;</span><br><span class="line">        this.cityCode = &quot;0000&quot;;</span><br><span class="line">        this.countyCode = &quot;&quot;;</span><br><span class="line">        this.mapLabels = &quot;&quot;;</span><br><span class="line">        this.wgCode = &quot;&quot;;</span><br><span class="line">        // this.mapdata.map((item, index) =&gt; &#123;</span><br><span class="line">        //   if (item.code == this.cityCode) &#123;</span><br><span class="line">        //     this.cityNum = index;</span><br><span class="line">        //     this.mapLabels = item.name + &quot;市&quot;;</span><br><span class="line">        //   &#125;</span><br><span class="line">        // &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      if (newVal == 2) &#123;</span><br><span class="line">        // this.mapLabels = &quot;&quot;;</span><br><span class="line">        this.baseMapdata.map((item, index) =&gt; &#123;</span><br><span class="line">          if (item.code == this.cityCode) &#123;</span><br><span class="line">            this.cityNum = index;</span><br><span class="line">            this.mapLabels = item.name + &quot;市&quot;;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        this.countyCode = &quot;&quot;;</span><br><span class="line">        this.wgCode = &quot;&quot;;</span><br><span class="line">        this.mapJson = await this.$api.getMapList(&#123;</span><br><span class="line">          cityCode: this.cityCode,</span><br><span class="line">        &#125;);</span><br><span class="line">        this.getMapData();</span><br><span class="line">      &#125;</span><br><span class="line">      if (newVal == 3) &#123;</span><br><span class="line">        this.wgCode = &quot;&quot;;</span><br><span class="line">        this.mapJson = await this.$api.getMapList(&#123;</span><br><span class="line">          cityCode: this.cityCode,</span><br><span class="line">          countyCode: this.countyCode,</span><br><span class="line">        &#125;);</span><br><span class="line">        this.getMapData();</span><br><span class="line">      &#125;</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        this.mapdata.map((item, index) =&gt; &#123;</span><br><span class="line">          item.symbol = scatterImg;</span><br><span class="line">          item.symbolSize = 30;</span><br><span class="line">          item.selected = false;</span><br><span class="line">          item.label = &#123; backgroundColor: &#123; image: scatterBg &#125; &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">        this.refash();</span><br><span class="line">        this.drawMap(this.mapJson, this.mapdata);</span><br><span class="line">      &#125;, 500);</span><br><span class="line">    &#125;,</span><br><span class="line">    getMapData() &#123;</span><br><span class="line">      this.mapdata = [];</span><br><span class="line">      for (var i = 0; i &lt; this.mapJson.features.length; i++) &#123;</span><br><span class="line">        this.mapdata.push(&#123;</span><br><span class="line">          name: this.mapJson.features[i].properties.name,</span><br><span class="line">          value: this.mapJson.features[i].properties.centroid,</span><br><span class="line">          code: this.mapJson.features[i].properties.code,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    refash() &#123;</span><br><span class="line">      let countyCode = this.countyCode;</span><br><span class="line">      if (this.mapLabels == 1) countyCode = &quot;&quot;;</span><br><span class="line">      this.$emit(</span><br><span class="line">        &quot;initData&quot;,</span><br><span class="line">        this.cityCode,</span><br><span class="line">        this.cityCode == &quot;0000&quot; ? &quot;&quot; : countyCode</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line">.mapMain &#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  z-index: 100;</span><br><span class="line">  height: 100%;</span><br><span class="line"></span><br><span class="line">  &gt; div &#123;</span><br><span class="line">    height: 100%;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#amapcontainer &#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  left: 50%;</span><br><span class="line">  top: 200px;</span><br><span class="line">  transform: translateX(-50.9%);</span><br><span class="line">  width: 70%;</span><br><span class="line">  height: calc(100% - 350px);</span><br><span class="line">  border-radius: 1rem;</span><br><span class="line">  box-shadow: 0px 0px 40px 20px rgba(0, 0, 0, 0.5);</span><br><span class="line">  z-index: 101;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.cityBgc &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  position: absolute;</span><br><span class="line">  left: 50%;</span><br><span class="line">  top: 50%;</span><br><span class="line">  // 南昌</span><br><span class="line">  &amp;.city0 &#123;</span><br><span class="line">    transform: translateX(-50%) translateY(-50%) scale(0.47) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;.city1 &#123;</span><br><span class="line">    transform: translateX(-49.8%) translateY(-49.8%) scale(0.625) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  // 萍乡</span><br><span class="line">  &amp;.city2 &#123;</span><br><span class="line">    transform: translateX(-50%) translateY(-49.8%) scale(0.47) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;.city3 &#123;</span><br><span class="line">    transform: translateX(-51%) translateY(-50%) scale(1.63) !important;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;.city4 &#123;</span><br><span class="line">    transform: translateX(-47.3%) translateY(-48.7%) scale(0.485) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;.city5 &#123;</span><br><span class="line">    transform: translateX(-50.1%) translateY(-50.3%) scale(0.367) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;.city6 &#123;</span><br><span class="line">    transform: translateX(-50%) translateY(-49%) scale(0.495) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  // 鹰潭</span><br><span class="line">  &amp;.city7 &#123;</span><br><span class="line">    transform: translateX(-50%) translateY(-50%) scale(0.47) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  // 上饶</span><br><span class="line">  &amp;.city8 &#123;</span><br><span class="line">    transform: translateX(-50%) translateY(-50%) scale(0.47) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  // 九江</span><br><span class="line">  &amp;.city9 &#123;</span><br><span class="line">    transform: translateX(-50%) translateY(-50%) scale(0.71) !important;</span><br><span class="line">  &#125;</span><br><span class="line">  // 景德镇</span><br><span class="line">  &amp;.city10 &#123;</span><br><span class="line">    transform: translateX(-50%) translateY(-50%) scale(0.47) !important;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;style lang=&quot;scss&quot;&gt;</span><br><span class="line">.map-wrap &#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  .el-loading-mask &#123;</span><br><span class="line">    background-color: rgb(2 21 43 / 84%) !important;</span><br><span class="line">    margin: 0;</span><br><span class="line">    top: 17%;</span><br><span class="line">    right: 10%;</span><br><span class="line">    bottom: 10%;</span><br><span class="line">    left: 10%;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;echarts地图绘制以及下钻&quot;&gt;&lt;a href=&quot;#echarts地图绘制以及下钻&quot; class=&quot;headerlink&quot; title=&quot;echarts地图绘制以及下钻&quot;&gt;&lt;/a&gt;echarts地图绘制以及下钻&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;echar</summary>
      
    
    
    
    <category term="echarts" scheme="http://example.com/categories/echarts/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="echarts" scheme="http://example.com/tags/echarts/"/>
    
  </entry>
  
  <entry>
    <title>基于Vue3和Ts的表格嵌套表单</title>
    <link href="http://example.com/2023/08/08/%E5%9F%BA%E4%BA%8EVue3%E5%92%8CTs%E7%9A%84%E8%A1%A8%E6%A0%BC%E5%B5%8C%E5%A5%97%E8%A1%A8%E5%8D%95/"/>
    <id>http://example.com/2023/08/08/%E5%9F%BA%E4%BA%8EVue3%E5%92%8CTs%E7%9A%84%E8%A1%A8%E6%A0%BC%E5%B5%8C%E5%A5%97%E8%A1%A8%E5%8D%95/</id>
    <published>2023-08-08T12:16:32.000Z</published>
    <updated>2024-02-28T01:49:20.214Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基于Vue3和Ts的表格嵌套表单"><a href="#基于Vue3和Ts的表格嵌套表单" class="headerlink" title="基于Vue3和Ts的表格嵌套表单"></a><strong>基于Vue3和Ts的表格嵌套表单</strong></h1><blockquote><p>vue3+ts+<a href="https://element-plus.org/zh-CN/">element Plus</a>表格里嵌套表单：</p><ol><li>支持编辑保存操作</li><li>支持每一行数据的校验</li><li>支持表格数据的新增以及删除</li></ol></blockquote><h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230808154050481.png" alt="image-20230808154050481"></p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import type &#123; FormInstance &#125; from &#x27;element-plus&#x27;</span><br><span class="line">const list = reactive([</span><br><span class="line">  &#123;</span><br><span class="line">    key: &#x27;vue&#x27;,</span><br><span class="line">    value: &#x27;2.21&#x27;,</span><br><span class="line">    isModified: false,</span><br><span class="line">    isKeyValid: false,</span><br><span class="line">    isValueValid: false,</span><br><span class="line">    id: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    key: &#x27;react&#x27;,</span><br><span class="line">    value: &#x27;16.2&#x27;,</span><br><span class="line">    isModified: false,</span><br><span class="line">    isKeyValid: false,</span><br><span class="line">    isValueValid: false,</span><br><span class="line">    id: 1</span><br><span class="line">  &#125;</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">const existKeys = computed(() =&gt; &#123;</span><br><span class="line">  return list</span><br><span class="line">    .filter((item: any) =&gt; !item.isModified)</span><br><span class="line">    .map((item: any) =&gt; item.key)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const existValues = computed(() =&gt; &#123;</span><br><span class="line">  // 过滤出已经存在的value</span><br><span class="line">  return list</span><br><span class="line">    .filter((item: any) =&gt; !item.isModified)</span><br><span class="line">    .map((item: any) =&gt; item.value)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">const deleteKey = (index: number) =&gt; &#123;</span><br><span class="line">  list.splice(index, 1)</span><br><span class="line">&#125;</span><br><span class="line">const editKey = (index: number) =&gt; &#123;</span><br><span class="line">  // 改变编辑状态  变成form表单</span><br><span class="line">  list[index].isModified = true</span><br><span class="line">&#125;</span><br><span class="line">const cancel = (index: number) =&gt; &#123;</span><br><span class="line">  // 改变编辑状态  变成form表单</span><br><span class="line">  list[index].isModified = false</span><br><span class="line">&#125;</span><br><span class="line">const addKey = () =&gt; &#123;</span><br><span class="line">  list.push(&#123;</span><br><span class="line">    key: &#x27;&#x27;,</span><br><span class="line">    value: &#x27;&#x27;,</span><br><span class="line">    isModified: true, // 切换编辑状态的标志位</span><br><span class="line">    isKeyValid: false, // 判断Key的校验结果</span><br><span class="line">    isValueValid: false, // 判断value的校验结果</span><br><span class="line">    id: list.length</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">const promiseValidate = (key: string) =&gt; &#123;</span><br><span class="line">  console.log(key)</span><br><span class="line">  return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">      console.log(&#x27;tableFormRefs.value[key]&#x27;, tableFormRefs.value[key])</span><br><span class="line">      tableFormRefs.value[key].validate((isValid: boolean) =&gt; &#123;</span><br><span class="line">        resolve(isValid)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; catch (err) &#123;</span><br><span class="line">      console.log(&#x27;err&#x27;, err)</span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">const confirm = async (index: number) =&gt; &#123;</span><br><span class="line">  console.log(&#x27;attrs&#x27;, ref)</span><br><span class="line">  const validates = await Promise.all([</span><br><span class="line">    promiseValidate(&#x27;keyForm&#x27; + index),</span><br><span class="line">    promiseValidate(&#x27;valueForm&#x27; + index)</span><br><span class="line">  ])</span><br><span class="line">  if (validates.every((item) =&gt; item)) &#123;</span><br><span class="line">    list[index].isModified = false</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 设置一个遍历用来保存动态的ref对</span><br><span class="line">type formMap = &#123;</span><br><span class="line">  [key: string]: FormInstance</span><br><span class="line">&#125;</span><br><span class="line">const tableFormRefs: any = ref&lt;formMap&gt;(&#123;&#125;)</span><br><span class="line"></span><br><span class="line">const getRefName = (el: any, name: string, id: number) =&gt; &#123;</span><br><span class="line">  const objkey = name + id</span><br><span class="line">  tableFormRefs.value[objkey] = el</span><br><span class="line">  return objkey</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const validateKey = (rule: any, value: any, callback: any) =&gt; &#123;</span><br><span class="line">  console.log(&#x27;value&#x27;, value)</span><br><span class="line">  if (value === &#x27;&#x27;) &#123;</span><br><span class="line">    list[rule?.id].isKeyValid = true</span><br><span class="line">    callback(new Error(&#x27;请输入Key&#x27;))</span><br><span class="line">  &#125; else if (existKeys.value.includes(value)) &#123;</span><br><span class="line">    list[rule?.id].isKeyValid = true</span><br><span class="line">    callback(new Error(&#x27;Key的值已经重复&#x27;))</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    list[rule?.id].isKeyValid = false</span><br><span class="line">    callback()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const validateValue = (rule: any, value: any, callback: any) =&gt; &#123;</span><br><span class="line">  if (value === &#x27;&#x27;) &#123;</span><br><span class="line">    list[rule?.id].isValueValid = true</span><br><span class="line">    callback(new Error(&#x27;请输入Value&#x27;))</span><br><span class="line">  &#125; else if (existValues.value.includes(value)) &#123;</span><br><span class="line">    list[rule?.id].isValueValid = true</span><br><span class="line">    callback(new Error(&#x27;value的值已经重复&#x27;))</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    callback()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;formData&quot;&gt;</span><br><span class="line">    &lt;el-table :data=&quot;list&quot; style=&quot;width: 100%&quot;&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;key&quot; label=&quot;键&quot; min-width=&quot;180&quot;&gt;</span><br><span class="line">        &lt;template v-slot=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">          &lt;div v-if=&quot;!row.isModified&quot;&gt;</span><br><span class="line">            &#123;&#123; row.key &#125;&#125;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;el-form v-else :ref=&quot;(el: any) =&gt; getRefName(el, &#x27;keyForm&#x27;, row.id)&quot; label-width=&quot;0px&quot;</span><br><span class="line">            :class=&quot;row.isKeyValid || row.isValueValid ? &#x27;demo-ruleForm&#x27; : &#x27;&#x27;&quot; :model=&quot;row&quot;&gt;</span><br><span class="line">            &lt;el-form-item prop=&quot;key&quot; :rules=&quot;[</span><br><span class="line">              &#123;</span><br><span class="line">                validator: validateKey,</span><br><span class="line">                trigger: [&#x27;blur&#x27;, &#x27;change&#x27;],</span><br><span class="line">                id: row.id,</span><br><span class="line">              &#125;,</span><br><span class="line">            ]&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;row.key&quot; placeholder=&quot;请输入内容&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/el-form&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column prop=&quot;value&quot; label=&quot;值&quot; min-width=&quot;180&quot;&gt;</span><br><span class="line">        &lt;template v-slot=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">          &lt;div v-if=&quot;!row.isModified&quot;&gt;</span><br><span class="line">            &#123;&#123; row.value &#125;&#125;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;el-form v-else :ref=&quot;(el: any) =&gt; getRefName(el, &#x27;valueForm&#x27;, row.id)&quot; label-width=&quot;0px&quot;</span><br><span class="line">            :class=&quot;row.isKeyValid || row.isValueValid ? &#x27;demo-ruleForm&#x27; : &#x27;&#x27;&quot; :model=&quot;row&quot;&gt;</span><br><span class="line">            &lt;el-form-item prop=&quot;value&quot; :rules=&quot;[</span><br><span class="line">              &#123;</span><br><span class="line">                validator: validateValue,</span><br><span class="line">                trigger: [&#x27;blur&#x27;, &#x27;change&#x27;],</span><br><span class="line">                id: row.id,</span><br><span class="line">              &#125;,</span><br><span class="line">            ]&quot;&gt;</span><br><span class="line">              &lt;el-input v-model=&quot;row.value&quot; placeholder=&quot;请输入内容&quot; /&gt;</span><br><span class="line">            &lt;/el-form-item&gt;</span><br><span class="line">          &lt;/el-form&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">      &lt;el-table-column label=&quot;操作&quot; width=&quot;180&quot;&gt;</span><br><span class="line">        &lt;template v-slot=&quot;&#123; row &#125;&quot;&gt;</span><br><span class="line">          &lt;div v-if=&quot;!row.isModified&quot;&gt;</span><br><span class="line">            &lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;deleteKey(row.id)&quot;&gt;</span><br><span class="line">              删除</span><br><span class="line">            &lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;editKey(row.id)&quot;&gt;</span><br><span class="line">              编辑</span><br><span class="line">            &lt;/el-button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">          &lt;div v-else&gt;</span><br><span class="line">            &lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;confirm(row.id)&quot;&gt;</span><br><span class="line">              确认</span><br><span class="line">            &lt;/el-button&gt;</span><br><span class="line">            &lt;el-button type=&quot;text&quot; size=&quot;small&quot; @click=&quot;cancel(row.id)&quot;&gt;</span><br><span class="line">              取消</span><br><span class="line">            &lt;/el-button&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/template&gt;</span><br><span class="line">      &lt;/el-table-column&gt;</span><br><span class="line">    &lt;/el-table&gt;</span><br><span class="line">    &lt;el-button @click=&quot;addKey&quot;&gt;增加&lt;/el-button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">:deep().el-form-item__content .el-form-item__error &#123;</span><br><span class="line">  color: rgb(197, 27, 191) !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.formData &#123;</span><br><span class="line">  padding: 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.el-form-item &#123;</span><br><span class="line">  margin-bottom: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.demo-ruleForm &#123;</span><br><span class="line">  margin: 20px 0;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基于Vue3和Ts的表格嵌套表单&quot;&gt;&lt;a href=&quot;#基于Vue3和Ts的表格嵌套表单&quot; class=&quot;headerlink&quot; title=&quot;基于Vue3和Ts的表格嵌套表单&quot;&gt;&lt;/a&gt;&lt;strong&gt;基于Vue3和Ts的表格嵌套表单&lt;/strong&gt;&lt;/h1&gt;</summary>
      
    
    
    
    <category term="vue3" scheme="http://example.com/categories/vue3/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue3" scheme="http://example.com/tags/vue3/"/>
    
    <category term="ts" scheme="http://example.com/tags/ts/"/>
    
  </entry>
  
  <entry>
    <title>VueX与pinia的区别</title>
    <link href="http://example.com/2023/08/03/vuex%E4%B8%8Epinia%E5%8C%BA%E5%88%AB/"/>
    <id>http://example.com/2023/08/03/vuex%E4%B8%8Epinia%E5%8C%BA%E5%88%AB/</id>
    <published>2023-08-03T11:46:32.000Z</published>
    <updated>2024-02-28T01:49:49.353Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pinia与VueX的区别"><a href="#pinia与VueX的区别" class="headerlink" title="pinia与VueX的区别"></a><strong>pinia与VueX的区别</strong></h1><blockquote><p>pinia它没有mutation,他只有state，getters，action【同步、异步】使用他来修改state数据</p><p>pinia他默认也是存入内存中，如果需要使用本地存储，在配置上比vuex麻烦一点</p><p>pinia语法上比vuex更容易理解和使用，灵活。</p><p>pinia没有modules配置，没一个独立的仓库都是definStore生成出来的</p><p>pinia state是一个对象返回一个对象和组件的data是一样的语法</p></blockquote><h2 id="一、pinia和VueX的安装设置"><a href="#一、pinia和VueX的安装设置" class="headerlink" title="一、pinia和VueX的安装设置"></a>一、pinia和VueX的安装设置</h2><h3 id="1、Pinia-设置"><a href="#1、Pinia-设置" class="headerlink" title="1、Pinia 设置"></a>1、Pinia 设置</h3><p>Pinia 很容易上手，因为它只需要安装和创建一个store。</p><p>要安装 Pinia，您可以在终端中运行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yarn add pinia</span><br><span class="line"><span class="meta">#</span><span class="bash"> or with npm</span></span><br><span class="line">npm install pinia</span><br><span class="line"><span class="meta">#</span><span class="bash"> or with pnpm</span></span><br><span class="line">pnpm i pinia</span><br></pre></td></tr></table></figure><p>Pinia是一个围绕Vue 3 Composition API的封装器。因此，你不必把它作为一个插件来初始化，除非你需要Vue devtools支持、SSR支持和webpack代码分割的情况：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line">app.use(createPinia())</span><br></pre></td></tr></table></figure><p>在上面的片段中，你将Pinia添加到Vue.js项目中，这样你就可以在你的代码中使用Pinia的全局对象。</p><p>为了创建一个store，你用一个包含创建一个基本store所需的states、actions和getters的对象来调用 <code>defineStore</code> 方法。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stores/todo.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useTodoStore = defineStore(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;todo&#x27;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; <span class="attr">count</span>: <span class="number">0</span>, <span class="attr">title</span>: <span class="string">&quot;Cook noodles&quot;</span>, <span class="attr">done</span>:<span class="literal">false</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="1、Vuex-设置"><a href="#1、Vuex-设置" class="headerlink" title="1、Vuex 设置"></a>1、Vuex 设置</h3><p>Vuex 也很容易设置，需要安装和创建store。</p><p>要安装Vuex，您可以在终端中执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex@next --save</span><br><span class="line"><span class="comment"># or with yarn</span></span><br><span class="line">yarn add vuex@next --save</span><br><span class="line"><span class="comment"># or with pnpm</span></span><br><span class="line">pnpm add vuex@next --save</span><br></pre></td></tr></table></figure><p>要创建store，你可以使用包含创建基本store所需的states、actions和 getter 的对象调用 <code>createStore</code> 方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//store.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;createStore&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">const</span> useStore = createStore(&#123;</span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">todos</span>: [</span><br><span class="line">      &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">title</span>: <span class="string">&#x27;...&#x27;</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123;</span><br><span class="line">    doneTodos (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.todos.filter(<span class="function"><span class="params">todo</span> =&gt;</span> todo.done)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>要访问 Vuex 全局对象，需要在 Vue.js 项目根文件中添加 Vuex，如下所示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123;useStore&#125; <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line">createApp(App).use(store).mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="二、pinia和VueX的安装设置使用"><a href="#二、pinia和VueX的安装设置使用" class="headerlink" title="二、pinia和VueX的安装设置使用"></a>二、pinia和VueX的安装设置使用</h2><h3 id="1、Pinia使用"><a href="#1、Pinia使用" class="headerlink" title="1、Pinia使用"></a>1、Pinia使用</h3><p>使用 Pinia，可以按如下方式访问该store：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> todo = useTodoStore()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 只允许访问特定的state</span></span><br><span class="line">      <span class="attr">state</span>: computed(<span class="function">() =&gt;</span> todo.title),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>请注意，在访问其属性时省略了 store 的 <code>state</code> 对象。</p><h3 id="2、Vuex使用"><a href="#2、Vuex使用" class="headerlink" title="2、Vuex使用"></a>2、Vuex使用</h3><p>使用Vuex，可以按如下方式访问store：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  setup () &#123;</span><br><span class="line">    <span class="keyword">const</span> store = useStore()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 访问计算函数中的状态</span></span><br><span class="line">      <span class="attr">count</span>: computed(<span class="function">() =&gt;</span> store.state.count),</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 访问计算函数中的getter</span></span><br><span class="line">      <span class="attr">double</span>: computed(<span class="function">() =&gt;</span> store.getters.double)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="三、相同点"><a href="#三、相同点" class="headerlink" title="三、相同点"></a>三、相同点</h2><p>Pinia和Vuex的设计目标大致相同，这使得它们在很多方面也有相同之处。</p><h3 id="1、基于Vue-js状态管理机制"><a href="#1、基于Vue-js状态管理机制" class="headerlink" title="1、基于Vue.js状态管理机制"></a>1、基于Vue.js状态管理机制</h3><p>Pinia和Vuex都是基于Vue.js状态管理机制构建的。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Vuex Counter Module</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> counterSlice = createSlice(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;counter&#x27;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">increment</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value += <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decrement</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.value -= <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; increment, decrement &#125; = counterSlice.actions;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectCount = <span class="function">(<span class="params">state</span>) =&gt;</span> state.counter.value;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterSlice.reducer;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Pinia Counter Store</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = defineStore(&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&quot;counter&quot;</span>,</span><br><span class="line">    <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">actions</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">increment</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.count++;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">decrement</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.count--;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getters</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">getCount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.count;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="2、可预测的状态管理"><a href="#2、可预测的状态管理" class="headerlink" title="2、可预测的状态管理"></a>2、可预测的状态管理</h3><p>Pinia和Vuex都遵循单向数据流，仅通过提交更改或派发操作来调用 Vuex 中的 mutation 或在 Pinia 中直接更新 store 中的状态。</p><h2 id="四、不同点"><a href="#四、不同点" class="headerlink" title="四、不同点"></a>四、不同点</h2><h3 id="1、开发方式"><a href="#1、开发方式" class="headerlink" title="1、开发方式"></a>1、开发方式</h3><p>Pinia鼓励开发者使用类似于Vue.js的语法，并提供了与Vue.js融合度更高的API，使得Pinia的开发体验更加自然，降低了 Pinia 和 Vue.js 之间的学习曲线。而Vuex，则使用更加传统的方式，需要用户熟悉JavaScript中的一些概念，如actions、mutations等，上手和使用起来相对较为困难。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Vuex Counter Module</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="attr">counter</span>: &#123;</span><br><span class="line">      <span class="attr">namespaced</span>: <span class="literal">true</span>, <span class="comment">// 命名空间，因为此模块是独立的，不应该与其他模块发生冲突</span></span><br><span class="line">      <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">mutations</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">increment</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">          state.count++;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">decrement</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">          state.count--;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接在Vue组件中引用</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    ...mapState(<span class="string">&quot;counter&quot;</span>, [<span class="string">&quot;count&quot;</span>]),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Pinia Counter Store</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore, useState &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = defineStore(&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&quot;counter&quot;</span>,</span><br><span class="line">    <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">actions</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">increment</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.count++;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">decrement</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.count--;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getters</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">getCount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.count;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在Vue组件中应用</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/counter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> counterStore = useCounterStore();</span><br><span class="line">    <span class="keyword">const</span> count = useState(counterStore, <span class="string">&quot;count&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> increment = <span class="function">() =&gt;</span> counterStore.increment();</span><br><span class="line">    <span class="keyword">const</span> decrement = <span class="function">() =&gt;</span> counterStore.decrement();</span><br><span class="line">    <span class="keyword">return</span> &#123; count, increment, decrement &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="2、模块化开发"><a href="#2、模块化开发" class="headerlink" title="2、模块化开发"></a>2、模块化开发</h3><p>在Vuex中，Store模块是采用Namespace的方式划分模块的属性和方法，使得代码结构更加清晰，有助于更好地组织代码。Vuex可以方便地在全局注册和卸载Store模块。</p><p>Pinia则采用defineStore来定义Store模块，其局部安装的方式和Vue实例类似，使得项目更加灵活和模块化，避免全局注册带来的命名冲突问题。</p><p>Pinia的store是模块化的，这意味着每个store可以包含自己的状态、操作和插件。在Vuex中，store是全局的，这意味着所有的状态和操作都在同一个store中。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Vuex Counter Module</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="attr">counter</span>: &#123;</span><br><span class="line">      <span class="attr">namespaced</span>: <span class="literal">true</span>, <span class="comment">// 命名空间，因为此模块是独立的，不应该与其他模块发生冲突</span></span><br><span class="line">      <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">mutations</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">increment</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">          state.count++;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">decrement</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">          state.count--;</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">actions</span>: &#123;&#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局引用Vuex Store模块</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState, mapMutations &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    ...mapState(<span class="string">&quot;counter&quot;</span>, [<span class="string">&quot;count&quot;</span>]),</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    ...mapMutations(<span class="string">&quot;counter&quot;</span>, [<span class="string">&quot;increment&quot;</span>, <span class="string">&quot;decrement&quot;</span>]),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Pinia Counter Store</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useCounterStore = defineStore(&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&quot;counter&quot;</span>,</span><br><span class="line">    <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">actions</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">increment</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.count++;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="title">decrement</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.count--;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getters</span>: &#123;</span><br><span class="line">        <span class="function"><span class="title">getCount</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.count;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 局部引用Pinia Store模块</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineComponent &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/counter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> defineComponent(&#123;</span><br><span class="line">  <span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> counterStore = useCounterStore();</span><br><span class="line">    <span class="keyword">const</span> count = counterStore.count;</span><br><span class="line">    <span class="keyword">const</span> increment = <span class="function">() =&gt;</span> counterStore.increment();</span><br><span class="line">    <span class="keyword">const</span> decrement = <span class="function">() =&gt;</span> counterStore.decrement();</span><br><span class="line">    <span class="keyword">return</span> &#123; count, increment, decrement &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// main.js中注册引用</span></span><br><span class="line"><span class="keyword">import</span> &#123; createPinia &#125; <span class="keyword">from</span> <span class="string">&quot;pinia&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useCounterStore &#125; <span class="keyword">from</span> <span class="string">&quot;@/stores/counter&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = createApp(App);</span><br><span class="line">app.use(createPinia());</span><br><span class="line">app.mount(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="3、性能问题"><a href="#3、性能问题" class="headerlink" title="3、性能问题"></a>3、性能问题</h3><p>在Vuex中，所有状态变更都会触发所有相关组件的重新渲染，这可能会导致一些组件的重复渲染。但是，在多数情况下，这并没有导致什么性能问题。而Pinia则通过将状态存储在普通JavaScript对象中，该对象具有快速查询的优势，从而更快地获取数据，并在组件重绘时发出更新通知，避免了一些性能瓶颈，使效率更高。</p><h3 id="4、插件支持"><a href="#4、插件支持" class="headerlink" title="4、插件支持"></a>4、插件支持</h3><p>在Vuex中，通过插件可以实现诸如任务持久性存储、调试、异步状态日志记录等功能，在Vuex生态系统中有许多丰富的插件可供使用。而Pinia则缺乏强大的插件系统，暂时不支持类似于Vuex-LocalStorage、Vuex-Undo等插件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Vuex LocalStorage Plugin</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> createPersistedState <span class="keyword">from</span> <span class="string">&quot;vuex-persistedstate&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> Cookies <span class="keyword">from</span> <span class="string">&quot;js-cookie&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="comment">// LocalStorage Plugin</span></span><br><span class="line">    createPersistedState(&#123;</span><br><span class="line">      <span class="attr">storage</span>: &#123;</span><br><span class="line">        <span class="attr">getItem</span>: <span class="function">(<span class="params">key</span>) =&gt;</span> Cookies.getJSON(key),</span><br><span class="line">        <span class="attr">setItem</span>: <span class="function">(<span class="params">key, value</span>) =&gt;</span></span><br><span class="line">          Cookies.set(key, value, &#123; <span class="attr">expires</span>: <span class="number">10</span>, <span class="attr">secure</span>: <span class="literal">true</span> &#125;),</span><br><span class="line">        <span class="attr">removeItem</span>: <span class="function">(<span class="params">key</span>) =&gt;</span> Cookies.remove(key),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h2><blockquote><p>Vuex的优点</p><ul><li>支持调试功能，如时间旅行和编辑</li><li>适用于大型、高复杂度的Vue.js项目</li></ul><p>Vuex的缺点</p><ul><li>从 Vue 3 开始，getter 的结果不会像计算属性那样缓存</li><li>Vuex 4有一些与类型安全相关的问题</li></ul><p>Pinia的优点</p><ul><li>完整的 TypeScript 支持：与在 Vuex 中添加 TypeScript 相比，添加 TypeScript 更容易</li><li>极其轻巧（体积约 1KB）</li><li>store 的 action 被调度为常规的函数调用，而不是使用 <code>dispatch</code> 方法或 <code>MapAction</code> 辅助函数，这在 Vuex 中很常见</li><li>支持多个Store</li><li>支持 Vue devtools、SSR 和 webpack 代码拆分</li></ul><p>Pinia的缺点</p><ul><li>不支持时间旅行和编辑等调试功能</li></ul></blockquote><p>Pinia和Vuex都是Vue.js状态管理机制，它们的设计目标大致相同。然而，它们的开发方式、模块化、性能问题和插件支持等方面存在差异。在开发Vue.js应用程序时，应根据具体需求，选择合适的状态管理库。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pinia与VueX的区别&quot;&gt;&lt;a href=&quot;#pinia与VueX的区别&quot; class=&quot;headerlink&quot; title=&quot;pinia与VueX的区别&quot;&gt;&lt;/a&gt;&lt;strong&gt;pinia与VueX的区别&lt;/strong&gt;&lt;/h1&gt;&lt;blockquote&gt;</summary>
      
    
    
    
    <category term="vue3" scheme="http://example.com/categories/vue3/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue3" scheme="http://example.com/tags/vue3/"/>
    
    <category term="pinia" scheme="http://example.com/tags/pinia/"/>
    
  </entry>
  
  <entry>
    <title>vue项目字体配置</title>
    <link href="http://example.com/2023/07/28/vue%E9%A1%B9%E7%9B%AE%E5%AD%97%E4%BD%93%E9%85%8D%E7%BD%AE/"/>
    <id>http://example.com/2023/07/28/vue%E9%A1%B9%E7%9B%AE%E5%AD%97%E4%BD%93%E9%85%8D%E7%BD%AE/</id>
    <published>2023-07-28T12:16:32.000Z</published>
    <updated>2024-02-28T01:48:52.798Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vue项目字体配置"><a href="#vue项目字体配置" class="headerlink" title="vue项目字体配置"></a><strong>vue项目字体配置</strong></h1><blockquote><p>在开发项目中，可以使用自带的字体，比如微软雅黑或宋体等（宋体很丑，不建议用）；为了能让字体在网页中展示出美观，一些默认字体并不能满足需求的；也可以自己下载字体去用。本篇文章记录一下如何修改项目中的字体。</p></blockquote><h2 id="第一步："><a href="#第一步：" class="headerlink" title="第一步："></a>第一步：</h2><p>首先要得到自定义字体包（后缀名为.ttf, .otf, .eot等格式的字体包），可自行下载也可以问UI小姐姐要字体包，拿到字体包后进入项目中在assets文件夹下建一个font文件夹</p><p>好用的字体库</p><p><a href="https://www.yuque.com/fontbook/cn">字体</a></p><p><a href="https://link.zhihu.com/?target=https://www.ypppt.com/ziti/">字体库下载_中文英文字体库_字体库大全 - 优品PPTwww.ypppt.com/ziti/</a></p><h2 id="第二步："><a href="#第二步：" class="headerlink" title="第二步："></a>第二步：</h2><p>把拿到的字体包放到font文件夹中接着创建一个font.css文件</p><h2 id="第三步："><a href="#第三步：" class="headerlink" title="第三步："></a>第三步：</h2><p>在font.css文件中定义你所用的字体<strong>（这里以PingFang为例）</strong><br> font.css文件：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@font-face</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&#x27;PingFang-RE&#x27;</span>; <span class="comment">/* 重命名字体名 */</span></span><br><span class="line">    <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;PINGFANG REGULAR.TTF&#x27;</span>);</span><br><span class="line">    <span class="attribute">font-weight</span>: normal;</span><br><span class="line">    <span class="attribute">font-style</span>: normal;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="第四步："><a href="#第四步：" class="headerlink" title="第四步："></a>第四步：</h2><p>在app.vue中引入font.css</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">  <span class="keyword">@import</span> <span class="string">&#x27;./assets/font/font.css&#x27;</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-id">#app</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-family</span>: <span class="string">&#x27;PingFang-RE&#x27;</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-weight</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;vue项目字体配置&quot;&gt;&lt;a href=&quot;#vue项目字体配置&quot; class=&quot;headerlink&quot; title=&quot;vue项目字体配置&quot;&gt;&lt;/a&gt;&lt;strong&gt;vue项目字体配置&lt;/strong&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;在开发项目中，可以使用自</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>pnpm+monorepo+vite+ts项目构建打包</title>
    <link href="http://example.com/2023/06/20/pnpm+monorepo+vite+ts%E9%A1%B9%E7%9B%AE/"/>
    <id>http://example.com/2023/06/20/pnpm+monorepo+vite+ts%E9%A1%B9%E7%9B%AE/</id>
    <published>2023-06-20T12:16:32.000Z</published>
    <updated>2024-02-28T01:49:32.511Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pnpm-monorepo-vite-ts项目构建打包（持续更新中）"><a href="#pnpm-monorepo-vite-ts项目构建打包（持续更新中）" class="headerlink" title="pnpm+monorepo+vite+ts项目构建打包（持续更新中）"></a><strong>pnpm+monorepo+vite+ts项目构建打包（持续更新中）</strong></h1><blockquote><p><code>pnpm</code>：performant npm ，意味“高性能的 npm”。<a href="https://so.csdn.net/so/search?q=pnpm&spm=1001.2101.3001.7020">pnpm</a>由npm/yarn衍生而来，解决了npm/yarn内部潜在的bug，极大的优化了性能，扩展了使用场景。被誉为“最先进的包管理工具。<a href="https://pnpm.io/zh/motivation">pnpm官网</a></p><p><code>monorepo</code>：管理多个不同项目的单一存储库，这些项目有可能是相关的，但通常又是逻辑相对独立的</p><p><code>vite</code>：下一代前端开发与构建工具<a href="https://vitejs.cn/">vite官网</a></p><p><code>typescript</code>：TypeScript是一种由微软开发的自由和开源的编程语言。它是JavaScript的一个超集。<a href="https://typescript.bootcss.com/">ts中文手册</a></p></blockquote><p>[TOC]</p><h2 id="安装pnpm"><a href="#安装pnpm" class="headerlink" title="安装pnpm"></a>安装pnpm</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g pnpm</span><br></pre></td></tr></table></figure><h2 id="根目录创建"><a href="#根目录创建" class="headerlink" title="根目录创建"></a>根目录创建</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm create vite</span><br></pre></td></tr></table></figure><p>添加monorepo配置文件<code>pnpm-workspace.yaml</code>具体配置参数</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620165128490.png" alt="image-20230620165128490"></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">packages:</span><br><span class="line">  # all packages or sub projects in direct subdirs of packages/</span><br><span class="line">  - &#x27;projects<span class="comment">/*&#x27;</span></span><br><span class="line"><span class="comment">  # all packages in subdirs of components/</span></span><br><span class="line"><span class="comment">  - &#x27;components/**&#x27;</span></span><br><span class="line"><span class="comment">  - &#x27;utils/**&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="创建projects"><a href="#创建projects" class="headerlink" title="创建projects"></a>创建projects</h2><p>在根目录里面新建projects目录，在<strong>projects</strong>目录下通过<code>vite</code>搭建<code>vue3</code>项目，并且搭建的时候选择<code>ts</code>。</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620170148280.png" alt="image-20230620170148280"></p><h2 id="创建compoments，utils模块"><a href="#创建compoments，utils模块" class="headerlink" title="创建compoments，utils模块"></a>创建compoments，utils模块</h2><h3 id="compoments全局引入"><a href="#compoments全局引入" class="headerlink" title="compoments全局引入"></a>compoments全局引入</h3><p>使用vite脚手架创建compoments模块和utils模块，projects新建一个目录就行，脚手架搭建的一些不需要的就可以删除，最终我的components目录是这样的</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620165548238.png" alt="image-20230620165548238"></p><p>在package.json中把那么根据项目重置方便后续引入</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620165653288.png" alt="image-20230620165653288"></p><p>在src里面写自己的组件并且在index.ts里面将组件引入</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620165728064.png" alt="image-20230620165728064"><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620165928295.png" alt="image-20230620165928295"></p><blockquote><p>在项目中引入项目引入components</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add @monorepo/components</span><br></pre></td></tr></table></figure></blockquote><p>此时在根目录的package.json中就会出现引入的组件</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">“dependencies<span class="string">&quot;: &#123;</span></span><br><span class="line"><span class="string">    &quot;</span>@monorepo/components<span class="string">&quot;: &quot;</span>workspace:^<span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span>@monorepo/utils<span class="string">&quot;: &quot;</span>workspace:^<span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span>vue<span class="string">&quot;: &quot;</span>^<span class="number">3.2</span><span class="number">.47</span><span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span>vue-router<span class="string">&quot;: &quot;</span>^<span class="number">3.5</span><span class="number">.4</span><span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span>vuex<span class="string">&quot;: &quot;</span>^<span class="number">3.6</span><span class="number">.2</span><span class="string">&quot;,</span></span><br><span class="line"><span class="string">    &quot;</span>vuex-persistedstate<span class="string">&quot;: &quot;</span>^<span class="number">4.1</span><span class="number">.0</span><span class="string">&quot;,</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br></pre></td></tr></table></figure><p>在需要用组件的地方引入组件就可以正常使用了</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620170622893.png" alt="image-20230620170622893"></p><h3 id="utils全局引入"><a href="#utils全局引入" class="headerlink" title="utils全局引入"></a>utils全局引入</h3><p>utils引入和components引入差不多，只不过在components里面src放置的是vue文件，utils里面放置的是.ts文件</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620171002581.png" alt="image-20230620171002581"><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620171015220.png" alt="image-20230620171015220"></p><h2 id="代码上传规范化"><a href="#代码上传规范化" class="headerlink" title="代码上传规范化"></a>代码上传规范化</h2><h3 id="git-cz"><a href="#git-cz" class="headerlink" title="git cz"></a>git cz</h3><blockquote><p>git cz 相当于是一个对于 git commit 的提交命令的加强版，<br>使 git commit 规范化提交。</p></blockquote><p>首先需要安装 Commitizen （Commitizen是一个格式化commit message的工具，git cz 是依赖于Commitizen  commitizen (交互式提交 + 自定义提示文案 + Commit规范)</p><h4 id="安装Commitizen"><a href="#安装Commitizen" class="headerlink" title="安装Commitizen"></a>安装Commitizen</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pnpm install -D commitizen cz-conventional-changelog @commitlint/config-conventional @commitlint/cli commitlint-config-cz cz-customizable </span><br><span class="line">配置 package.json</span><br></pre></td></tr></table></figure><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">  <span class="attr">&quot;cm&quot;</span>: <span class="string">&quot;git-cz&quot;</span>,</span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;config&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;commitizen&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;path&quot;</span>: <span class="string">&quot;./node_modules/cz-customizable&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="新增配置-commitlint-config-js"><a href="#新增配置-commitlint-config-js" class="headerlink" title="新增配置 commitlint.config.js"></a>新增配置 commitlint.config.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">extends</span>: [<span class="string">&#x27;@commitlint/config-conventional&#x27;</span>, <span class="string">&#x27;cz&#x27;</span>],</span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;type-enum&#x27;</span>: [</span><br><span class="line">      <span class="number">2</span>,</span><br><span class="line">      <span class="string">&#x27;always&#x27;</span>,</span><br><span class="line">      [</span><br><span class="line">        <span class="string">&#x27;feat&#x27;</span>, <span class="comment">// 新功能（feature）</span></span><br><span class="line">        <span class="string">&#x27;bug&#x27;</span>, <span class="comment">// 此项特别针对bug号，用于向测试反馈bug列表的bug修改情况</span></span><br><span class="line">        <span class="string">&#x27;fix&#x27;</span>, <span class="comment">// 修补bug</span></span><br><span class="line">        <span class="string">&#x27;ui&#x27;</span>, <span class="comment">// 更新 ui</span></span><br><span class="line">        <span class="string">&#x27;docs&#x27;</span>, <span class="comment">// 文档（documentation）</span></span><br><span class="line">        <span class="string">&#x27;style&#x27;</span>, <span class="comment">// 格式（不影响代码运行的变动）</span></span><br><span class="line">        <span class="string">&#x27;perf&#x27;</span>, <span class="comment">// 性能优化</span></span><br><span class="line">        <span class="string">&#x27;release&#x27;</span>, <span class="comment">// 发布</span></span><br><span class="line">        <span class="string">&#x27;deploy&#x27;</span>, <span class="comment">// 部署</span></span><br><span class="line">        <span class="string">&#x27;refactor&#x27;</span>, <span class="comment">// 重构（即不是新增功能，也不是修改bug的代码变动）</span></span><br><span class="line">        <span class="string">&#x27;test&#x27;</span>, <span class="comment">// 增加测试</span></span><br><span class="line">        <span class="string">&#x27;chore&#x27;</span>, <span class="comment">// 构建过程或辅助工具的变动</span></span><br><span class="line">        <span class="string">&#x27;revert&#x27;</span>, <span class="comment">// feat(pencil): add ‘graphiteWidth’ option (撤销之前的commit)</span></span><br><span class="line">        <span class="string">&#x27;merge&#x27;</span>, <span class="comment">// 合并分支， 例如： merge（前端页面）： feature-xxxx修改线程地址</span></span><br><span class="line">        <span class="string">&#x27;build&#x27;</span>, <span class="comment">// 打包</span></span><br><span class="line">      ],</span><br><span class="line">    ],</span><br><span class="line">    <span class="comment">// &lt;type&gt; 格式 小写</span></span><br><span class="line">    <span class="string">&#x27;type-case&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;always&#x27;</span>, <span class="string">&#x27;lower-case&#x27;</span>],</span><br><span class="line">    <span class="comment">// &lt;type&gt; 不能为空</span></span><br><span class="line">    <span class="string">&#x27;type-empty&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line">    <span class="comment">// &lt;scope&gt; 范围不能为空</span></span><br><span class="line">    <span class="string">&#x27;scope-empty&#x27;</span>: [<span class="number">0</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line">    <span class="comment">// &lt;scope&gt; 范围格式</span></span><br><span class="line">    <span class="string">&#x27;scope-case&#x27;</span>: [<span class="number">0</span>],</span><br><span class="line">    <span class="comment">// &lt;subject&gt; 主要 message 不能为空</span></span><br><span class="line">    <span class="string">&#x27;subject-empty&#x27;</span>: [<span class="number">2</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line">    <span class="comment">// &lt;subject&gt; 以什么为结束标志，禁用</span></span><br><span class="line">    <span class="string">&#x27;subject-full-stop&#x27;</span>: [<span class="number">0</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line">    <span class="comment">// &lt;subject&gt; 格式，禁用</span></span><br><span class="line">    <span class="string">&#x27;subject-case&#x27;</span>: [<span class="number">0</span>, <span class="string">&#x27;never&#x27;</span>],</span><br><span class="line">    <span class="comment">// &lt;body&gt; 以空行开头</span></span><br><span class="line">    <span class="string">&#x27;body-leading-blank&#x27;</span>: [<span class="number">1</span>, <span class="string">&#x27;always&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;header-max-length&#x27;</span>: [<span class="number">0</span>, <span class="string">&#x27;always&#x27;</span>, <span class="number">72</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="自定义提示则添加-cz-config-js"><a href="#自定义提示则添加-cz-config-js" class="headerlink" title="自定义提示则添加 .cz-config.js"></a>自定义提示则添加 .cz-config.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line"><span class="attr">types</span>: [</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;feat&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;feat: 增加新功能&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;bug&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;bug: 测试反馈bug列表中的bug号&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;fix&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;fix: 修复bug&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;ui&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;ui: 更新UI&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;docs&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;docs: 文档变更&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;style&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;style: 代码格式(不影响代码运行的变动)&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;perf&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;perf: 性能优化&#x27;</span> &#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">value</span>: <span class="string">&#x27;refactor&#x27;</span>,</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;refactor: 重构(既不是增加feature，也不是修复bug)&#x27;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;release&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;release: 发布&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;deploy&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;deploy: 部署&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;test&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;test: 增加测试&#x27;</span> &#125;,</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">value</span>: <span class="string">&#x27;chore&#x27;</span>,</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;chore: 构建过程或辅助工具的变动(更改配置文件)&#x27;</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;revert&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;revert: 回退&#x27;</span> &#125;,</span><br><span class="line">&#123; <span class="attr">value</span>: <span class="string">&#x27;build&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;build: 打包&#x27;</span> &#125;,</span><br><span class="line">],</span><br><span class="line"><span class="attr">messages</span>: &#123;</span><br><span class="line"><span class="attr">type</span>: <span class="string">&#x27;请选择提交类型:&#x27;</span>,</span><br><span class="line"><span class="attr">customScope</span>: <span class="string">&#x27;请输入您修改的范围(可选):&#x27;</span>,</span><br><span class="line"><span class="attr">subject</span>: <span class="string">&#x27;请简要描述提交 message (必填):&#x27;</span>,</span><br><span class="line"><span class="attr">body</span>: <span class="string">&#x27;请输入详细描述(可选，待优化去除，跳过即可):&#x27;</span>,</span><br><span class="line"><span class="attr">footer</span>: <span class="string">&#x27;请输入要关闭的issue(待优化去除，跳过即可):&#x27;</span>,</span><br><span class="line"><span class="attr">confirmCommit</span>: <span class="string">&#x27;确认使用以上信息提交？(y/n/e/h)&#x27;</span>,</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">allowCustomScopes</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="attr">skipQuestions</span>: [<span class="string">&#x27;body&#x27;</span>, <span class="string">&#x27;footer&#x27;</span>],</span><br><span class="line"><span class="attr">subjectLimit</span>: <span class="number">72</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="交互界面测试"><a href="#交互界面测试" class="headerlink" title="交互界面测试"></a>交互界面测试</h4><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620173836268.png" alt="image-20230620173836268"></p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230620174450761.png" alt="image-20230620174450761"></p><h2 id="配置清除node-modules"><a href="#配置清除node-modules" class="headerlink" title="配置清除node_modules"></a>配置清除node_modules</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line"><span class="attr">&quot;clean&quot;</span>: <span class="string">&quot;rm -rf node_modules **/node_modules **/*/node_modules&quot;</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="配置打包（更新中）"><a href="#配置打包（更新中）" class="headerlink" title="配置打包（更新中）"></a>配置打包（更新中）</h2><h3 id="单独项目打包"><a href="#单独项目打包" class="headerlink" title="单独项目打包"></a>单独项目打包</h3><p>可以在根目录里面对每一个项目进行单独的打包和运行</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;project-test:dev&quot;</span>: <span class="string">&quot;pnpm --filter project-test dev&quot;</span>,</span><br><span class="line"><span class="string">&quot;project-admin:dev&quot;</span>: <span class="string">&quot;pnpm --filter project-admin dev&quot;</span>,</span><br><span class="line"><span class="string">&quot;project-test:build&quot;</span>: <span class="string">&quot;pnpm --filter project-test build&quot;</span>,</span><br><span class="line"><span class="string">&quot;project-test:build:staging&quot;</span>: <span class="string">&quot;pnpm --filter project-test build:staging&quot;</span></span><br></pre></td></tr></table></figure><p>通过pnpm –filter可以选择当前想要操作的项目</p><blockquote><p>pnpm常用指令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//删除相关依赖</span><br><span class="line">pnpm remove -D # 删除开发环境 devDependencies 中的依赖项</span><br><span class="line">pnpm rm -P #  删除dependencies 中相关依赖项</span><br><span class="line">pnpm uninstall -g # 全局中删除</span><br><span class="line">pnpm prune # 移除没有在项目中使用的packages</span><br><span class="line">//管理node版本</span><br><span class="line">pnpm env use --global lts # 安装lts版node</span><br><span class="line">pnpm env use --global 18  # 安装v18版node</span><br><span class="line">pnpm env use --global latest # 安装最新node</span><br><span class="line">pnpm env remove --global 14.0.0 # 移除指定版本node</span><br><span class="line">pnpm env list # 查看本地有的node版本</span><br><span class="line">pnpm env list --remote # 查看网络源可用的node版本</span><br></pre></td></tr></table></figure></blockquote><h3 id="总体打包到根目录"><a href="#总体打包到根目录" class="headerlink" title="总体打包到根目录"></a>总体打包到根目录</h3><p>在vite.config.js中添加</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getEntries &#125; <span class="keyword">from</span> <span class="string">&quot;./entry&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="built_in">module</span>.exports = defineConfig(&#123;</span><br><span class="line">  <span class="attr">plugins</span>: [vue()],</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">      <span class="attr">input</span>: getEntries().map(<span class="function">(<span class="params">entry</span>) =&gt;</span> path.resolve(__dirname, <span class="string">`<span class="subst">$&#123;entry.template&#125;</span>`</span>)),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>根目录新建entry.ts</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// entry.ts</span></span><br><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> fs <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br><span class="line">interface IEntry &#123;</span><br><span class="line">  <span class="attr">template</span>: string;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> entries: <span class="built_in">Array</span>&lt;IEntry&gt; = [];</span><br><span class="line"><span class="keyword">const</span> getEntries = (): <span class="built_in">Array</span>&lt;IEntry&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> pathName = path.join(__dirname, <span class="string">&quot;./projects&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> files = fs.readdirSync(pathName);</span><br><span class="line">  files.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> stat = fs.lstatSync(<span class="string">`<span class="subst">$&#123;pathName&#125;</span>/<span class="subst">$&#123;file&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">if</span> (stat.isDirectory()) &#123;</span><br><span class="line">      entries.push(&#123; <span class="attr">template</span>: <span class="string">`projects/<span class="subst">$&#123;file&#125;</span>/index.html`</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> entries;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> &#123; getEntries &#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在根目录的package.json中添加</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;build&quot;</span>: <span class="string">&quot;rm -rf dist &amp;&amp; vue-tsc &amp;&amp; vite build&quot;</span>,</span><br></pre></td></tr></table></figure><h3 id="配置打包到根目录"><a href="#配置打包到根目录" class="headerlink" title="配置打包到根目录"></a>配置打包到根目录</h3><h4 id="inquirerjs-是什么"><a href="#inquirerjs-是什么" class="headerlink" title="inquirerjs 是什么"></a>inquirerjs 是什么</h4><p>Inquirer 是常规交互式命令行用户接口的集合，提供给 Node.js 一个方便嵌入，漂亮的命令行接口。 Inquirer 会简化询问终端用户问题，解析，验证答案，提供错误反馈等等功能。 Inquirer基于诺言的npm软件包，用于Node项目中，以创建用于基于查询的任务的CLI(命令行界面)工具。 询问用户问题，验证用户输入并根据给定的响应进行操作非常好。</p><p>通俗来讲就是它帮助我们实现与用户的交互式交流，比如给用户提一个问题，用户给我们一个答案，我们根据用户的答案来做一些事情</p><h4 id="inquirerjs-特色："><a href="#inquirerjs-特色：" class="headerlink" title="inquirerjs 特色："></a>inquirerjs 特色：</h4><ul><li>提供错误回调</li><li>可以提出问题</li><li>解析输入的答案</li><li>验证答案</li><li>管理分层提示</li></ul><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><p><code>npm i -S inquirer</code><br>​<br>使用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">&#x27;inquirer&#x27;</span>);</span><br><span class="line">inquirer</span><br><span class="line"> .prompt([</span><br><span class="line">  <span class="comment">/* 在这里配置您的问题（可以设置多个，它们将按顺序向用户提出） */</span></span><br><span class="line"> ])</span><br><span class="line"> .then(<span class="function"><span class="params">answers</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 回调，对用户输入的答案就行处理</span></span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure><h4 id="简单功能参数介绍"><a href="#简单功能参数介绍" class="headerlink" title="简单功能参数介绍"></a>简单功能参数介绍</h4><blockquote><p>type：表示提问的类型，包括：input、confirm、 list、rawlist、expand、checkbox、password、 - editor。 name: 存储当前输入的值。 message：问题的描述。 default：默认值。 choices：列表选项，在某些type下可用，并且包含一个分隔符(separator)； validate：对用户的回答进行校验。 filter：对用户的回答进行过滤处理，返回处理后的值。 when：根据前面问题的回答，判断当前问题是否需要被回答。 pageSize：修改某些type类型下的渲染行数。 prefix：修改message默认前缀。 suffix：修改message默认后缀。</p></blockquote><h4 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h4><p><strong>inquirer.prompt(questions, answers) -&gt; promise</strong> –启动提示界面（查询会话）</p><p><strong>inquirer.registerPrompt(name, prompt)</strong> –注册一个提问类型插件</p><p><strong>inquirer.createPromptModule() -&gt; prompt function</strong> –创建一个独立的查询器模块。如果您不想在覆盖或添加新提示类型时影响也依赖查询器的其他库。</p><p>案</p><h4 id="配置打包"><a href="#配置打包" class="headerlink" title="配置打包"></a>配置打包</h4><p>当前仓库内有多个project，但是我想可以根据配置想打包哪些那几个project，这个配置可以在通过<code>inquirer</code>在命令行内去选择。</p><p>新建一个build的文件夹用来放打包的文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 命令行问题抽出进行配置，之后build.js不用动</span></span><br><span class="line"><span class="keyword">const</span> lang = <span class="built_in">require</span>(<span class="string">&quot;./config.js&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">&quot;inquirer&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="comment">//运行命令</span></span><br><span class="line"><span class="keyword">const</span> shell = <span class="built_in">require</span>(<span class="string">&quot;shelljs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> pathName = path.join(__dirname, <span class="string">&quot;../projects&quot;</span>);</span><br><span class="line"><span class="comment">// 获取config配置的命令行交互内容</span></span><br><span class="line"><span class="keyword">let</span> promps = lang;</span><br><span class="line"><span class="keyword">var</span> step = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> condition = [];</span><br><span class="line"><span class="keyword">let</span> entries = [];</span><br><span class="line"><span class="comment">// 因为配置的不确定性，所以此处做了递归，将根据传入的lang进行比较</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selected</span>(<span class="params">step</span>) </span>&#123;</span><br><span class="line"> <span class="keyword">if</span> (step &lt; promps.length) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(step);</span><br><span class="line">  inquirer.prompt(promps[step]).then(<span class="keyword">async</span> (answers) =&gt; &#123;</span><br><span class="line">   step++;</span><br><span class="line">   condition.push(answers);</span><br><span class="line">   <span class="keyword">return</span> selected(step);</span><br><span class="line">  &#125;);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// 打包文件获取</span></span><br><span class="line">  condition[<span class="number">0</span>].projects.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="keyword">const</span> stat = fs.lstatSync(<span class="string">`<span class="subst">$&#123;pathName&#125;</span>/<span class="subst">$&#123;file&#125;</span>`</span>);</span><br><span class="line">   <span class="keyword">if</span> (stat.isDirectory()) &#123;</span><br><span class="line">    entries.push(<span class="string">`projects/<span class="subst">$&#123;file&#125;</span>/index.html`</span>);</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">console</span>.log(</span><br><span class="line">   <span class="string">`正在打包<span class="subst">$&#123;condition[<span class="number">0</span>].projects.join(<span class="string">&quot;,&quot;</span>)&#125;</span>的<span class="subst">$&#123;consoleText.join(</span></span></span><br><span class="line"><span class="subst"><span class="string">    <span class="string">&quot;-&quot;</span></span></span></span><br><span class="line"><span class="subst"><span class="string">   )&#125;</span>包，请稍等片刻。。。。。。。。`</span></span><br><span class="line">  );</span><br><span class="line">  <span class="comment">//将选择的需要打包的文件名存在环境变量里面，在vite.config中build的时候去获取</span></span><br><span class="line">  process.env.BUILD_PROS = entries;</span><br><span class="line">  shell.exec(<span class="string">&quot;pnpm run build&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line">selected(step);</span><br><span class="line"></span><br><span class="line">在config.js中去配置命令行</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&quot;path&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> pathName = path.join(__dirname, <span class="string">&quot;../projects&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> files = fs.readdirSync(pathName);</span><br><span class="line"><span class="built_in">module</span>.exports= [</span><br><span class="line"> [</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="attr">type</span>: <span class="string">&quot;checkbox&quot;</span>,</span><br><span class="line">   <span class="attr">message</span>: <span class="string">&quot;选择要打包的文件&quot;</span>,</span><br><span class="line">   <span class="attr">name</span>: <span class="string">&quot;projects&quot;</span>,</span><br><span class="line">   <span class="attr">choices</span>: files,</span><br><span class="line">  &#125;,</span><br><span class="line">​</span><br><span class="line"> ],</span><br><span class="line">];</span><br><span class="line">​</span><br></pre></td></tr></table></figure><p>在vite.config.js中去获取配置好的打包的文件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> path <span class="keyword">from</span> <span class="string">&quot;path&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> type &#123; ConfigEnv, UserConfigExport &#125; <span class="keyword">from</span> <span class="string">&quot;vite&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> vue <span class="keyword">from</span> <span class="string">&quot;@vitejs/plugin-vue&quot;</span>;</span><br><span class="line"><span class="comment">//获取选择的文件</span></span><br><span class="line"><span class="keyword">let</span> files = process.env.BUILD_PROS</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123; command, mode &#125;: ConfigEnv): <span class="function"><span class="params">UserConfigExport</span> =&gt;</span> &#123;</span><br><span class="line"> <span class="keyword">const</span> config: UserConfigExport = &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [vue()],</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">   <span class="attr">minify</span>: <span class="string">&quot;terser&quot;</span>,</span><br><span class="line">   <span class="attr">terserOptions</span>: &#123;</span><br><span class="line">    <span class="attr">compress</span>: &#123;</span><br><span class="line">     <span class="attr">drop_console</span>: <span class="literal">true</span>,</span><br><span class="line">     <span class="attr">drop_debugger</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">rollupOptions</span>: &#123;</span><br><span class="line">    <span class="comment">// 确保外部化处理那些你不想打包进库的依赖</span></span><br><span class="line">    <span class="attr">external</span>: [<span class="string">&quot;vue&quot;</span>, <span class="string">&quot;element-plus&quot;</span>],</span><br><span class="line">    <span class="comment">//打包</span></span><br><span class="line">    <span class="attr">input</span>: files.map(<span class="function">(<span class="params">entry</span>) =&gt;</span> path.resolve(__dirname, <span class="string">`<span class="subst">$&#123;entry&#125;</span>`</span>)),</span><br><span class="line">   &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"> &#125;;</span><br><span class="line">​</span><br><span class="line"> <span class="keyword">return</span> config;</span><br><span class="line">&#125;;</span><br><span class="line">​</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pnpm-monorepo-vite-ts项目构建打包（持续更新中）&quot;&gt;&lt;a href=&quot;#pnpm-monorepo-vite-ts项目构建打包（持续更新中）&quot; class=&quot;headerlink&quot; title=&quot;pnpm+monorepo+vite+ts项目构</summary>
      
    
    
    
    <category term="vue3" scheme="http://example.com/categories/vue3/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue3" scheme="http://example.com/tags/vue3/"/>
    
    <category term="pnpm" scheme="http://example.com/tags/pnpm/"/>
    
    <category term="vite" scheme="http://example.com/tags/vite/"/>
    
    <category term="monorepo" scheme="http://example.com/tags/monorepo/"/>
    
    <category term="ts" scheme="http://example.com/tags/ts/"/>
    
  </entry>
  
  <entry>
    <title>基于vue2下的echarts转置图表</title>
    <link href="http://example.com/2023/06/05/echart%E5%9B%BE%E8%A1%A8%E8%BD%AC%E7%BD%AE/"/>
    <id>http://example.com/2023/06/05/echart%E5%9B%BE%E8%A1%A8%E8%BD%AC%E7%BD%AE/</id>
    <published>2023-06-05T12:16:32.000Z</published>
    <updated>2024-02-28T01:48:43.333Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基于vue2下的echarts转置图表"><a href="#基于vue2下的echarts转置图表" class="headerlink" title="基于vue2下的echarts转置图表"></a><strong>基于vue2下的echarts转置图表</strong></h1><blockquote><p><code>echarts</code></p><p>1、什么是ECharts?<br>ECharts是一个使用 JavaScript 实现的”数据可视化”库, 它可以流畅的运行在 PC 和移动设备上</p><p>2、什么是数据可视化?</p><p>也就是可以将数据通过图表的形式展示出来，</p><p>3、ECharts提供的图表类型：</p><p>ECharts 提供了常见的折线图、柱状图、散点图、饼图、K线图，用于统计的盒形图<br>用于地理数据可视化的地图、热力图、线图，用于关系数据可视化的关系图、treemap、旭日图，多维数据可视化的平行坐标<br>还有用于 BI 的漏斗图，仪表盘，并且支持图与图之间的混搭</p><p>4、ECharts显示图表的原理：</p><p>ECharts4.0之前, 底层是使用canvas标签来实现图表绘制的</p><p>ECharts4.0开始, 为了提升移动端性能, 还支持 SVG 渲染</p><p>ECharts 5 新增支持动态排序柱状图（bar-racing）以及动态排序折线图（line-racing）等：（<a href="https://echarts.apache.org/zh/index.html">echarts官网</a>）。</p></blockquote><h2 id="一、echarts在vue2中的引入和应用"><a href="#一、echarts在vue2中的引入和应用" class="headerlink" title="一、echarts在vue2中的引入和应用"></a>一、echarts在vue2中的引入和应用</h2><h3 id="NPM-安装-ECharts"><a href="#NPM-安装-ECharts" class="headerlink" title="NPM 安装 ECharts"></a>NPM 安装 ECharts</h3><p>你可以使用如下命令通过 npm 安装 ECharts</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install echarts --save</span><br></pre></td></tr></table></figure><h3 id="引入-ECharts"><a href="#引入-ECharts" class="headerlink" title="引入 ECharts"></a>引入 ECharts</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&#x27;echarts&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 基于准备好的dom，初始化echarts实例</span></span><br><span class="line"><span class="keyword">var</span> myChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">&#x27;main&#x27;</span>));</span><br><span class="line"><span class="comment">// 绘制图表</span></span><br><span class="line">myChart.setOption(&#123;</span><br><span class="line">  <span class="attr">title</span>: &#123;</span><br><span class="line">    <span class="attr">text</span>: <span class="string">&#x27;ECharts 入门示例&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">tooltip</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">xAxis</span>: &#123;</span><br><span class="line">    <span class="attr">data</span>: [<span class="string">&#x27;衬衫&#x27;</span>, <span class="string">&#x27;羊毛衫&#x27;</span>, <span class="string">&#x27;雪纺衫&#x27;</span>, <span class="string">&#x27;裤子&#x27;</span>, <span class="string">&#x27;高跟鞋&#x27;</span>, <span class="string">&#x27;袜子&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">yAxis</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">series</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;销量&#x27;</span>,</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: [<span class="number">5</span>, <span class="number">20</span>, <span class="number">36</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">20</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="二、简单的echarts图表"><a href="#二、简单的echarts图表" class="headerlink" title="二、简单的echarts图表"></a>二、简单的echarts图表</h2><h3 id="1、柱状图"><a href="#1、柱状图" class="headerlink" title="1、柱状图"></a>1、柱状图</h3><h4 id="基础柱状图"><a href="#基础柱状图" class="headerlink" title="基础柱状图"></a>基础柱状图</h4><p>最简单的柱状图可以这样设置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">option = &#123;</span><br><span class="line">  <span class="attr">xAxis</span>: &#123;</span><br><span class="line">    <span class="attr">data</span>: [<span class="string">&#x27;Mon&#x27;</span>, <span class="string">&#x27;Tue&#x27;</span>, <span class="string">&#x27;Wed&#x27;</span>, <span class="string">&#x27;Thu&#x27;</span>, <span class="string">&#x27;Fri&#x27;</span>, <span class="string">&#x27;Sat&#x27;</span>, <span class="string">&#x27;Sun&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">yAxis</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">series</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: [<span class="number">23</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">25</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>在这个例子中，横坐标是类目型的，因此需要在 <code>xAxis</code> 中指定对应的值；而纵坐标是数值型的，可以根据 <code>series</code> 中的 <code>data</code>，自动生成对应的坐标范围。</p><h4 id="多系列的柱状图"><a href="#多系列的柱状图" class="headerlink" title="多系列的柱状图"></a>多系列的柱状图</h4><p>我们可以用一个系列表示一组相关的数据，如果需要实现多系列的柱状图，只需要在 <code>series</code> 多添加一项就可以了——</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">option = &#123;</span><br><span class="line">  <span class="attr">xAxis</span>: &#123;</span><br><span class="line">    <span class="attr">data</span>: [<span class="string">&#x27;Mon&#x27;</span>, <span class="string">&#x27;Tue&#x27;</span>, <span class="string">&#x27;Wed&#x27;</span>, <span class="string">&#x27;Thu&#x27;</span>, <span class="string">&#x27;Fri&#x27;</span>, <span class="string">&#x27;Sat&#x27;</span>, <span class="string">&#x27;Sun&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">yAxis</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">series</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: [<span class="number">23</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">25</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">25</span>]</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>,</span><br><span class="line">      <span class="attr">data</span>: [<span class="number">26</span>, <span class="number">24</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">20</span>, <span class="number">27</span>]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="2、折线图"><a href="#2、折线图" class="headerlink" title="2、折线图"></a>2、折线图</h3><ul><li>直观描述变化趋势</li><li>可描述一个或多个项目</li><li>可在极坐标下展示</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">option =&#123;</span><br><span class="line">            <span class="attr">title</span>: &#123;</span><br><span class="line">                <span class="attr">text</span>: <span class="string">&#x27;ECharts 入门示例&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">tooltip</span>: &#123;&#125;,</span><br><span class="line">            <span class="attr">xAxis</span>: &#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;category&#x27;</span>,</span><br><span class="line">                <span class="comment">// xAxis.type是category类目轴，适用于离散的类目数据。</span></span><br><span class="line">                <span class="comment">// xAxis.type= &#x27;value&#x27; 数值轴，适用于连续数据。</span></span><br><span class="line">                <span class="comment">// data: [1,2,3,4,5,6]</span></span><br><span class="line">                <span class="comment">// data: [&#x27;2022-04-01&#x27;, &#x27;2022-04-02&#x27;, &#x27;2022-04-03&#x27;, &#x27;2022-04-04&#x27;, &#x27;2022-04-05&#x27;, &#x27;2022-04-06&#x27;]</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">yAxis</span>: &#123;</span><br><span class="line">                <span class="comment">// type: &#x27;value&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">series</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;销量&#x27;</span>,</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;line&#x27;</span>, <span class="comment">//设置成折线图</span></span><br><span class="line">                    <span class="attr">data</span>: [</span><br><span class="line">                        <span class="comment">// 数据转换成笛卡尔坐标系的形式进行展示</span></span><br><span class="line">                        [<span class="string">&#x27;2022-04-01&#x27;</span>, <span class="number">0</span>],</span><br><span class="line">                        [<span class="string">&#x27;2022-04-02&#x27;</span>, <span class="number">2</span>],</span><br><span class="line">                        [<span class="string">&#x27;2022-04-03&#x27;</span>, <span class="number">11</span>],</span><br><span class="line">                        [<span class="string">&#x27;2022-04-04&#x27;</span>, <span class="number">2</span>],</span><br><span class="line">                        [<span class="string">&#x27;2022-04-05&#x27;</span>, <span class="number">0</span>],</span><br><span class="line">                        [<span class="string">&#x27;2022-04-06&#x27;</span>, <span class="number">21</span>]</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h3 id="3、图表类型概述"><a href="#3、图表类型概述" class="headerlink" title="3、图表类型概述"></a>3、图表类型概述</h3><p>图表类型通过每个系列的type 决定。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">series: [&#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;销量&#x27;</span>,  <span class="comment">// 系列名称</span></span><br><span class="line"><span class="attr">type</span>: <span class="string">&#x27;bar&#x27;</span>,  <span class="comment">// 系列图表类型</span></span><br><span class="line"><span class="attr">data</span>: [<span class="number">5</span>, <span class="number">20</span>, <span class="number">36</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">20</span>]  <span class="comment">// 系列中的数据内容</span></span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure><blockquote><p>每个系列通过 type 决定自己的图表类型：<br>不同的type的值对应的图表类型如下：<br>type: ‘bar’：柱状/条形图<br>type: ‘line’：折线/面积图<br>type: ‘pie’：饼图<br>type: ‘scatter’：散点（气泡）图<br>type: ‘effectScatter’：带有涟漪特效动画的散点（气泡）<br>type: ‘radar’：雷达图<br>type: ‘tree’：树型图<br>type: ‘treemap’：树型图<br>type: ‘sunburst’：旭日图<br>type: ‘boxplot’：箱形图<br>type: ‘candlestick’：K线图<br>type: ‘heatmap’：热力图<br>type: ‘map’：地图<br>type: ‘parallel’：平行坐标系的系列<br>type: ‘lines’：线图<br>type: ‘graph’：关系图<br>type: ‘sankey’：桑基图<br>type: ‘funnel’：漏斗图<br>type: ‘gauge’：仪表盘<br>type: ‘pictorialBar’：象形柱图<br>type: ‘themeRiver’：主题河流<br>type: ‘custom’：自定义系列</p></blockquote><h2 id="三、图表之间的转置"><a href="#三、图表之间的转置" class="headerlink" title="三、图表之间的转置"></a>三、图表之间的转置</h2><h3 id="1、柱状图之间的转换"><a href="#1、柱状图之间的转换" class="headerlink" title="1、柱状图之间的转换"></a>1、柱状图之间的转换</h3><p>通过在简单的图表中的柱状图的内容来看，纵向的柱状图的时候我们的xAxis负责的是横坐标轴的数据，yAxis负责的则是y轴；现在我们想要将纵向的柱状图转置成横向的坐标图其实就是把option中的数据进行改变</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">xAxis: &#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;value&#x27;</span></span><br><span class="line"> &#125;,</span><br><span class="line"><span class="attr">yAxis</span>: &#123;</span><br><span class="line"><span class="attr">type</span>: <span class="string">&#x27;category&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: [<span class="string">&#x27;Mon&#x27;</span>, <span class="string">&#x27;Tue&#x27;</span>, <span class="string">&#x27;Wed&#x27;</span>, <span class="string">&#x27;Thu&#x27;</span>, <span class="string">&#x27;Fri&#x27;</span>, <span class="string">&#x27;Sat&#x27;</span>, <span class="string">&#x27;Sun&#x27;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>总结：</strong></p><p><strong>① 柱状图的横向与纵向的设置与x轴和y轴的设置有关。</strong></p><p><strong>② 将柱状图从纵向改成横向显示，只需要交换xAxis和yAxis中的设置即可。</strong></p><h3 id="2、图表之间的转置"><a href="#2、图表之间的转置" class="headerlink" title="2、图表之间的转置"></a>2、图表之间的转置</h3><p>通过图表类型概述的内容，我们可以知道不同的图表的type是不同的</p><p>方法一：echarts自带（该方法能进行折线图和柱状图的切换，因为这两种图表渲染的数据格式是一致的）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在options中加入以下配置即可</span></span><br><span class="line">    <span class="attr">toolbox</span>: &#123;</span><br><span class="line">        <span class="attr">show</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">feature</span>: &#123;</span><br><span class="line">            <span class="attr">magicType</span>: &#123;<span class="attr">type</span>: [<span class="string">&#x27;line&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>]&#125;<span class="comment">//此处最新版本echarts可设置三个值（stack-堆叠模式）,可自行查看echarts文档</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>方法二：自己进行数据处理，改变图表option中的type，并重新渲染echarts</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//**此方法要注意的问题，在切换时移除_echarts_instance_属性，并将渲染的id置空，否则会出现配置覆盖等问题**</span></span><br><span class="line"><span class="built_in">this</span>.echartsDataCopy= <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(<span class="built_in">this</span>.echartsData))</span><br><span class="line"><span class="built_in">this</span>.seriesData.type = <span class="string">&#x27;line&#x27;</span></span><br><span class="line"><span class="keyword">var</span> chartDom = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;echarts&#x27;</span>)</span><br><span class="line"><span class="built_in">this</span>.chartDom = <span class="built_in">this</span>.$echarts.init(chartDom);</span><br><span class="line"><span class="built_in">this</span>.chartDom.clear() <span class="comment">//清空画布数据</span></span><br><span class="line"><span class="built_in">this</span>.chartDom.setOption(</span><br><span class="line"><span class="keyword">var</span> option = &#123;</span><br><span class="line">        <span class="attr">tooltip</span>: &#123;</span><br><span class="line">          <span class="attr">trigger</span>: <span class="string">&#x27;axis&#x27;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">xAxis</span>: xAxis,</span><br><span class="line">        <span class="attr">yAxis</span>: yAxis,</span><br><span class="line">        <span class="attr">series</span>: seriesData,</span><br><span class="line">        <span class="comment">// toolbox,</span></span><br><span class="line">        <span class="attr">legend</span>: &#123;</span><br><span class="line">          <span class="attr">data</span>: seriesData</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">graphic</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">type</span>: <span class="string">&#x27;group&#x27;</span>,</span><br><span class="line">            <span class="comment">// rotation: Math.PI / 2,</span></span><br><span class="line">            <span class="attr">bounding</span>: <span class="string">&#x27;raw&#x27;</span>,</span><br><span class="line">            <span class="attr">right</span>: <span class="number">200</span>,</span><br><span class="line">            <span class="attr">top</span>: <span class="number">40</span>,</span><br><span class="line">            <span class="attr">z</span>: <span class="number">100</span>,</span><br><span class="line">            <span class="attr">children</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&#x27;text&#x27;</span>,</span><br><span class="line">                <span class="attr">left</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">                <span class="attr">top</span>: <span class="string">&#x27;center&#x27;</span>,</span><br><span class="line">                <span class="attr">z</span>: <span class="number">100</span>,</span><br><span class="line">                <span class="attr">style</span>: &#123;</span><br><span class="line">                  <span class="attr">fill</span>: <span class="string">&#x27;#cccccc&#x27;</span>,</span><br><span class="line">                  <span class="attr">text</span>: <span class="string">`<span class="subst">$&#123;<span class="built_in">this</span>.$utils.getCache(<span class="string">&#x27;userInfo&#x27;</span>).username&#125;</span>`</span>,</span><br><span class="line">                  <span class="attr">font</span>: <span class="string">&#x27;bold 16px sans-serif&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;,</span><br><span class="line">        ],) </span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基于vue2下的echarts转置图表&quot;&gt;&lt;a href=&quot;#基于vue2下的echarts转置图表&quot; class=&quot;headerlink&quot; title=&quot;基于vue2下的echarts转置图表&quot;&gt;&lt;/a&gt;&lt;strong&gt;基于vue2下的echarts转置图表&lt;/</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="echarts" scheme="http://example.com/tags/echarts/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>基于vue2下的echarts转置图表</title>
    <link href="http://example.com/2023/06/05/vue3%E9%A1%B9%E7%9B%AEgit%E6%A0%A1%E9%AA%8C%E9%85%8D%E7%BD%AE/"/>
    <id>http://example.com/2023/06/05/vue3%E9%A1%B9%E7%9B%AEgit%E6%A0%A1%E9%AA%8C%E9%85%8D%E7%BD%AE/</id>
    <published>2023-06-05T12:16:32.000Z</published>
    <updated>2024-02-28T01:49:02.113Z</updated>
    
    <content type="html"><![CDATA[<h1 id="git校验配置"><a href="#git校验配置" class="headerlink" title="git校验配置"></a><strong>git校验配置</strong></h1><blockquote><p><code>echarts</code></p><p>1、引入ESlint</p><p>2、使用Prettier</p><p>3、引入husky</p><p>4、使用commitlint</p><p>5、配置lint-staged</p></blockquote><p>欲先善其事,必先利其器。一个好的项目是必须要有一个统一的规范,比如代码规范,样式规范以及代码提交规范等。统一的代码规范旨在增强团队开发协作、提高代码质量和打造开发基石,所以每个人必须严格遵守。</p><h2 id="ESlint"><a href="#ESlint" class="headerlink" title="ESlint"></a>ESlint</h2><p><code>ESLint</code> 是在 <code>ECMAScript/JavaScript</code> 代码中识别和报告模式匹配的工具，它的目标是保证代码的一致性和避免错误,我们来看一下如何在我们的项目中使用它</p><p>首先安装 ESLint</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add eslint -D -w</span><br></pre></td></tr></table></figure><p>初始化 ESLint</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm create @eslint/config</span><br></pre></td></tr></table></figure><p>此时会出现一些选项让我们选择,如下</p><p><img src="https://ucc.alicdn.com/pic/developer-ecology/ehfav3w5t3m2m_91e3eb0e56444c17b243aebde87b73b0.png" alt="image.png"></p><p>因为我们使用的是 pnpm,所以选择安装那些插件的时候我们选择了 No,这里我们用 pnpm 手动安装一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i eslint-plugin-vue@latest @typescript-eslint/eslint-plugin@latest @typescript-eslint/parser@latest -D -w</span><br></pre></td></tr></table></figure><p>此时我们会发现根目录出现了 ESlint 的配置文件<code>.eslintrc.cjs</code>,我们对这个文件进行了一些配置上的修改后如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  <span class="attr">env</span>: &#123;</span><br><span class="line">    <span class="attr">browser</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">es2021</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">node</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">extends</span>: [</span><br><span class="line">    <span class="string">&#x27;eslint:recommended&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;plugin:vue/vue3-essential&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;plugin:@typescript-eslint/recommended&#x27;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">globals</span>: &#123;</span><br><span class="line">    <span class="attr">defineOptions</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">parser</span>: <span class="string">&#x27;vue-eslint-parser&#x27;</span>,</span><br><span class="line">  <span class="attr">parserOptions</span>: &#123;</span><br><span class="line">    <span class="attr">ecmaVersion</span>: <span class="string">&#x27;latest&#x27;</span>,</span><br><span class="line">    <span class="attr">sourceType</span>: <span class="string">&#x27;module&#x27;</span>,</span><br><span class="line">    <span class="attr">parser</span>: <span class="string">&#x27;@typescript-eslint/parser&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="string">&#x27;vue&#x27;</span>, <span class="string">&#x27;@typescript-eslint&#x27;</span>],</span><br><span class="line">  <span class="attr">rules</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;@typescript-eslint/ban-ts-comment&#x27;</span>: <span class="string">&#x27;off&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;vue/multi-word-component-names&#x27;</span>: <span class="string">&#x27;off&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>同时我们新建<code>.eslintignore</code>来忽略一些文件的校验</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">**.d.ts</span><br><span class="line">/packages/easyest</span><br><span class="line">dist</span><br><span class="line">node_modules</span><br></pre></td></tr></table></figure><p>然后我们在 package.json 的 script 中添加命令 lint:script</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;lint:script&quot;</span>: <span class="string">&quot;eslint --ext .js,.jsx,.vue,.ts,.tsx --fix --quiet ./&quot;</span></span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>然后执行<code>pnpm run lint:script</code>就能看到一些不规范的地方,现在肯定会有小伙伴问为什么不能保存的时候自动格式化呢,别急,下面会提到如何保存自动格式化。</p><h2 id="集成-Prettier"><a href="#集成-Prettier" class="headerlink" title="集成 Prettier"></a>集成 Prettier</h2><p>其实只有 ESlint 是完全不够的, ESLint 经常结合 Prettier 一起使用才能体现它们的能力,Prettier 主要是对代码做格式化,接下来我们看下如何将两者结合起来</p><p>同样的先安装<code>Prettier</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add prettier -D -w</span><br></pre></td></tr></table></figure><p>新建文件<code>.prettierrc.cjs</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  printWidth: 80, //一行的字符数，如果超过会进行换行，默认为80</span><br><span class="line">  tabWidth: 2, // 一个 tab 代表几个空格数，默认为 2 个</span><br><span class="line">  useTabs: false, //是否使用 tab 进行缩进，默认为false，表示用空格进行缩减</span><br><span class="line">  singleQuote: true, // 字符串是否使用单引号，默认为 false，使用双引号</span><br><span class="line">  semi: true, // 行尾是否使用分号，默认为true</span><br><span class="line">  trailingComma: &#x27;none&#x27;, // 是否使用尾逗号</span><br><span class="line">  bracketSpacing: true // 对象大括号直接是否有空格，默认为 true，效果：&#123; a: 1 &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>安装 eslint-config-prettier(覆盖 eslint 本身规则)和 eslint-plugin-prettier(Prettier 来接管 eslint –fix 即修复代码的能力)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add eslint-config-prettier eslint-plugin-prettier -D -w</span><br></pre></td></tr></table></figure><p>配置.eslintrc.cjs,新增的部分加了注释(注意配置完后将 VSCode 格式化文档默认选择 prettier)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  env: &#123;</span><br><span class="line">    browser: true,</span><br><span class="line">    es2021: true,</span><br><span class="line">    node: true</span><br><span class="line">  &#125;,</span><br><span class="line">  extends: [</span><br><span class="line">    &#x27;eslint:recommended&#x27;,</span><br><span class="line">    &#x27;plugin:vue/vue3-essential&#x27;,</span><br><span class="line">    &#x27;plugin:@typescript-eslint/recommended&#x27;,</span><br><span class="line">    // 1. 接入 prettier 的规则</span><br><span class="line">    &#x27;prettier&#x27;,</span><br><span class="line">    &#x27;plugin:prettier/recommended&#x27;</span><br><span class="line">  ],</span><br><span class="line">  globals: &#123;</span><br><span class="line">    defineOptions: true</span><br><span class="line">  &#125;,</span><br><span class="line">  parser: &#x27;vue-eslint-parser&#x27;,</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    ecmaVersion: &#x27;latest&#x27;,</span><br><span class="line">    sourceType: &#x27;module&#x27;,</span><br><span class="line">    parser: &#x27;@typescript-eslint/parser&#x27;</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [&#x27;vue&#x27;, &#x27;@typescript-eslint&#x27;],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    // 2. 开启 prettier 自动修复的功能</span><br><span class="line">    &#x27;prettier/prettier&#x27;: &#x27;error&#x27;,</span><br><span class="line">    &#x27;@typescript-eslint/ban-ts-comment&#x27;: &#x27;off&#x27;,</span><br><span class="line">    &#x27;vue/multi-word-component-names&#x27;: &#x27;off&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>最后执行<code>pnpm run lint:script</code>即可完成 ESLint 规则校验检查以及 Prettier 的自动修复</p><p>我们通常希望在保存代码的时候编辑器就能给我们自动格式化修复,VSCode 就可以做到,只需要一个简单的配置即可,在设置里搜索如下图所示配置</p><p><img src="https://ucc.alicdn.com/pic/developer-ecology/ehfav3w5t3m2m_e2d937d686fd46e89a4b82315dc6ceec.png" alt="image.png"></p><p>这样设置完后按ctrl+s就能自动格式化代码了。</p><p>到这里 ESlint+Prettier 已经配置完毕</p><h2 id="为什么要引入-husky"><a href="#为什么要引入-husky" class="headerlink" title="为什么要引入 husky?"></a>为什么要引入 husky?</h2><p>虽然我们项目中引入了<code>prettier</code>和<code>eslint</code>对代码格式进行了校验,但是多人开发的时候难免依然会有人提交不符合规范的代码到仓库中,如果我们拉取到这种代码还得慢慢对其进行修改,这是一件很麻烦的事情,同时也为了避免团队成员提交五花八门message,因此我们可以引入 husky 来从源头上解决此类问题。简单来说,husky 可以在我们提交代码之前校验我们的代码是否符合我们配置的规范。接下来就让我们看一下 husky 的具体使用吧!</p><h2 id="husky-的使用"><a href="#husky-的使用" class="headerlink" title="husky 的使用"></a>husky 的使用</h2><p>首先安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm i husky -D -w</span><br></pre></td></tr></table></figure><p>在 package.json 中 scripts 中设置 prepare 钩子:<code>husky install</code>,在使用<code>pnpm install</code>的时候就会自动执行<code>husky</code>,以便于别人拉取完我们代码进行<code>pnpm insall</code>的时候直接进行<code>husky install</code>。我们可以使用命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm pkg set scripts.prepare=&quot;husky install&quot;</span><br></pre></td></tr></table></figure><p>或者你也可以手动添加</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    ...</span><br><span class="line">    &quot;prepare&quot;: &quot;husky install&quot;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>因为我们没有执行<code>pnpm install</code>,所以要先执行一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx husky install</span><br></pre></td></tr></table></figure><p>然后添加一个 commit 钩子文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx husky add .husky/pre-commit &quot;npm run xxx&quot;</span><br></pre></td></tr></table></figure><p>然后我们就会发现根目录出现了.husky/pre-commit 文件,我们修改一下 commit 之前的命令,让其提交之前先进行 lint 校验</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env sh</span><br><span class="line">. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;</span><br><span class="line">pnpm run lint:script</span><br><span class="line">pnpm run lint:style</span><br></pre></td></tr></table></figure><p>修改一个不符合 eslint 的规范文件,然后进行提交之后你会发现它会先自动给你修复之后再进行提交,如果无法修复则抛出一个错误</p><h2 id="commitlint-的安装与使用"><a href="#commitlint-的安装与使用" class="headerlink" title="commitlint 的安装与使用"></a>commitlint 的安装与使用</h2><p>我们看开源项目的时候会看到他们代码提交信息会有诸如<code>feat: 添加xxx</code>,<code>fix: 修复xxxbug</code>之类的信息,其实这些也是有一个规范的,下面列举一些常用的 git 提交规范</p><ul><li>build: 编译相关的修改，例如发布版本、对项目构建或者依赖的改动</li><li>chore: 其他修改, 比如改变构建流程、或者增加依赖库、工具等</li><li>ci: 持续集成修改</li><li>docs: 文档修改</li><li>feat: 新特性、新功能</li><li>fix: 修改 bug</li><li>perf: 优化相关，比如提升性能、体验</li><li>refactor: 代码重构</li><li>revert: 回滚到上一个版本</li><li>style: 代码格式修改, 注意不是 css 修改</li><li>test: 测试用例修改</li></ul><p>为了让我们团队都使用这些提交规范我们就需要用到<code>commitlint</code>,首先我们需要安装几个工具</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm install --save-dev @commitlint/config-conventional @commitlint/cli -w</span><br></pre></td></tr></table></figure><p>其中<code> @commitlint/config-conventional</code> 是一个规范配置,标识采用什么规范来执行消息校验, 这个默认是 Angular 的提交规范,<code>@commitlint/cli</code> 是一个使用 lint 规则来校验提交记录的命令行工具</p><p>新建<code>commitlint.config.cjs</code>,这里可以自定义配置 git 提交的 message 规范</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">  extends: [&#x27;@commitlint/config-conventional&#x27;]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>然后在.husky/commit-msg 中添加<code>npx --no -- commitlint --edit &quot;$1&quot;</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">. &quot;$(dirname &quot;$0&quot;)/_/husky.sh&quot;</span><br><span class="line">npx --no -- commitlint --edit &quot;$1&quot;</span><br></pre></td></tr></table></figure><p>然后提交一个不符合规范的 type,就会发现报错了</p><p><img src="https://ucc.alicdn.com/pic/developer-ecology/ehfav3w5t3m2m_7f325c9882db4748ac3cde56d378f4f6.png" alt="image.png"></p><p>正确提交方式应为<code>&lt;type&gt;(&lt;?scope&gt;): &lt;subject&gt;</code>,例如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">feat(global): 添加commitlint规范</span><br></pre></td></tr></table></figure><h2 id="配置-lint-staged"><a href="#配置-lint-staged" class="headerlink" title="配置 lint-staged"></a>配置 lint-staged</h2><p>我们根据上面的配置是可以实现我们想要的效果的,但是我们会发现每次提交代码的时候 ESlint 或 Stylelint 都会检查所有文件,而我们需要的是只让它们检测新增的文件,因此我们可以使用<code>lint-staged</code>来解决这个问题</p><p>首先安装<code>lint-staged</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm add lint-staged -D -w</span><br></pre></td></tr></table></figure><p>然后再 package.json 中进行配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;lint-staged&quot;: &#123;</span><br><span class="line">    &quot;src/**/*.&#123;js,jsx,ts,tsx,vue&#125;&quot;: [</span><br><span class="line">      &quot;eslint --ext .js,.jsx,.vue,.ts,.tsx --fix --quiet ./&quot;,</span><br><span class="line">      &quot;stylelint --fix \&quot;packages/components/src/**/*.&#123;css,less&#125;\&quot;&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">    &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;lint-staged&quot;: &quot;lint-staged&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后修改一下``.husky/pre-commit</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env sh</span><br><span class="line">. &quot;$(dirname -- &quot;$0&quot;)/_/husky.sh&quot;</span><br><span class="line">pnpm run lint-staged</span><br></pre></td></tr></table></figure><p>``</p><p>ok,现在它只会检测我们添加到暂存区的文件了</p><p>完整代码已经提交到<a href="https://link.juejin.cn/?target=https://github.com/qddidi/easyest/commit/002f0c6757143e4e2aab7e8d6ae84aeb350a5609">easyest</a>上了,需要的小伙伴可以自取~</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>如果你对组件库开发感兴趣的话可以关注专栏<a href="https://juejin.cn/column/7118932817119019015">Vite+TypeScript从零搭建Vue3组件库</a>,里面有详细的搭建过程,记得点赞哦~~</p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230802104948912.png" alt="image-20230802104948912"></p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230802105252509.png" alt="image-20230802105252509"></p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230802110108696.png" alt="image-20230802110108696"></p><p><img src="C:\Users\selina\AppData\Roaming\Typora\typora-user-images\image-20230802110450646.png" alt="image-20230802110450646"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;git校验配置&quot;&gt;&lt;a href=&quot;#git校验配置&quot; class=&quot;headerlink&quot; title=&quot;git校验配置&quot;&gt;&lt;/a&gt;&lt;strong&gt;git校验配置&lt;/strong&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;echarts&lt;/code&gt;</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="echarts" scheme="http://example.com/tags/echarts/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>基于vue和element-ui的tree联动玩法</title>
    <link href="http://example.com/2023/05/23/%E5%9F%BA%E4%BA%8Evue%E5%92%8Celement-ui%E7%9A%84tree%E8%81%94%E5%8A%A8%E7%8E%A9%E6%B3%95/"/>
    <id>http://example.com/2023/05/23/%E5%9F%BA%E4%BA%8Evue%E5%92%8Celement-ui%E7%9A%84tree%E8%81%94%E5%8A%A8%E7%8E%A9%E6%B3%95/</id>
    <published>2023-05-23T11:25:56.000Z</published>
    <updated>2024-02-28T01:48:19.995Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基于vue和element-ui的tree联动玩法"><a href="#基于vue和element-ui的tree联动玩法" class="headerlink" title="基于vue和element-ui的tree联动玩法"></a><strong>基于vue和element-ui的tree联动玩法</strong></h1><blockquote><p>element-ui组件tree树形控件需求</p><ul><li>可选择，进行多选</li><li>树形控件图标定制化</li><li>树形控件数据搜索过滤</li><li>选择后的数据在右侧联动添加删除</li></ul></blockquote><h2 id="一、element-ui-Tree树形控件"><a href="#一、element-ui-Tree树形控件" class="headerlink" title="一、element-ui Tree树形控件"></a>一、element-ui Tree树形控件</h2><h3 id="1、基础多选用法"><a href="#1、基础多选用法" class="headerlink" title="1、基础多选用法"></a>1、基础多选用法</h3><p>element-ui里面的Tree树形控件提供了多选的api：<code>show-checkbox</code>.，点击的时候提供了对应的method：<code>check-change</code></p><p><img src="https://i.postimg.cc/xC3pMF86/image-20230523092914705.png" alt="image-20230523092914705"></p><h3 id="2、修改样式"><a href="#2、修改样式" class="headerlink" title="2、修改样式"></a>2、修改样式</h3><p>对树形控件的样式进行修改，修改需求如下</p><ul><li>第一层级不可选择</li><li>第一层级定制图标</li><li>层级下拉图标定制</li></ul><h4 id="js部分"><a href="#js部分" class="headerlink" title="js部分"></a>js部分</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let data = JSON.parse(JSON.stringify(this.treeData))//将Tree数据深拷贝</span><br><span class="line">this.treeData = []</span><br><span class="line">data.map(item =&gt; &#123;</span><br><span class="line">    item.disabled = true//给数据第一层级加上disabled属性</span><br><span class="line">    this.treeData.push(item)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="html部分"><a href="#html部分" class="headerlink" title="html部分"></a>html部分</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-tree :data=&quot;treeData&quot; show-checkbox node-key=&quot;id&quot; :props=&quot;props&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;template #default=&quot;&#123; node &#125;&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;custom-tree-node&quot;&gt;</span><br><span class="line">        &lt;!-- 第一级固定一个图标 --&gt;</span><br><span class="line">            &lt;img </span><br><span class="line">                 :src=&quot;require(&#x27;../assets/iconImg/wjj.png&#x27;)&quot;//引入图片</span><br><span class="line">                 style=&quot;margin-right: 5px;&quot; </span><br><span class="line">                 v-if=&quot;node.level === 1&quot; class=&quot;icon&quot; /&gt;//判断是不是第一层级</span><br><span class="line">            &lt;span </span><br><span class="line">                  :class=&quot;[node.childNodes.length ? &#x27;bold&#x27; : &#x27;&#x27;,</span><br><span class="line">                          node.expanded || node.checked ? &#x27;isCurrent&#x27; : &#x27;&#x27;]&quot;&gt;</span><br><span class="line">                &#123;&#123;node.label &#125;&#125;//给选择的节点添加class</span><br><span class="line">            &lt;/span&gt;</span><br><span class="line">        &lt;/span&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;/el-tree&gt;</span><br></pre></td></tr></table></figure><h4 id="css部分"><a href="#css部分" class="headerlink" title="css部分"></a>css部分</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">.isCurrent &#123;//选择的节点颜色样式</span><br><span class="line">    color: rgba(0, 130, 255, 1);</span><br><span class="line">  &#125;</span><br><span class="line">//对Tree组件内部样式修改</span><br><span class="line">  :deep().el-tree &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line"></span><br><span class="line">  //原有的箭头 去掉</span><br><span class="line">  .el-icon svg &#123;</span><br><span class="line">      display: none;</span><br><span class="line">     height: 0;</span><br><span class="line">     width: 0;</span><br><span class="line">    &#125;</span><br><span class="line">     //第一层级的checkbox选择框去掉</span><br><span class="line">   .el-checkbox .is-disabled &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line">    //引入图标的位置</span><br><span class="line">    .el-tree-node__expand-icon &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: 4px;</span><br><span class="line">      // 图标是否旋转，如果是箭头类型的，可以设置旋转90度。</span><br><span class="line">      .expanded &#123;</span><br><span class="line">        transform: rotate(90deg);</span><br><span class="line">        color: rgba(0, 130, 255, 1);</span><br><span class="line">      &#125;</span><br><span class="line">      // 未展开的节点</span><br><span class="line">      &amp;:before &#123;</span><br><span class="line">        content: url(&#x27;../assets/iconImg/right.png&#x27;);</span><br><span class="line">        font-size: 12px;</span><br><span class="line">        color: #000;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // 叶子节点（不显示图标）</span><br><span class="line">    .is-leaf.el-tree-node__expand-icon::before &#123;</span><br><span class="line">display: block;</span><br><span class="line">      background: none !important;</span><br><span class="line">      content: &quot;&quot;;</span><br><span class="line">      width: 18px;</span><br><span class="line">      height: 18px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h4 id="最终显示样式"><a href="#最终显示样式" class="headerlink" title="最终显示样式"></a>最终显示样式</h4><p><img src="https://i.postimg.cc/90xxNRGT/image-20230523093609879.png" alt="image-20230523093609879"></p><h2 id="二、树形控件数据搜索过滤"><a href="#二、树形控件数据搜索过滤" class="headerlink" title="二、树形控件数据搜索过滤"></a>二、树形控件数据搜索过滤</h2><p>在需要对节点进行过滤时，调用 Tree 实例的<code>filter</code>方法，参数为关键字。需要注意的是，此时需要设置<code>filter-node-method</code>，值为过滤函数。</p><p>html部分加一个搜索过滤条件的input</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-input style=&quot;margin-top: 1vh&quot; v-model=&quot;filterText&quot; placeholder=&quot;请输入关键词搜索目录&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">&lt;el-tree :data=&quot;treeData&quot; show-checkbox node-key=&quot;id&quot; :check-on-click-node=&quot;false&quot; ref=&quot;tree&quot; </span><br><span class="line">          :filter-node-method=&quot;filterNode&quot; //在树形组件里面添加过滤</span><br><span class="line">         :props=&quot;props&quot; </span><br><span class="line">         @check-change=&quot;handleCheckChange&quot; </span><br><span class="line">         :check-strictly=&quot;false&quot;&gt;</span><br></pre></td></tr></table></figure><p>在watch中监听<code>filterText</code>的变化，根据变化去调用<code>filter</code>方法去过滤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">    filterText(val) &#123;</span><br><span class="line">      this.$refs.tree.filter(val);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">//方法里面定义过滤方法</span><br><span class="line">method:&#123;</span><br><span class="line">    filterNode(value, data) &#123;</span><br><span class="line">      if (!value) return true;</span><br><span class="line">      return data.label.indexOf(value) !== -1;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://i.postimg.cc/0j5WfdJP/image-20230523095602409.png" alt="image-20230523095602409" style="zoom: 200%;" /><h2 id="三、选择的数据展示点击以及删除"><a href="#三、选择的数据展示点击以及删除" class="headerlink" title="三、选择的数据展示点击以及删除"></a>三、选择的数据展示点击以及删除</h2><p>代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div class=&quot;sidebarNav&quot;&gt;</span><br><span class="line">      &lt;el-row&gt;</span><br><span class="line">        &lt;el-col :span=&quot;8&quot;&gt;</span><br><span class="line">            &lt;!-- 过滤数据 --&gt;</span><br><span class="line">          &lt;el-input style=&quot;margin-top: 1vh&quot; v-model=&quot;filterText&quot; placeholder=&quot;请输入关键词搜索目录&quot;&gt;&lt;/el-input&gt;</span><br><span class="line">          &lt;div class=&quot;page_one&quot;&gt;</span><br><span class="line">            &lt;el-tree :data=&quot;treeData&quot; show-checkbox node-key=&quot;id&quot; :check-on-click-node=&quot;false&quot; ref=&quot;tree&quot; accordion</span><br><span class="line">              :filter-node-method=&quot;filterNode&quot; :props=&quot;props&quot; @check-change=&quot;handleCheckChange&quot; :check-strictly=&quot;false&quot;&gt;</span><br><span class="line">              &lt;template #default=&quot;&#123; node &#125;&quot;&gt;</span><br><span class="line">                &lt;span class=&quot;custom-tree-node&quot;&gt;</span><br><span class="line">                  &lt;!-- 第一级固定一个图标 --&gt;</span><br><span class="line">                  &lt;img :src=&quot;require(&#x27;../assets/iconImg/wjj.png&#x27;)&quot; style=&quot;margin-right: 5px;&quot; v-if=&quot;node.level === 1&quot;</span><br><span class="line">                    class=&quot;icon&quot; /&gt;</span><br><span class="line">                  &lt;span</span><br><span class="line">                    :class=&quot;[node.childNodes.length ? &#x27;bold&#x27; : &#x27;&#x27;, node.expanded || node.checked ? &#x27;isCurrent&#x27; : &#x27;&#x27;]&quot;&gt;&#123;&#123;</span><br><span class="line">                      node.label &#125;&#125;&lt;/span&gt;</span><br><span class="line">                &lt;/span&gt;</span><br><span class="line">              &lt;/template&gt;</span><br><span class="line">            &lt;/el-tree&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">        &lt;el-col :span=&quot;16&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;chooseTagWrap&quot;&gt;</span><br><span class="line">            &lt;span class=&quot;mainTag&quot;&gt;已选标签&lt;/span&gt;</span><br><span class="line">            &lt;div class=&quot;box&quot;&gt;</span><br><span class="line">              &lt;div v-for=&quot;item in currentdata&quot; @click=&quot;clickTag(item.id)&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">                &lt;!-- 超出部分气泡显示完全内容 --&gt;</span><br><span class="line">                &lt;el-tooltip class=&quot;item&quot; effect=&quot;dark&quot; :content=&quot;item.label&quot; placement=&quot;top&quot;&gt;</span><br><span class="line">                  &lt;div class=&quot;item&quot; :class=&quot;&#123; liBackground: changeLeftBackground == item.id &#125;&quot;&gt;</span><br><span class="line">                    &lt;span style=&quot;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;&quot;&gt;&#123;&#123; item.label &#125;&#125;&lt;/span&gt;</span><br><span class="line">                    &lt;span v-if=&quot;changeLeftBackground == item.id&quot; style=&quot;margin-left:5px&quot; @click=&quot;delTag(item.id)&quot;&gt;x&lt;/span&gt;</span><br><span class="line">                  &lt;/div&gt;</span><br><span class="line">                &lt;/el-tooltip&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">              &lt;div class=&quot;btn&quot; @click=&quot;partcahnge&quot; v-if=&quot;btnShow&quot;&gt;</span><br><span class="line">                &lt;span v-if=&quot;part&quot;&gt;展开&lt;/span&gt;</span><br><span class="line">                &lt;span v-else&gt;收起&lt;/span&gt;</span><br><span class="line">              &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/el-col&gt;</span><br><span class="line">      &lt;/el-row&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  props: &#123;</span><br><span class="line">  &#125;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      props: &#123;</span><br><span class="line">        label: &#x27;label&#x27;,</span><br><span class="line">        children: &#x27;children&#x27;,</span><br><span class="line">      &#125;,</span><br><span class="line">      chooseTag: [],//选择的tag数组</span><br><span class="line">      currentdata: [],//显示的tag数组</span><br><span class="line">      filterText: &#x27;&#x27;,//过滤数据</span><br><span class="line">      delTagId: &#x27;&#x27;,//删除的数据</span><br><span class="line">      treeData: [&#123;//tree的数组数据，可接接口</span><br><span class="line">        id: 1,</span><br><span class="line">        label: &#x27;一级 1&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          id: 4,</span><br><span class="line">          label: &#x27;二级 1-1&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            id: 9,</span><br><span class="line">            label: &#x27;三级 1-1-1&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            id: 10,</span><br><span class="line">            label: &#x27;三级 1-1-2&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        id: 2,</span><br><span class="line">        label: &#x27;一级 2&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          id: 5,</span><br><span class="line">          label: &#x27;二级 2-1&#x27;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          id: 6,</span><br><span class="line">          label: &#x27;二级 2-2&#x27;</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;, &#123;</span><br><span class="line">        id: 3,</span><br><span class="line">        label: &#x27;一级 3&#x27;,</span><br><span class="line">        children: [&#123;</span><br><span class="line">          id: 7,</span><br><span class="line">          label: &#x27;二级 3-1&#x27;</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">          id: 8,</span><br><span class="line">          label: &#x27;二级 3-2&#x27;,</span><br><span class="line">          children: [&#123;</span><br><span class="line">            id: 11,</span><br><span class="line">            label: &#x27;三级 3-2-1&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            id: 12,</span><br><span class="line">            label: &#x27;三级 3-2-2&#x27;</span><br><span class="line">          &#125;, &#123;</span><br><span class="line">            id: 13,</span><br><span class="line">            label: &#x27;三级 3-2-3&#x27;</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;],</span><br><span class="line">      btnShow: false,//展开收起显示</span><br><span class="line">      maxNum: 0,//一行最大的容量</span><br><span class="line">      changeLeftBackground: &#x27;&#x27;//右侧数据点击</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted() &#123;</span><br><span class="line">      //深拷贝数据，第一层数据disabled属性添加</span><br><span class="line">    let data = JSON.parse(JSON.stringify(this.treeData))</span><br><span class="line">    this.treeData = []</span><br><span class="line">    data.map(item =&gt; &#123;</span><br><span class="line">      item.disabled = true</span><br><span class="line">      this.treeData.push(item)</span><br><span class="line">    &#125;)</span><br><span class="line">      //获取宽度设置maxNum</span><br><span class="line">    const wrap = document.getElementsByClassName(&#x27;chooseTagWrap&#x27;)[0]</span><br><span class="line">    console.log(wrap.clientWidth);</span><br><span class="line">    this.maxNum = (Math.floor((wrap.clientWidth - 20) / 152)) * 2</span><br><span class="line">    this.tagChange()</span><br><span class="line">  &#125;,</span><br><span class="line">  watch: &#123;</span><br><span class="line">      //过滤数据监听</span><br><span class="line">    filterText(val) &#123;</span><br><span class="line">      this.$refs.tree.filter(val);</span><br><span class="line">    &#125;,</span><br><span class="line">      //选择数据监听</span><br><span class="line">    chooseTag(val) &#123;</span><br><span class="line">      this.tagChange()</span><br><span class="line">      console.log(val);</span><br><span class="line">      // this.$refs.tree.filter(val);</span><br><span class="line">    &#125;,</span><br><span class="line">      //删除数据监听</span><br><span class="line">    delTagId(val) &#123;</span><br><span class="line">      if (val) &#123;</span><br><span class="line">        console.log(val, &#x27;delTagId&#x27;);</span><br><span class="line">        this.$refs.tree.setChecked(val, false, true);</span><br><span class="line">        this.handleCheckChange()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handleCheckChange() &#123;</span><br><span class="line">      // 获取已选择树形节点</span><br><span class="line">      // getCheckedNodes 接收两个 boolean 类型的参数，1. 是否只是叶子节点，默认值为 false 2. 是否包含半选节点，默认值为 false</span><br><span class="line">      let list = this.$refs.tree.getCheckedNodes(true, false);</span><br><span class="line">      if (list.length &gt; 0) &#123;</span><br><span class="line">        this.chooseTag = JSON.parse(JSON.stringify(list))</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.chooseTag = []</span><br><span class="line">      &#125;</span><br><span class="line">      this.delTagId = null</span><br><span class="line">      console.log(this.chooseTag);</span><br><span class="line">    &#125;,</span><br><span class="line">    filterNode(value, data) &#123;</span><br><span class="line">      if (!value) return true;</span><br><span class="line">      return data.label.indexOf(value) !== -1;</span><br><span class="line">    &#125;,</span><br><span class="line">    //tag展开收起</span><br><span class="line">    partcahnge() &#123;</span><br><span class="line">      if (this.part) &#123;</span><br><span class="line">        this.part = false</span><br><span class="line">        this.currentdata = this.chooseTag</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.part = true</span><br><span class="line">        this.currentdata = this.chooseTag.slice(0, this.maxNum)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    tagChange() &#123;</span><br><span class="line">      if (this.chooseTag.length &gt; this.maxNum) &#123;</span><br><span class="line">        this.btnShow = true</span><br><span class="line">        this.part = true</span><br><span class="line">        this.currentdata = this.chooseTag.slice(0, this.maxNum)</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        this.currentdata = this.chooseTag</span><br><span class="line">        this.btnShow = false</span><br><span class="line">        this.part = true</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    //点击标签</span><br><span class="line">    clickTag(e) &#123;</span><br><span class="line">      console.log(e);</span><br><span class="line">      this.changeLeftBackground = e</span><br><span class="line">    &#125;,</span><br><span class="line">    //删除标签</span><br><span class="line">    delTag(e) &#123;</span><br><span class="line">      console.log(e);</span><br><span class="line">      this.delTagId = e</span><br><span class="line">      this.chooseTag = this.chooseTag.filter(item =&gt; item.id != e)</span><br><span class="line">      console.log(this.chooseTag);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- Add &quot;scoped&quot; attribute to limit CSS to this component only --&gt;</span><br><span class="line">&lt;style scoped lang=&quot;scss&quot;&gt;</span><br><span class="line">.mainTag &#123;</span><br><span class="line">  font-size: 16px;</span><br><span class="line">  font-weight: 700;</span><br><span class="line">  line-height: 18.75px;</span><br><span class="line">  color: rgba(0, 0, 0, 1);</span><br><span class="line">  display: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.sidebarNav &#123;</span><br><span class="line">  padding: 1.5vh 10px;</span><br><span class="line">  height: 97vh;</span><br><span class="line">  background: #fff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.page_one &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  flex-direction: column;</span><br><span class="line">  margin-top: 16px;</span><br><span class="line">  height: calc(100vh - 140px);</span><br><span class="line">  overflow-y: scroll;</span><br><span class="line"></span><br><span class="line">  .isCurrent &#123;</span><br><span class="line">    color: rgba(0, 130, 255, 1);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  :deep().el-tree &#123;</span><br><span class="line">    flex: 1;</span><br><span class="line"></span><br><span class="line">    //原有的箭头 去掉</span><br><span class="line">    .el-icon svg &#123;</span><br><span class="line">      display: none;</span><br><span class="line">      height: 0;</span><br><span class="line">      width: 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    .el-checkbox .is-disabled &#123;</span><br><span class="line">      display: none !important;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //引入图标的位置</span><br><span class="line">    .el-tree-node__expand-icon &#123;</span><br><span class="line">      position: absolute;</span><br><span class="line">      right: 4px;</span><br><span class="line"></span><br><span class="line">      // 图标是否旋转，如果是箭头类型的，可以设置旋转90度。</span><br><span class="line">      .expanded &#123;</span><br><span class="line">        transform: rotate(90deg);</span><br><span class="line">        color: rgba(0, 130, 255, 1);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      // 未展开的节点</span><br><span class="line">      &amp;:before &#123;</span><br><span class="line">        content: url(&#x27;../assets/iconImg/right.png&#x27;);</span><br><span class="line">        font-size: 12px;</span><br><span class="line">        color: #000;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 叶子节点（不显示图标）</span><br><span class="line">    .is-leaf.el-tree-node__expand-icon::before &#123;</span><br><span class="line">      display: block;</span><br><span class="line">      background: none !important;</span><br><span class="line">      content: &quot;&quot;;</span><br><span class="line">      width: 18px;</span><br><span class="line">      height: 18px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.chooseTagWrap &#123;</span><br><span class="line">  background: #fff;</span><br><span class="line">  padding: 5px 10px;</span><br><span class="line">  min-height: 15.4vh</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box &#123;</span><br><span class="line">  display: flex;</span><br><span class="line">  width: 100%;</span><br><span class="line">  flex-wrap: wrap;</span><br><span class="line"></span><br><span class="line">  .item &#123;</span><br><span class="line">    margin: 5px 10px;</span><br><span class="line">    padding: 5px 10px;</span><br><span class="line">    border: 1px solid rgb(229, 229, 229);</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">    border-radius: 4px;</span><br><span class="line">    width: 110px;</span><br><span class="line"></span><br><span class="line">    display: flex;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .liBackground &#123;</span><br><span class="line">    color: rgba(0, 130, 255, 1);</span><br><span class="line">    border: 1px solid rgba(0, 130, 255, 1);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .btn &#123;</span><br><span class="line">    height: 20px;</span><br><span class="line">    width: 40px;</span><br><span class="line">    text-align: center;</span><br><span class="line">    margin: 10px;</span><br><span class="line">    border-radius: 5px;</span><br><span class="line">    line-height: 20px;</span><br><span class="line">    color: aqua;</span><br><span class="line">    cursor: pointer;</span><br><span class="line"></span><br><span class="line">    span &#123;</span><br><span class="line">      font-size: 12px;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.postimg.cc/bYLFvMKJ/image-20230523101206792.png" alt="image-20230523101206792"></p><p>了解更多<a href="https://element.eleme.cn/#/zh-CN/component/tree">elemrnt-ui树形控件官网</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基于vue和element-ui的tree联动玩法&quot;&gt;&lt;a href=&quot;#基于vue和element-ui的tree联动玩法&quot; class=&quot;headerlink&quot; title=&quot;基于vue和element-ui的tree联动玩法&quot;&gt;&lt;/a&gt;&lt;strong&gt;基于v</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
    <category term="element-ui" scheme="http://example.com/tags/element-ui/"/>
    
  </entry>
  
  <entry>
    <title>js数组扁平化</title>
    <link href="http://example.com/2022/08/04/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-js-%E6%95%B0%E7%BB%84%E6%89%81%E5%B9%B3%E5%8C%96/"/>
    <id>http://example.com/2022/08/04/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-js-%E6%95%B0%E7%BB%84%E6%89%81%E5%B9%B3%E5%8C%96/</id>
    <published>2022-08-04T12:34:23.000Z</published>
    <updated>2024-02-28T01:48:07.043Z</updated>
    
    <content type="html"><![CDATA[<h1 id="数组扁平化"><a href="#数组扁平化" class="headerlink" title="数组扁平化"></a><strong>数组扁平化</strong></h1><blockquote><p><code>Vue3</code>的新特性，如下：</p><ul><li>速度更快</li><li>体积减少</li><li>更易维护</li><li>更接近原生</li><li>更易使用</li></ul></blockquote><h2 id="1、双向数据绑定原理"><a href="#1、双向数据绑定原理" class="headerlink" title="1、双向数据绑定原理"></a>1、双向数据绑定原理</h2><p>vue2 是结合发布者订阅者模式，结合es6Object.defineProperty()对数据进行劫持，进一步通过vue中的watcher的update实现双向数据绑定。<br>vue3 中使用了es6的proxy进行数据代理。</p><p>相对于vue2，使用proxy的优势：</p><p>defineProperty只能监听某个属性，不能对全对象监听；<br>可以监听到数组内部的变化；<br>vue2中我们给对象添加一个新属性，它不会更新到视图上，只是因为新添加的属性并没有通过Object.defineProperty()进行响应式设置，但是vue3中的proxy对于动态添加的属性也是具有响应式的.</p><h2 id="2、vue3支持碎片"><a href="#2、vue3支持碎片" class="headerlink" title="2、vue3支持碎片"></a>2、vue3支持碎片</h2><p>也就是说，vue3在组件中支持多个根节点.</p><p>vue2</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="3、Composition-API-组合api"><a href="#3、Composition-API-组合api" class="headerlink" title="3、Composition API (组合api)"></a>3、Composition API (组合api)</h2><p>vue2和vue3最大的区别就是，vue3使用了Composition API (组合api)</p><p>在vue2中是使用的Options API，这种写法不方便我们的阅读和交流，逻辑过于分散。</p><p>vue2</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;<span class="comment">// 数据</span></span><br><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;&#125;,</span><br><span class="line"><span class="comment">// 方法</span></span><br><span class="line"><span class="attr">methods</span>: &#123;&#125;,</span><br><span class="line"><span class="attr">computed</span>: &#123;&#125;,</span><br><span class="line"><span class="attr">components</span>:&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><p>这样代码会更加简洁和整洁。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 数据 和 方法都在setup里面使用</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="4、生命周期钩子"><a href="#4、生命周期钩子" class="headerlink" title="4、生命周期钩子"></a>4、生命周期钩子</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Vue2--------------vue3</span><br><span class="line">beforeCreate  -&gt; setup()比beforeCreate和created执行的还要早</span><br><span class="line">created       -&gt; setup()</span><br><span class="line">beforeMount   -&gt; onBeforeMount组件挂载到节点之前执行的函数</span><br><span class="line">mounted       -&gt; onMounted组件挂载完成后执行的函数</span><br><span class="line">beforeUpdate  -&gt; onBeforeUpdate组件更新之前执行的函数</span><br><span class="line">updated       -&gt; onUpdated组件更新完成之后执行的函数</span><br><span class="line">beforeDestroy -&gt; onBeforeUnmount组件卸载之前执行的函数</span><br><span class="line">destroyed     -&gt; onUnmounted组件卸载完成后执行的函数</span><br><span class="line"></span><br><span class="line">若组件被keep-alive包含，则会多出两个钩子函数：</span><br><span class="line">activated     -&gt; onActivated组件激活时触发</span><br><span class="line">deactivated   -&gt; onDeactivated组件失活时触发</span><br></pre></td></tr></table></figure><h2 id="5、父子传参不同，setup-函数"><a href="#5、父子传参不同，setup-函数" class="headerlink" title="5、父子传参不同，setup()函数"></a>5、父子传参不同，setup()函数</h2><p>因为在setup里面是获取不到this，所以在vue3中我们通过setup(props,context)两个参数进行父子之间的传参。</p><p>vue2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&#x27;father&#x27;&gt;</span><br><span class="line">    &lt;my :msg=&quot;msg&quot; @get=&quot;get&quot;&gt;&lt;/my&gt;</span><br><span class="line">    &#123;&#123;sonMsg&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import my from &#x27;@/components/my&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        msg:&#x27;父组件的数据&#x27;,</span><br><span class="line">        sonMsg:&#x27;&#x27;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">    get(val) &#123;</span><br><span class="line">        this.sonMsg = val</span><br><span class="line">        console.log(val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">components:&#123;</span><br><span class="line">    my</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">#子组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&#x27;son&#x27;&gt;</span><br><span class="line">      &#123;&#123;msg&#125;&#125;</span><br><span class="line">      &lt;button @click=&quot;handler&quot;&gt;点击获取数据&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"> &lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">props:[&quot;msg&quot;],</span><br><span class="line">methods:&#123;</span><br><span class="line">    handler() &#123;</span><br><span class="line">        this.$emit(&#x27;get&#x27;,&#x27;子组件的数据&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># 父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&#x27;father&#x27;&gt;</span><br><span class="line">    &lt;my :msg=&quot;msg&quot; @get=&quot;get&quot;&gt;&lt;/my&gt;</span><br><span class="line">    &#123;&#123;sonMsg&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import my from &#x27;@/components/my&#x27;</span><br><span class="line">import &#123; reactive,toRefs &#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">setup() &#123;</span><br><span class="line">    const obj = reactive(&#123;</span><br><span class="line">        msg:&#x27;父组件的数据&#x27;,</span><br><span class="line">        sonMsg:&#x27;&#x27;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    const get = (val) =&gt;&#123;</span><br><span class="line">        console.log(val);</span><br><span class="line">        obj.sonMsg = val</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        ...toRefs(obj),</span><br><span class="line">        get</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">components:&#123;</span><br><span class="line">    my</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"># 子组件</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&#x27;son&#x27;&gt;</span><br><span class="line">    &#123;&#123;msg&#125;&#125;</span><br><span class="line">    &lt;button @click=&quot;handler&quot;&gt;点击获取数据&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">props:[&quot;msg&quot;],</span><br><span class="line">setup(props,&#123;attrs,slots,emit&#125;) &#123;</span><br><span class="line">    const handler = ()=&gt;&#123;</span><br><span class="line">        emit(&#x27;get&#x27;,&#x27;子组件的数据&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        handler</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="6、移除了filter过滤器"><a href="#6、移除了filter过滤器" class="headerlink" title="6、移除了filter过滤器"></a>6、移除了filter过滤器</h2><p>在vue3中，移除了filter，我们可以使用计算属性进行代替</p><h2 id="7、vue2和vue3的diff算法"><a href="#7、vue2和vue3的diff算法" class="headerlink" title="7、vue2和vue3的diff算法"></a>7、vue2和vue3的diff算法</h2><p>vue2</p><p>vue2 diff算法就是进行虚拟节点对比，并返回一个patch对象，用来存储两个节点不同的地方，最后用patch记录的消息去局部更新Dom。<br>vue2 diff算法会比较每一个vnode,而对于一些不参与更新的元素，进行比较是有点消耗性能的。</p><p>vue3</p><p>vue3 diff算法在初始化的时候会给每个虚拟节点添加一个patchFlags，patchFlags就是优化的标识。<br>只会比较patchFlags发生变化的vnode,进行更新视图，对于没有变化的元素做静态标记，在渲染的时候直接复用。</p><h2 id="8、v-if-和-v-for的优先级"><a href="#8、v-if-和-v-for的优先级" class="headerlink" title="8、v-if 和 v-for的优先级"></a>8、v-if 和 v-for的优先级</h2><p>vue2<br>我们最好不要把v-if和v-for同时用在一个元素上，这样会带来性能的浪费(每次都要先渲染才会进行条件判断)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v-for 优先于 v-if 生效</span><br><span class="line">&lt;div v-if=&quot;index == 1&quot; v-for=&quot;(item,index) in arr&quot; :key=&quot;index&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v-if 优先于 v-for 生效</span><br><span class="line">&lt;div v-if=&quot;index == 1&quot; v-for=&quot;(item,index) in arr&quot; :key=&quot;index&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>vue中会给我们报警告：属性“index”在渲染期间被访问，但未在实例上定义(v-if先进行判断，但是这时候v-for还没有渲染，所以index是找不到的)</p><p>了解更多<a href="https://cn.vuejs.org/#%E6%A6%82%E8%A7%88">vue3的官网</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;数组扁平化&quot;&gt;&lt;a href=&quot;#数组扁平化&quot; class=&quot;headerlink&quot; title=&quot;数组扁平化&quot;&gt;&lt;/a&gt;&lt;strong&gt;数组扁平化&lt;/strong&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;Vue3&lt;/code&gt;的新特性，如下：&lt;/p</summary>
      
    
    
    
    <category term="js" scheme="http://example.com/categories/js/"/>
    
    
    <category term="前端技术基础" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/"/>
    
    <category term="js" scheme="http://example.com/tags/js/"/>
    
    <category term="数组方法" scheme="http://example.com/tags/%E6%95%B0%E7%BB%84%E6%96%B9%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>vue2与vue3的区别</title>
    <link href="http://example.com/2022/06/12/vue2%E4%B8%8Evue3%E5%8C%BA%E5%88%AB/"/>
    <id>http://example.com/2022/06/12/vue2%E4%B8%8Evue3%E5%8C%BA%E5%88%AB/</id>
    <published>2022-06-12T13:25:56.000Z</published>
    <updated>2024-02-28T01:47:53.777Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vue2与vue3区别"><a href="#vue2与vue3区别" class="headerlink" title="vue2与vue3区别"></a><strong>vue2与vue3区别</strong></h1><blockquote><p><code>Vue3</code>的新特性，如下：</p><ul><li>速度更快</li><li>体积减少</li><li>更易维护</li><li>更接近原生</li><li>更易使用</li></ul></blockquote><h2 id="1、双向数据绑定原理"><a href="#1、双向数据绑定原理" class="headerlink" title="1、双向数据绑定原理"></a>1、双向数据绑定原理</h2><p>vue2 是结合发布者订阅者模式，结合es6Object.defineProperty()对数据进行劫持，进一步通过vue中的watcher的update实现双向数据绑定。<br>vue3 中使用了es6的proxy进行数据代理。</p><p>相对于vue2，使用proxy的优势：</p><p>defineProperty只能监听某个属性，不能对全对象监听；<br>可以监听到数组内部的变化；<br>vue2中我们给对象添加一个新属性，它不会更新到视图上，只是因为新添加的属性并没有通过Object.defineProperty()进行响应式设置，但是vue3中的proxy对于动态添加的属性也是具有响应式的.</p><h2 id="2、vue3支持碎片"><a href="#2、vue3支持碎片" class="headerlink" title="2、vue3支持碎片"></a>2、vue3支持碎片</h2><p>也就是说，vue3在组件中支持多个根节点.</p><p>vue2</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h2 id="3、Composition-API-组合api"><a href="#3、Composition-API-组合api" class="headerlink" title="3、Composition API (组合api)"></a>3、Composition API (组合api)</h2><p>vue2和vue3最大的区别就是，vue3使用了Composition API (组合api)</p><p>在vue2中是使用的Options API，这种写法不方便我们的阅读和交流，逻辑过于分散。</p><p>vue2</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;<span class="comment">// 数据</span></span><br><span class="line"><span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;&#125;,</span><br><span class="line"><span class="comment">// 方法</span></span><br><span class="line"><span class="attr">methods</span>: &#123;&#125;,</span><br><span class="line"><span class="attr">computed</span>: &#123;&#125;,</span><br><span class="line"><span class="attr">components</span>:&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><p>这样代码会更加简洁和整洁。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"><span class="function"><span class="title">setup</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="comment">// 数据 和 方法都在setup里面使用</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="4、生命周期钩子"><a href="#4、生命周期钩子" class="headerlink" title="4、生命周期钩子"></a>4、生命周期钩子</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Vue2--------------vue3</span><br><span class="line">beforeCreate  -&gt; setup()比beforeCreate和created执行的还要早</span><br><span class="line">created       -&gt; setup()</span><br><span class="line">beforeMount   -&gt; onBeforeMount组件挂载到节点之前执行的函数</span><br><span class="line">mounted       -&gt; onMounted组件挂载完成后执行的函数</span><br><span class="line">beforeUpdate  -&gt; onBeforeUpdate组件更新之前执行的函数</span><br><span class="line">updated       -&gt; onUpdated组件更新完成之后执行的函数</span><br><span class="line">beforeDestroy -&gt; onBeforeUnmount组件卸载之前执行的函数</span><br><span class="line">destroyed     -&gt; onUnmounted组件卸载完成后执行的函数</span><br><span class="line"></span><br><span class="line">若组件被keep-alive包含，则会多出两个钩子函数：</span><br><span class="line">activated     -&gt; onActivated组件激活时触发</span><br><span class="line">deactivated   -&gt; onDeactivated组件失活时触发</span><br></pre></td></tr></table></figure><h2 id="5、父子传参不同，setup-函数"><a href="#5、父子传参不同，setup-函数" class="headerlink" title="5、父子传参不同，setup()函数"></a>5、父子传参不同，setup()函数</h2><p>因为在setup里面是获取不到this，所以在vue3中我们通过setup(props,context)两个参数进行父子之间的传参。</p><p>vue2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&#x27;father&#x27;&gt;</span><br><span class="line">    &lt;my :msg=&quot;msg&quot; @get=&quot;get&quot;&gt;&lt;/my&gt;</span><br><span class="line">    &#123;&#123;sonMsg&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import my from &#x27;@/components/my&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        msg:&#x27;父组件的数据&#x27;,</span><br><span class="line">        sonMsg:&#x27;&#x27;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">    get(val) &#123;</span><br><span class="line">        this.sonMsg = val</span><br><span class="line">        console.log(val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">components:&#123;</span><br><span class="line">    my</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">#子组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&#x27;son&#x27;&gt;</span><br><span class="line">      &#123;&#123;msg&#125;&#125;</span><br><span class="line">      &lt;button @click=&quot;handler&quot;&gt;点击获取数据&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line"> &lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">props:[&quot;msg&quot;],</span><br><span class="line">methods:&#123;</span><br><span class="line">    handler() &#123;</span><br><span class="line">        this.$emit(&#x27;get&#x27;,&#x27;子组件的数据&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"># 父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&#x27;father&#x27;&gt;</span><br><span class="line">    &lt;my :msg=&quot;msg&quot; @get=&quot;get&quot;&gt;&lt;/my&gt;</span><br><span class="line">    &#123;&#123;sonMsg&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import my from &#x27;@/components/my&#x27;</span><br><span class="line">import &#123; reactive,toRefs &#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">setup() &#123;</span><br><span class="line">    const obj = reactive(&#123;</span><br><span class="line">        msg:&#x27;父组件的数据&#x27;,</span><br><span class="line">        sonMsg:&#x27;&#x27;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    const get = (val) =&gt;&#123;</span><br><span class="line">        console.log(val);</span><br><span class="line">        obj.sonMsg = val</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        ...toRefs(obj),</span><br><span class="line">        get</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line">components:&#123;</span><br><span class="line">    my</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"># 子组件</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&#x27;son&#x27;&gt;</span><br><span class="line">    &#123;&#123;msg&#125;&#125;</span><br><span class="line">    &lt;button @click=&quot;handler&quot;&gt;点击获取数据&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">props:[&quot;msg&quot;],</span><br><span class="line">setup(props,&#123;attrs,slots,emit&#125;) &#123;</span><br><span class="line">    const handler = ()=&gt;&#123;</span><br><span class="line">        emit(&#x27;get&#x27;,&#x27;子组件的数据&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return &#123;</span><br><span class="line">        handler</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="6、移除了filter过滤器"><a href="#6、移除了filter过滤器" class="headerlink" title="6、移除了filter过滤器"></a>6、移除了filter过滤器</h2><p>在vue3中，移除了filter，我们可以使用计算属性进行代替</p><h2 id="7、vue2和vue3的diff算法"><a href="#7、vue2和vue3的diff算法" class="headerlink" title="7、vue2和vue3的diff算法"></a>7、vue2和vue3的diff算法</h2><p>vue2</p><p>vue2 diff算法就是进行虚拟节点对比，并返回一个patch对象，用来存储两个节点不同的地方，最后用patch记录的消息去局部更新Dom。<br>vue2 diff算法会比较每一个vnode,而对于一些不参与更新的元素，进行比较是有点消耗性能的。</p><p>vue3</p><p>vue3 diff算法在初始化的时候会给每个虚拟节点添加一个patchFlags，patchFlags就是优化的标识。<br>只会比较patchFlags发生变化的vnode,进行更新视图，对于没有变化的元素做静态标记，在渲染的时候直接复用。</p><h2 id="8、v-if-和-v-for的优先级"><a href="#8、v-if-和-v-for的优先级" class="headerlink" title="8、v-if 和 v-for的优先级"></a>8、v-if 和 v-for的优先级</h2><p>vue2<br>我们最好不要把v-if和v-for同时用在一个元素上，这样会带来性能的浪费(每次都要先渲染才会进行条件判断)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v-for 优先于 v-if 生效</span><br><span class="line">&lt;div v-if=&quot;index == 1&quot; v-for=&quot;(item,index) in arr&quot; :key=&quot;index&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>vue3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v-if 优先于 v-for 生效</span><br><span class="line">&lt;div v-if=&quot;index == 1&quot; v-for=&quot;(item,index) in arr&quot; :key=&quot;index&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>vue中会给我们报警告：属性“index”在渲染期间被访问，但未在实例上定义(v-if先进行判断，但是这时候v-for还没有渲染，所以index是找不到的)</p><p>了解更多<a href="https://cn.vuejs.org/#%E6%A6%82%E8%A7%88">vue3的官网</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;vue2与vue3区别&quot;&gt;&lt;a href=&quot;#vue2与vue3区别&quot; class=&quot;headerlink&quot; title=&quot;vue2与vue3区别&quot;&gt;&lt;/a&gt;&lt;strong&gt;vue2与vue3区别&lt;/strong&gt;&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;cod</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
    <category term="vue3" scheme="http://example.com/tags/vue3/"/>
    
  </entry>
  
  <entry>
    <title>vue项目数据刷新视图不更新排查</title>
    <link href="http://example.com/2022/03/02/vue3%E9%A1%B9%E7%9B%AE%E6%95%B0%E6%8D%AE%E5%88%B7%E6%96%B0%E8%A7%86%E5%9B%BE%E4%B8%8D%E6%9B%B4%E6%96%B0%E6%8E%92%E6%9F%A5/"/>
    <id>http://example.com/2022/03/02/vue3%E9%A1%B9%E7%9B%AE%E6%95%B0%E6%8D%AE%E5%88%B7%E6%96%B0%E8%A7%86%E5%9B%BE%E4%B8%8D%E6%9B%B4%E6%96%B0%E6%8E%92%E6%9F%A5/</id>
    <published>2022-03-02T12:32:09.000Z</published>
    <updated>2024-02-28T01:47:01.714Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vue项目数据刷新视图不更新排查"><a href="#vue项目数据刷新视图不更新排查" class="headerlink" title="vue项目数据刷新视图不更新排查"></a><strong>vue项目数据刷新视图不更新排查</strong></h1><blockquote><p>在做一个vue3项目时，对于一个循环渲染的模块进行增删，新增数据显示没有问题，删除总是有问题，虽然最终排查是因为key设置为index的原因，但是还是想总结一下vue数据更新的知识点。</p><p>关于循环渲染key值的绑定在文末也会总结</p></blockquote><h2 id="一、vue2中项目更新"><a href="#一、vue2中项目更新" class="headerlink" title="一、vue2中项目更新"></a><strong>一、vue2中项目更新</strong></h2><h3 id="1、数组数据变动"><a href="#1、数组数据变动" class="headerlink" title="1、数组数据变动"></a><strong>1、数组数据变动</strong></h3><p>在我们使用一些方法操作数组变动数据的时候，有一些方法时无法被vue监测的，有这些方法是可以是数组发生变化并且被vue监测</p><table><thead><tr><th>push()</th><th>pop()</th><th>shift()</th><th>reverse()</th></tr></thead><tbody><tr><td>unshift()</td><td>splice()</td><td>sort()</td><td></td></tr></tbody></table><p>这些方法可以直接改变原数组并且被vue监听</p><p><strong>vue也不能检测利用索引直接设置，以及直接修改数组的长度</strong></p><h3 id="2、对象属性的添加删除"><a href="#2、对象属性的添加删除" class="headerlink" title="2、对象属性的添加删除"></a><strong>2、对象属性的添加删除</strong></h3><p>Vue 不能检测到对象属性的添加或删除</p><p>由于 Vue 会在初始化实例时对属性执行 getter/setter 转化过程，所以属性必须在 data 对象上存在才能让 Vue 转换它，这样才能让它是响应的</p><p><strong>解决办法：</strong></p><p>使用 Vue.set(object, key, value) 方法将响应属性添加到嵌套的对象上</p><p>Vue.set(vm.someObject, ‘b’, 2) 或者 this.$set(this.someObject,’b’,2) （这也是全局 Vue.set 方法的别名）</p><p>其中数组里面不能直接用索引对数组赋值改变值也可以利用set</p><p> this.$set(this.arr,1,2) </p><p>​         <img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220402140026.png" alt="img">                </p><p><a href="https://cn.vuejs.org/v2/api/#Vue-set">set官网</a></p><h3 id="3、vue2数据绑定"><a href="#3、vue2数据绑定" class="headerlink" title="3、vue2数据绑定"></a>3、vue2数据绑定</h3><p><strong>什么是数据双向绑定</strong>？ </p><p>　　vue是一个mvvm框架，即数据双向绑定，即当数据发生变化的时候，视图也就发生变化，当视图发生变化的时候，数据也会跟着同步变化。这也算是vue的精髓之处了。<strong>值得注意的是，</strong>我们所说的数据双向绑定，一定是对于UI控件来说的，非UI控件不会涉及到数据双向绑定。</p><p><strong>为什么要实现数据的双向绑定</strong>？</p><p>　　 在vue中，如果使用vuex，实际上数据还是单向的，之所以说是数据双向绑定，这是用的UI控件来说，对于我们处理表单，vue的双向数据绑定用起来就特别舒服了。 <strong>即两者并不互斥， 在全局性数据流使用单项，方便跟踪； 局部性数据流使用双向，简单易操作。</strong></p><h4 id="vue响应式原理"><a href="#vue响应式原理" class="headerlink" title="vue响应式原理"></a>vue响应式原理</h4><p><strong>vue是采用数据劫持结合发布者-订阅者模式的方式，通过Object.defineProperty()来劫持各个属性的getter，setter，当属性发生改变的时候，将变动发布给订阅者，触发监听回调</strong></p><h2 id="二、vue3中数据更新"><a href="#二、vue3中数据更新" class="headerlink" title="二、vue3中数据更新"></a><strong>二、vue3中数据更新</strong></h2><h3 id="ref函数："><a href="#ref函数：" class="headerlink" title="ref函数："></a>ref函数：</h3><p>语法：const xxx = ref (initValue)<br> 接受的数据类型：基本类型，引用类型<br> 作用：把参数加工成一个响应式对象，全称为reference对象(我们下面一律简称为ref对象)<br> 核心原理：如果使用的是基本类型响应式依赖Object.defineProperty( )的get( )和set( )，如果ref使用的是引用类型，底层ref会借助reactive的proxy 定义响应式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h3&gt;&#123;&#123; refBaseType &#125;&#125;&lt;/h3&gt;//i am ref</span><br><span class="line">  &lt;h3&gt;&#123;&#123; refReferenceType &#125;&#125;&lt;/h3&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; ref &#125; from &#x27;vue&#x27;</span><br><span class="line">let refBaseType = ref(null)</span><br><span class="line">//ref 需要用.value去获取值</span><br><span class="line">refBaseType.value = &#x27;i am ref&#x27;</span><br><span class="line">let refReferenceType = ref(&#123;&#125;)</span><br><span class="line">//如果ref使用的是对象，ref会借助reactive生成proxy</span><br><span class="line">refReferenceType.value = &#123; count: 1 &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="reactive函数："><a href="#reactive函数：" class="headerlink" title="reactive函数："></a>reactive函数：</h3><p>语法：const xxx = reactive(源对象)<br> 接受的数据类型：引用类型<br> 作用：把参数加工成一个代理对象，全称为proxy对象<br> 核心原理：基于Es6的Proxy实现，通过Reflect反射代理操作源对象，相比于reactive定义的浅层次响应式数据对象，reactive定义的是更深层次的响应式数据对象</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h3&gt;&#123;&#123; reactiveBaseType &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;h3&gt;&#123;&#123; reactiveReferenceType &#125;&#125;&lt;/h3&gt;</span><br><span class="line">  &lt;div @click=&quot;setData&quot;&gt;setData&lt;/div&gt;</span><br><span class="line">  &lt;div @click=&quot;setReactive&quot;&gt;setReactive&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import &#123; reactive &#125; from &#x27;vue&#x27;</span><br><span class="line">let reactiveBaseType = reactive(null)</span><br><span class="line">//reactive 无法定义基本类型的proxy,且设置值无法响应数据</span><br><span class="line">let setData = () =&gt; &#123;</span><br><span class="line">  reactiveBaseType = &#x27;fai&#x27;</span><br><span class="line">&#125;</span><br><span class="line">console.log(&#x27;reactiveBaseType&#x27;, reactiveBaseType) //null</span><br><span class="line">//如果reactive使用的是引用类型</span><br><span class="line">let reactiveReferenceType = reactive(&#123; count: 1 &#125;)</span><br><span class="line">let setReactive = () =&gt; &#123;</span><br><span class="line">  //这样设置会去proxy</span><br><span class="line">  reactiveReferenceType = &#123; count: 1 &#125;</span><br><span class="line">  console.log(reactiveReferenceType)</span><br><span class="line">  /*</span><br><span class="line">   *&#123;count: 1&#125; //proxy 没了，所以reactive申明的无法直接替换整个对象，如果有这个需求请使用ref</span><br><span class="line">   * */</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;scss&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><strong>总结：</strong></p><p>ref和reactive都可以做响应式</p><p>ref:一般用在定义基本类型和引用类型，如果是引用类型底层会借助reactive形成proxy代理对象,可以直接复制整个对象，如table的数据请求回来，需要将数据整体赋值个响应对象这时如果使用的是reactive就无法进行响应。</p><p>reactive：一般用在引用类型，如{}等,不能一次性修改整个对象，如我们后端请求table的数据数据，如果想一次性赋值的整个数组的话，就行不通，此时建议使用ref来定义数组。</p><h2 id="三、循环渲染key值"><a href="#三、循环渲染key值" class="headerlink" title="三、循环渲染key值"></a>三、循环渲染key值</h2><p><em><strong>作用：用唯一标识标记每一个节点，可以高效渲染虚拟DOM树。</strong></em></p><h3 id="Diff算法"><a href="#Diff算法" class="headerlink" title="Diff算法"></a>Diff算法</h3><p>vue和react的虚拟DOM的Diff算法大致相同，其核心是基于两个简单的假设：</p><p><strong>1. 两个相同的组件产生类似的DOM结构，不同的组件产生不同的DOM结构。</strong></p><p><strong>2. 同一层级的一组节点，他们可以通过唯一的id进行区分。</strong></p><p>基于以上这两点假设，使得虚拟DOM的Diff算法的复杂度从**O(n^3)<strong>降到了</strong>O(n)**。。</p><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy80OTI3MDM1LTk2MGYyZDg1NmI1ZWM5YzMuanBn?x-oss-process=image/format,png" alt="img"></p><p><strong>key的作用主要是为了高效的更新虚拟DOM。</strong>另外vue中在使用<strong>相同标签名元素的过渡切换</strong>时，也会使用到key属性，其目的也是为了让vue可以区分它们，否则vue只会替换其内部属性而不会触发过渡效果。</p><h3 id="为什么不能用-index-作为-key"><a href="#为什么不能用-index-作为-key" class="headerlink" title="为什么不能用 index 作为 key"></a><strong>为什么不能用 index 作为 key</strong></h3><p> 如果你用 index 作为 key，那么在删除第二项的时候，index 就会从 1 2 3 变成 1 2（因为 index 永远都 是连续的，所以不可能是 1 3），那么 Vue 依然会认为你删除的是第三项。也就是会遇到上面一样的 bug。</p><p> 所以，永远不要用 index 作为 key。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;vue项目数据刷新视图不更新排查&quot;&gt;&lt;a href=&quot;#vue项目数据刷新视图不更新排查&quot; class=&quot;headerlink&quot; title=&quot;vue项目数据刷新视图不更新排查&quot;&gt;&lt;/a&gt;&lt;strong&gt;vue项目数据刷新视图不更新排查&lt;/strong&gt;&lt;/h1&gt;</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>vue-前端解决跨域</title>
    <link href="http://example.com/2022/02/21/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6-vue-%E5%89%8D%E7%AB%AF%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F/"/>
    <id>http://example.com/2022/02/21/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6-vue-%E5%89%8D%E7%AB%AF%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F/</id>
    <published>2022-02-21T12:18:52.000Z</published>
    <updated>2024-02-28T01:46:55.880Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前端解决跨域"><a href="#前端解决跨域" class="headerlink" title="前端解决跨域"></a>前端解决跨域</h1><h1 id="一、跨域"><a href="#一、跨域" class="headerlink" title="一、跨域"></a>一、<strong>跨域</strong></h1><h2 id="跨域的概念："><a href="#跨域的概念：" class="headerlink" title="跨域的概念："></a><strong>跨域的概念：</strong></h2><p>在前端领域中，跨域是指浏览器允许向服务器发送跨域请求，从而克服Ajax只能<strong>同源</strong>使用的限制。</p><h2 id="同源策略的概念："><a href="#同源策略的概念：" class="headerlink" title="同源策略的概念："></a><strong>同源策略的概念：</strong></h2><p>同源是指：<strong>协议，端口，主机都相同才同源</strong>。</p><p>同源策略/SOP（Same origin policy）是一种约定，由 Netscape 公司 1995 年引入浏览器，它是浏览器最核心也最基本的安全功能，现在所有支持 JavaScript 的浏览器都会使用这个策略。如果缺少了同源策略，浏览器很容易受到 XSS、 CSFR 等攻击</p><h1 id="二、反向代理实现"><a href="#二、反向代理实现" class="headerlink" title="二、反向代理实现"></a><strong>二、反向代理实现</strong></h1><h2 id="反向代理的概念："><a href="#反向代理的概念：" class="headerlink" title="反向代理的概念："></a><strong>反向代理的概念：</strong></h2><p>反向代理（Reverse Proxy）是指以代理服务器来接受internet上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给internet上请求连接的客户端，此时代理服务器对外就表现为一个反向代理服务器。</p><h2 id="数据流程："><a href="#数据流程：" class="headerlink" title="数据流程："></a><strong>数据流程：</strong></h2><ul><li>数据请求过程：浏览器-》【反向代理服务器-》处理数据的服务器】</li><li>数据返回过程：【处理数据的服务器-》反向代理服务器】-》浏览器</li></ul><h2 id="代码实现："><a href="#代码实现：" class="headerlink" title="代码实现："></a><strong>代码实现：</strong></h2><p>一般实在vue.config.js里面和一些webpack的配置写在一起</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.export = &#123;</span><br><span class="line">  <span class="attr">proxy</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;/api&#x27;</span>: &#123;    <span class="comment">//使用/api代替后端接口</span></span><br><span class="line">          <span class="attr">target</span>: <span class="string">&#x27;http://aa.com/bb&#x27;</span>,<span class="comment">//此处是接口地址</span></span><br><span class="line">          <span class="attr">ws</span>: <span class="literal">true</span>,</span><br><span class="line">          <span class="attr">changeOrigin</span>: <span class="literal">true</span>, <span class="comment">//是否跨域</span></span><br><span class="line">          <span class="attr">secure</span>: <span class="literal">false</span>,  <span class="comment">// 当代理某些https服务报错时用</span></span><br><span class="line">          <span class="attr">pathRewrite</span>: &#123; <span class="comment">//对api进行替换</span></span><br><span class="line">              <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置完后比如本来要请求’<a href="http://aa.com/bb/cc/dd&#39;,%E9%82%A3%E9%85%8D%E7%BD%AE%E5%90%8E%E8%AF%B7%E6%B1%82%E7%9A%84%E5%9C%B0%E5%9D%80%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%98%AF%E2%80%98api/cc/dd%E2%80%99">http://aa.com/bb/cc/dd&#39;,那配置后请求的地址就可以是‘api/cc/dd’</a></p><h1 id="三、JSONP解决跨域"><a href="#三、JSONP解决跨域" class="headerlink" title="三、JSONP解决跨域"></a><strong>三、JSONP解决跨域</strong></h1><blockquote><p>jsonp原理：<strong>jsonp</strong>的原理就是利用script标签没有跨域限制，通过script标签src属性，发送带有callback参数的GET请求，服务端将接口返回数据拼凑到callback函数中，返回给浏览器，浏览器解析执行，从而前端拿到callback函数返回的数据。</p></blockquote><h2 id="原生JS实现："><a href="#原生JS实现：" class="headerlink" title="原生JS实现："></a><strong>原生JS实现：</strong></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">script.type = <span class="string">&#x27;text/javascript&#x27;</span>;</span><br><span class="line"><span class="comment">// 传参一个回调函数名给后端，方便后端返回时执行这个在前端定义的回调函数</span></span><br><span class="line">script.src = <span class="string">&#x27;http://www.domain2.com:8080/login?user=admin&amp;callback=handleCallback&#x27;</span>;</span><br><span class="line"><span class="built_in">document</span>.head.appendChild(script);</span><br><span class="line"><span class="comment">// 回调执行函数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleCallback</span>(<span class="params">res</span>) </span>&#123;</span><br><span class="line">    alert(<span class="built_in">JSON</span>.stringify(res));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>服务端返回如下（返回时即执行全局函数）：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">handleCallback(&#123;<span class="string">&quot;success&quot;</span>: <span class="literal">true</span>, <span class="string">&quot;user&quot;</span>: <span class="string">&quot;admin&quot;</span>&#125;)</span><br></pre></td></tr></table></figure><h2 id="Vue-axios实现："><a href="#Vue-axios实现：" class="headerlink" title="Vue axios实现："></a>Vue axios实现：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">this.$http = axios;</span><br><span class="line">this.$http.jsonp(&#x27;http://www.domain2.com:8080/login&#x27;, &#123;</span><br><span class="line"></span><br><span class="line">params: &#123;&#125;,</span><br><span class="line">jsonp: &#x27;handleCallback&#x27;</span><br><span class="line"></span><br><span class="line">&#125;).then((res) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">console.log(res); </span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;前端解决跨域&quot;&gt;&lt;a href=&quot;#前端解决跨域&quot; class=&quot;headerlink&quot; title=&quot;前端解决跨域&quot;&gt;&lt;/a&gt;前端解决跨域&lt;/h1&gt;&lt;h1 id=&quot;一、跨域&quot;&gt;&lt;a href=&quot;#一、跨域&quot; class=&quot;headerlink&quot; title=&quot;一</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>vue-基于vue-quil-deitor的富文本框</title>
    <link href="http://example.com/2022/01/04/%E5%9F%BA%E4%BA%8Evue-quil-deitor%E7%9A%84%E5%AF%8C%E6%96%87%E6%9C%AC%E6%A1%86/"/>
    <id>http://example.com/2022/01/04/%E5%9F%BA%E4%BA%8Evue-quil-deitor%E7%9A%84%E5%AF%8C%E6%96%87%E6%9C%AC%E6%A1%86/</id>
    <published>2022-01-04T11:41:10.000Z</published>
    <updated>2024-02-28T01:46:48.213Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基于vue-quil-deitor的富文本框"><a href="#基于vue-quil-deitor的富文本框" class="headerlink" title="基于vue-quil-deitor的富文本框"></a><strong>基于vue-quil-deitor的富文本框</strong></h1><h2 id="一、富文本框的基本使用"><a href="#一、富文本框的基本使用" class="headerlink" title="一、富文本框的基本使用"></a><strong>一、富文本框的基本使用</strong></h2><p>富文本框quill-editor</p><p>vue-quill-editor是基于<a href="https://github.com/quilljs/quill">quill(github地址)</a>适用于Vue2的富文本编辑器，所以对于quill的原生属性扩展也是支持的。<a href="https://quilljs.com/docs/quickstart/">quill文档地址</a></p><p>富文本框首先在项目中引用这款富文本框，</p><p><img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220402135539.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;quill-editor</span><br><span class="line">          class=&quot;quill-wrapper absolute&quot;</span><br><span class="line">          v-model=&quot;content&quot;//数据绑定</span><br><span class="line">          :ref=&quot;item.ref&quot;</span><br><span class="line">          :maxlength=&quot;20000&quot;</span><br><span class="line">          :options=&quot;editorOption&quot;//默认配置</span><br><span class="line">          @blur=&quot;onEditorBlur($event)&quot;</span><br><span class="line">          @focus=&quot;onEditorFocus($event)&quot;</span><br><span class="line">          @change=&quot;onEditorChange($event,20000)&quot;</span><br><span class="line">        &gt;</span><br><span class="line">&lt;quill-editor&gt;</span><br><span class="line">import Quill from &quot;quill&quot;;</span><br></pre></td></tr></table></figure><p>在js里面写相应的方法函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">onEditorBlur</span>(<span class="params"></span>)</span> &#123;&#125;,</span><br><span class="line"><span class="function"><span class="title">onEditorFocus</span>(<span class="params"></span>)</span> &#123;&#125;,</span><br><span class="line"><span class="function"><span class="title">onEditorChange</span>(<span class="params">e, decimalNum</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.quill.getLength() &gt; decimalNum + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">this</span>.$message(&#123;</span><br><span class="line">          <span class="attr">message</span>: <span class="string">&quot;最多输入&quot;</span> + decimalNum + <span class="string">&quot;个字符&quot;</span>,</span><br><span class="line">          <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        e.quill.setText(e.quill.getText(<span class="number">0</span>, decimalNum));</span><br><span class="line">        <span class="comment">// e.quill.deleteText(decimalNum,1,e.quill.getText())</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>editorOption是富文本框的一个配置，在这里可以配置富文本框的一个主题和功能项以及一些默认值,,一般可以用vuex统一管理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> editorOption: &#123;</span><br><span class="line"> <span class="attr">placeholder</span>: <span class="string">&#x27;&#x27;</span>,  <span class="comment">//占位符</span></span><br><span class="line"> <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="attr">toolbar</span>: [<span class="comment">//功能项的配置</span></span><br><span class="line">      [<span class="string">&#x27;bold&#x27;</span>, <span class="string">&#x27;italic&#x27;</span>, <span class="string">&#x27;underline&#x27;</span>, <span class="string">&#x27;strike&#x27;</span>],<span class="comment">//加粗，斜体，下划线，删除线</span></span><br><span class="line">      [<span class="string">&#x27;blockquote&#x27;</span>, <span class="string">&#x27;code-block&#x27;</span>],  <span class="comment">//引用，代码块</span></span><br><span class="line">      [&#123; <span class="string">&#x27;header&#x27;</span>: <span class="number">1</span> &#125;, &#123; <span class="string">&#x27;header&#x27;</span>: <span class="number">2</span> &#125;], <span class="comment">// 标题，键值对的形式；1、2表示字体大小</span></span><br><span class="line">      [&#123; <span class="string">&#x27;list&#x27;</span>: <span class="string">&#x27;ordered&#x27;</span> &#125;, &#123; <span class="string">&#x27;list&#x27;</span>: <span class="string">&#x27;bullet&#x27;</span> &#125;],<span class="comment">//列表</span></span><br><span class="line">      [&#123; <span class="string">&#x27;script&#x27;</span>: <span class="string">&#x27;sub&#x27;</span> &#125;, &#123; <span class="string">&#x27;script&#x27;</span>: <span class="string">&#x27;super&#x27;</span> &#125;],<span class="comment">// 上下标</span></span><br><span class="line">      [&#123; <span class="string">&#x27;indent&#x27;</span>: <span class="string">&#x27;-1&#x27;</span> &#125;, &#123; <span class="string">&#x27;indent&#x27;</span>: <span class="string">&#x27;+1&#x27;</span> &#125;], <span class="comment">// 缩进</span></span><br><span class="line">      [&#123; <span class="string">&#x27;direction&#x27;</span>: <span class="string">&#x27;rtl&#x27;</span> &#125;],<span class="comment">// 文本方向</span></span><br><span class="line">      [&#123; <span class="string">&#x27;size&#x27;</span>: [<span class="string">&#x27;small&#x27;</span>, <span class="literal">false</span>, <span class="string">&#x27;large&#x27;</span>, <span class="string">&#x27;huge&#x27;</span>] &#125;],<span class="comment">// 字体大小</span></span><br><span class="line">      [&#123; <span class="string">&#x27;header&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="literal">false</span>] &#125;],<span class="comment">//几级标题</span></span><br><span class="line">      [&#123; <span class="string">&#x27;color&#x27;</span>: [] &#125;, &#123; <span class="string">&#x27;background&#x27;</span>: [] &#125;], <span class="comment">// 字体颜色，字体背景颜色</span></span><br><span class="line">      [&#123; <span class="string">&#x27;font&#x27;</span>: [] &#125;], <span class="comment">//字体</span></span><br><span class="line">      [&#123; <span class="string">&#x27;align&#x27;</span>: [] &#125;],<span class="comment">//对齐方式</span></span><br><span class="line">      [<span class="string">&#x27;clean&#x27;</span>], <span class="comment">//清除字体样式</span></span><br><span class="line">      <span class="comment">// [&#x27;image&#x27;, &#x27;video&#x27;] //上传图片、上传视频</span></span><br><span class="line">      [<span class="string">&#x27;image&#x27;</span>]<span class="comment">//上传图片、上传视频</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">theme</span>: <span class="string">&#x27;snow&#x27;</span><span class="comment">//主题配置</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="二、关于富文本设置图片上传"><a href="#二、关于富文本设置图片上传" class="headerlink" title="二、关于富文本设置图片上传"></a><strong>二、关于富文本设置图片上传</strong></h2><p>需要注册富文本框，将富文本框的图片上传事件拦截改为自定义上传的事件</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> imgHandler = <span class="keyword">await</span> <span class="function"><span class="keyword">function</span>(<span class="params">image</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// myQuillEditor</span></span><br><span class="line">vm.addImgRange = vm.$refs.myQuillEditor.quill.getSelection();</span><br><span class="line">  <span class="keyword">if</span> (image) &#123;        </span><br><span class="line">      <span class="keyword">var</span> fileInput = <span class="built_in">document</span>.getElementById(vm.uniqueId);</span><br><span class="line">        fileInput.click();</span><br><span class="line">        <span class="comment">//自定义上传点击事件</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;11111&quot;</span>, <span class="built_in">this</span>, vm.$refs);</span><br><span class="line"><span class="comment">//拦截富文本框的图片上传事件，改为自定义上传</span></span><br><span class="line">vm.$refs.myQuillEditor.quill</span><br><span class="line">          .getModule(<span class="string">&quot;toolbar&quot;</span>)</span><br><span class="line">          .addHandler(<span class="string">&quot;image&quot;</span>, imgHandler);</span><br></pre></td></tr></table></figure><p>上传的方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">fchangeFile</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> _this = <span class="built_in">this</span>;</span><br><span class="line">      <span class="keyword">var</span> suffix = <span class="string">&quot;image/jpg,image/jpeg,image/png,image/bmp&quot;</span>.toLowerCase();</span><br><span class="line">      <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementById(_this.uniqueId).files[<span class="number">0</span>];</span><br><span class="line">      <span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line"><span class="keyword">if</span> (suffix.indexOf(file.type.toLowerCase()) == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> _this.$message.error(<span class="string">&quot;不支持该文件类型的上传！&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      formData.append(file.name, file);</span><br><span class="line">       _this.addImgRange = _this.$refs.myQuillEditor.quill.getSelection();</span><br><span class="line">      <span class="keyword">var</span> ind = _this.addImgRange.index;</span><br><span class="line">      <span class="built_in">this</span>.$api.uploadFile(formData).then(</span><br><span class="line">        <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(data);</span><br><span class="line">          <span class="built_in">this</span>.imageUrl = data[<span class="number">0</span>].url;</span><br><span class="line">          <span class="built_in">this</span>.content = <span class="built_in">this</span>.content + <span class="string">&quot;&lt;img src=&#x27;&quot;</span> + <span class="built_in">this</span>.imageUrl + <span class="string">&quot;&#x27;/&gt;&quot;</span>;</span><br><span class="line">          <span class="built_in">document</span>.getElementById(_this.uniqueId).value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">          <span class="comment">//把光标定位到输入内容的后面</span></span><br><span class="line">          _this.$refs.myQuillEditor.quill.insertEmbed(</span><br><span class="line">            _this.addImgRange != <span class="literal">null</span> ? <span class="built_in">parseInt</span>(_this.addImgRange.index) : <span class="number">0</span>,</span><br><span class="line">            <span class="string">&quot;image&quot;</span>,</span><br><span class="line">            <span class="built_in">this</span>.imageUrl,</span><br><span class="line">            Quill.sources.USER</span><br><span class="line">          );</span><br><span class="line">          _this.$refs.myQuillEditor.quill.setSelection(</span><br><span class="line">            <span class="built_in">parseInt</span>(_this.addImgRange.index) + <span class="number">2</span></span><br><span class="line">          );</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">document</span>.getElementById(_this.uniqueId).value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">          <span class="comment">//把光标定位到输入内容的后面</span></span><br><span class="line">          _this.$refs.myQuillEditor.quill.insertEmbed(</span><br><span class="line">            _this.addImgRange != <span class="literal">null</span> ? <span class="built_in">parseInt</span>(_this.addImgRange.index) : <span class="number">0</span>,</span><br><span class="line">            <span class="string">&quot;image&quot;</span>,</span><br><span class="line">            <span class="built_in">this</span>.imageUrl,</span><br><span class="line">            Quill.sources.USER</span><br><span class="line">          );</span><br><span class="line">          <span class="comment">// console.log(&quot;测试 2：&quot;+(parseInt(_this.addImgRange.index)+3))</span></span><br><span class="line">          <span class="comment">//把光标定位到图片的后面</span></span><br><span class="line">          _this.$refs.myQuillEditor.quill.setSelection(</span><br><span class="line">            <span class="built_in">parseInt</span>(_this.addImgRange.index) + <span class="number">2</span></span><br><span class="line">          );</span><br><span class="line">        &#125;</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><p>注意：如果富文本框需要重复循环渲染的话，ref需要不同的ref，注册的事件也要分别注册，否则图片自定义的上传会出问题</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;基于vue-quil-deitor的富文本框&quot;&gt;&lt;a href=&quot;#基于vue-quil-deitor的富文本框&quot; class=&quot;headerlink&quot; title=&quot;基于vue-quil-deitor的富文本框&quot;&gt;&lt;/a&gt;&lt;strong&gt;基于vue-quil-d</summary>
      
    
    
    
    <category term="vue" scheme="http://example.com/categories/vue/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="vue" scheme="http://example.com/tags/vue/"/>
    
  </entry>
  
  <entry>
    <title>小程序-公众号跳转小程序</title>
    <link href="http://example.com/2021/12/16/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6-%E5%B0%8F%E7%A8%8B%E5%BA%8F-%E5%85%AC%E4%BC%97%E5%8F%B7%E8%B7%B3%E8%BD%AC%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    <id>http://example.com/2021/12/16/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6-%E5%B0%8F%E7%A8%8B%E5%BA%8F-%E5%85%AC%E4%BC%97%E5%8F%B7%E8%B7%B3%E8%BD%AC%E5%B0%8F%E7%A8%8B%E5%BA%8F/</id>
    <published>2021-12-16T12:22:12.000Z</published>
    <updated>2024-02-28T01:46:40.630Z</updated>
    
    <content type="html"><![CDATA[<h1 id="公众号跳转小程序"><a href="#公众号跳转小程序" class="headerlink" title="公众号跳转小程序"></a>公众号跳转小程序</h1><p>最近在做公众号跳转小程序的需求，用到了微信开放的标签，整理了一下整个设计的步骤以及需要注意的问题</p><h1 id="一、配置微信开放标签"><a href="#一、配置微信开放标签" class="headerlink" title="一、配置微信开放标签"></a><strong>一、配置微信开放标签</strong></h1><h2 id="绑定域名"><a href="#绑定域名" class="headerlink" title="绑定域名"></a><strong>绑定域名</strong></h2><p>公众号身份的网页需要先绑定安全域名才可以，在微信公众平台进入公众号设置的功能设置里面填写上<strong>JS接口安全域名</strong>。</p><p>​     <img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220406101103.png">              </p><p><strong>注意：</strong></p><ul><li><strong>如果第一步的js安全域名没有设置的话后续测试的cofig是肯定配置不成功的</strong></li><li><strong>配置安全域名需要下载校验文件并且把校验文件放到当前项目服务器里</strong></li></ul><h2 id="引入js文件"><a href="#引入js文件" class="headerlink" title="引入js文件"></a><strong>引入js文件</strong></h2><p>在需要调用JS接口的页面引入如下JS文件：<a href="http://res.wx.qq.com/open/js/jweixin-1.6.0.js">http://res.wx.qq.com/open/js/jweixin-1.6.0.js</a> （支持https）</p><p>如需进一步提升服务稳定性，当上述资源不可访问时，可改访问：<a href="http://res2.wx.qq.com/open/js/jweixin-1.6.0.js">http://res2.wx.qq.com/open/js/jweixin-1.6.0.js</a> （支持https）</p><h2 id="通过cofig配置权限验证以及开放的标签列表和需要使用的js接口列表"><a href="#通过cofig配置权限验证以及开放的标签列表和需要使用的js接口列表" class="headerlink" title="通过cofig配置权限验证以及开放的标签列表和需要使用的js接口列表"></a><strong>通过cofig配置权限验证以及开放的标签列表和需要使用的js接口列表</strong></h2><p>在config接口里面需要配置签名，appId等校验配置信息，也可以在这里配置好需要用到的JS接口以及需要用到的开放标签</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wx.config(&#123;</span><br><span class="line">  <span class="attr">debug</span>: <span class="literal">true</span>, <span class="comment">// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印</span></span><br><span class="line">  <span class="attr">appId</span>: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 必填，公众号的唯一标识</span></span><br><span class="line">  <span class="attr">timestamp</span>: , <span class="comment">// 必填，生成签名的时间戳</span></span><br><span class="line">  nonceStr: <span class="string">&#x27;&#x27;</span>, <span class="comment">// 必填，生成签名的随机串</span></span><br><span class="line">  <span class="attr">signature</span>: <span class="string">&#x27;&#x27;</span>,<span class="comment">// 必填，签名</span></span><br><span class="line">  <span class="attr">jsApiList</span>: [<span class="string">&quot;onMenuShareTimeline&quot;</span>,<span class="string">&quot;checkJsApi&quot;</span>,<span class="string">&quot;scanQRCode&quot;</span>], <span class="comment">// 必填，需要使用的JS接口列表</span></span><br><span class="line">  <span class="attr">openTagList</span>: [<span class="string">&#x27;wx-open-launch-weapp&#x27;</span>] <span class="comment">// 可选，需要使用的开放标签列表，例如[&#x27;wx-open-launch-app&#x27;]</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>详情签名算法可以看附录</strong></p><p><strong>如果出现签名校验等不成功的多半是js安全域名没有配置</strong></p><h2 id="通过ready接口处理成功验证"><a href="#通过ready接口处理成功验证" class="headerlink" title="通过ready接口处理成功验证"></a><strong>通过ready接口处理成功验证</strong></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx.ready(function () &#123;</span><br><span class="line">  // config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ol><li><h2 id="通过error接口处理失败验证"><a href="#通过error接口处理失败验证" class="headerlink" title="通过error接口处理失败验证"></a><strong>通过error接口处理失败验证</strong></h2></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wx.error(function (res) &#123;</span><br><span class="line">  // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="二、使用微信开放标签"><a href="#二、使用微信开放标签" class="headerlink" title="二、使用微信开放标签"></a><strong>二、使用微信开放标签</strong></h1><h2 id="wx-open-launch-weapp"><a href="#wx-open-launch-weapp" class="headerlink" title="wx-open-launch-weapp"></a><strong>wx-open-launch-weapp</strong></h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;wx-open-launch-weapp</span><br><span class="line">  id=<span class="string">&quot;launch-btn&quot;</span></span><br><span class="line">  username=<span class="string">&quot;gh_xxxxxxxx&quot;</span></span><br><span class="line">  path=<span class="string">&quot;pages/home/index?user=123&amp;action=abc&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">  <span class="xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"><span class="selector-class">.btn</span> &#123; <span class="attribute">padding</span>: <span class="number">12px</span> &#125;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>打开小程序<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line">&lt;/wx-open-launch-weapp&gt;</span><br></pre></td></tr></table></figure><p>标签中的属性</p><ul><li>id=”launch-btn”   –标签的id</li><li>username=”gh_xxxxxxxx”  – 所需跳转的小程序的原始id，gh开头的那个</li><li>path=”pages/home/index?user=123&amp;action=abc” – 需要跳转小程序内的页面路径以及参数</li></ul><p><strong>注意：</strong></p><ol><li><script type=“text/wxtag-template”></script> vue需要用这个，因为template被vue直接解析掉了，在页面中闪了一下，按钮就消失不见了。<template></template> 其他用这个</li><li><strong>这个在浏览器微信开发者工具中，标签如果不显示是正常的，需要在真机公众号环境中才会显示</strong></li></ol><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a><strong>附录</strong></h1><h2 id="签名算法"><a href="#签名算法" class="headerlink" title="签名算法"></a><strong>签名算法</strong></h2><p>参与签名的字段包括</p><ul><li>noncestr（随机字符串</li><li>有效的jsapi_ticket,</li><li>timestamp（时间戳</li><li>url（当前网页的URL，不包含#及其后面部分。</li></ul><p>对所有待签名参数按照字段名的ASCII 码从小到大排序（字典序）后，使用URL键值对的格式（即key1=value1&amp;key2=value2…）拼接成字符串string1。这里需要注意的是所有参数名均为小写字符。对string1作sha1加密，字段名和字段值都采用原始值，不进行URL 转义。</p><p>即signature=sha1(string1)。 示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">noncestr=Wm3WZYTPz0wzccnW</span><br><span class="line">jsapi_ticket=sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcHKP7qg</span><br><span class="line">timestamp=1414587457</span><br><span class="line">url=http://mp.weixin.qq.com?params=value</span><br></pre></td></tr></table></figure><p>步骤1. 对所有待签名参数按照字段名的ASCII 码从小到大排序（字典序）后，使用URL键值对的格式（即key1=value1&amp;key2=value2…）拼接成字符串string1：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jsapi_ticket=sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcHKP7qg&amp;noncestr=Wm3WZYTPz0wzccnW&amp;timestamp=1414587457&amp;url=http://mp.weixin.qq.com?params=value</span><br></pre></td></tr></table></figure><p>步骤2. 对string1进行sha1签名，得到signature：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0f9de62fce790f9a083d5c99e95740ceb90c27ed</span><br></pre></td></tr></table></figure><p>注意事项</p><ol><li>签名用的noncestr和timestamp必须与wx.config中的nonceStr和timestamp相同。</li><li>签名用的url必须是调用JS接口页面的完整URL。</li><li>出于安全考虑，开发者必须在服务器端实现签名的逻辑。</li></ol><h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a><strong>官方文档</strong></h2><p><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_Open_Tag.html">微信开放标签官方文档</a></p><p><a href="https://developers.weixin.qq.com/community/minihome/doc/0004462fed03f86f495b885015ec00">配置JS安全域名遇到问题</a></p><p><a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=jsapisign">微信 JS 接口签名校验工具</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;公众号跳转小程序&quot;&gt;&lt;a href=&quot;#公众号跳转小程序&quot; class=&quot;headerlink&quot; title=&quot;公众号跳转小程序&quot;&gt;&lt;/a&gt;公众号跳转小程序&lt;/h1&gt;&lt;p&gt;最近在做公众号跳转小程序的需求，用到了微信开放的标签，整理了一下整个设计的步骤以及需要注意的</summary>
      
    
    
    
    <category term="小程序" scheme="http://example.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="小程序" scheme="http://example.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>小程序-websocket</title>
    <link href="http://example.com/2021/08/31/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6-%E5%B0%8F%E7%A8%8B%E5%BA%8F-webSocket/"/>
    <id>http://example.com/2021/08/31/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6-%E5%B0%8F%E7%A8%8B%E5%BA%8F-webSocket/</id>
    <published>2021-08-31T14:16:52.000Z</published>
    <updated>2024-02-28T01:46:32.167Z</updated>
    
    <content type="html"><![CDATA[<h1 id="微信小程序webSocket"><a href="#微信小程序webSocket" class="headerlink" title="微信小程序webSocket"></a>微信小程序webSocket</h1><h2 id="1-webSocket"><a href="#1-webSocket" class="headerlink" title="1.webSocket"></a>1.webSocket</h2><p>微信原生webSocket接口对于开发wx小程序非常方便，通过 WebSocket 连接发送数据。需要先 wx.connectSocket，并在 wx.onSocketOpen 回调之后才能发送。</p><h3 id="wx-connectSocket-Object-object"><a href="#wx-connectSocket-Object-object" class="headerlink" title="wx.connectSocket(Object object)"></a>wx.connectSocket(Object object)</h3><p>api:</p><ul><li><font style="color:red">url</font>：wss接口地址</li><li>header：http的jeader</li><li>protocols：子协议数组</li><li>timeout：超时时间</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wx.connectSocket(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&#x27;wss://example.qq.com&#x27;</span>,</span><br><span class="line">  <span class="attr">header</span>:&#123;</span><br><span class="line">    <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">protocols</span>: [<span class="string">&#x27;protocol1&#x27;</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="wx-sendSocketMessage-Object-object"><a href="#wx-sendSocketMessage-Object-object" class="headerlink" title="wx.sendSocketMessage(Object object)"></a>wx.sendSocketMessage(Object object)</h3><p>api:</p><ul><li><font style="color:red">data</font>:需要发送的内容</li><li>success：接口调用成功的回调函数</li><li>fail：接口调用失败的回调函数</li><li>complete：接口调用结束的回调函数（成功失败都会调用）</li></ul><h3 id="wx-onSocketOpen（function-callback）"><a href="#wx-onSocketOpen（function-callback）" class="headerlink" title="wx.onSocketOpen（function callback）"></a>wx.onSocketOpen（function callback）</h3><p>里面的回调函数是连接打开后的事件回调函数</p><h3 id="wx-onSocketClose（function-callback）"><a href="#wx-onSocketClose（function-callback）" class="headerlink" title="wx.onSocketClose（function callback）"></a>wx.onSocketClose（function callback）</h3><p>连接关闭事件的回调函数有个res里面有两个参数，code代表关闭连接的状态号，reason表示关闭的原因</p><h3 id="wx-onSocketError（function-callback）"><a href="#wx-onSocketError（function-callback）" class="headerlink" title="wx.onSocketError（function callback）"></a>wx.onSocketError（function callback）</h3><p>WebSocket 错误事件的回调函数</p><h3 id="wx-onSocketMessage（function-callback）"><a href="#wx-onSocketMessage（function-callback）" class="headerlink" title="wx.onSocketMessage（function callback）"></a>wx.onSocketMessage（function callback）</h3><p>WebSocket 接受到服务器的消息事件的回调函数</p><h2 id="2-一个接收数据的例子"><a href="#2-一个接收数据的例子" class="headerlink" title="2.一个接收数据的例子"></a>2.一个接收数据的例子</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> scoket;<span class="comment">//定义一个socket</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connectWxSocket</span>(<span class="params">token</span>)</span>&#123;<span class="comment">//</span></span><br><span class="line">  scoket = wx.connectSocket(&#123;</span><br><span class="line">    <span class="comment">// url: `$&#123;globalConfig.getLocalConfig().socketUrl&#125;/webSocket/$&#123;token&#125;`</span></span><br><span class="line">    <span class="attr">url</span>: <span class="string">`ws://82.157.123.54:9010/ajaxchattest`</span></span><br><span class="line">  &#125;)<span class="comment">//scoket的地址</span></span><br><span class="line">  <span class="comment">//打开socket</span></span><br><span class="line">  wx.onSocketOpen(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">    log(<span class="string">&quot;WebSocket opened&quot;</span>,<span class="string">&quot;green&quot;</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">//监听连接关闭事件</span></span><br><span class="line">  wx.onSocketClose(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    log(<span class="string">&quot;WebSocket close&quot;</span>,<span class="string">&quot;red&quot;</span>,res)</span><br><span class="line">    <span class="keyword">if</span>(res.code !== <span class="number">1000</span>)&#123;</span><br><span class="line">      wx.connectSocket(&#123;</span><br><span class="line">        <span class="attr">url</span>: <span class="string">`<span class="subst">$&#123;globalConfig.getLocalConfig().socketUrl&#125;</span>/webSocket/<span class="subst">$&#123;token&#125;</span>`</span></span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">//监听并处理error事件</span></span><br><span class="line">  wx.onSocketError(<span class="function">(<span class="params">err</span>)=&gt;</span>&#123;</span><br><span class="line">    log(<span class="string">&quot;WebSocket error&quot;</span>,<span class="string">&quot;red&quot;</span>,err)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">//接听服务器发回的信息并处理</span></span><br><span class="line">  wx.onSocketMessage(<span class="function">(<span class="params">res</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> data = <span class="built_in">JSON</span>.parse(res.data)</span><br><span class="line">    log(<span class="string">&quot;WebSockt 收到消息&quot;</span>,<span class="string">&quot;green&quot;</span>,<span class="built_in">JSON</span>.parse(res.data))</span><br><span class="line">    messageHandle(res.data)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//对服务器发回的信息进行处理并且弹框显示</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">messageHandle</span>(<span class="params">message</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">let</span> msg = <span class="built_in">JSON</span>.parse(message)</span><br><span class="line">  msg.sendBean=&#123;<span class="attr">consultType</span>:<span class="number">1</span>,<span class="attr">consultId</span>: <span class="string">&quot;3672b906b55042b7a50b3ba3de5066c5&quot;</span>&#125;</span><br><span class="line">  <span class="keyword">if</span>(msg.sendBean &amp;&amp; msg.sendBean.consultType)&#123;</span><br><span class="line">    wx.showModal(&#123;</span><br><span class="line">      <span class="attr">title</span>: <span class="string">&#x27;提示&#x27;</span>,</span><br><span class="line">      <span class="attr">content</span>: <span class="string">&#x27;来消息了来消息了耶~&#x27;</span>,</span><br><span class="line">      <span class="attr">confirmText</span>: <span class="string">&#x27;接受&#x27;</span>,</span><br><span class="line">      <span class="attr">showCancel</span>:<span class="literal">true</span>,</span><br><span class="line">      <span class="attr">cancel</span>:<span class="string">&quot;拒绝&quot;</span>,</span><br><span class="line">      success (res) &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.confirm) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;用户点击接受&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (res.cancel) &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(<span class="string">&#x27;用户点击拒绝&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">msg,color,res=<span class="string">&quot;&quot;</span></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`%c<span class="subst">$&#123;msg&#125;</span>`</span>,<span class="string">`background-color:<span class="subst">$&#123;color&#125;</span>;color: white; padding: 0.3em 0.5em;`</span>,res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  connectWxSocket</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="C:\Users\shenglina\AppData\Roaming\Typora\typora-user-images\image-20210831193107000.png" alt="image-20210831193107000" style="zoom:300%;" />]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;微信小程序webSocket&quot;&gt;&lt;a href=&quot;#微信小程序webSocket&quot; class=&quot;headerlink&quot; title=&quot;微信小程序webSocket&quot;&gt;&lt;/a&gt;微信小程序webSocket&lt;/h1&gt;&lt;h2 id=&quot;1-webSocket&quot;&gt;&lt;a h</summary>
      
    
    
    
    <category term="小程序" scheme="http://example.com/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
    
    <category term="前端技术进阶" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E8%BF%9B%E9%98%B6/"/>
    
    <category term="小程序" scheme="http://example.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>css-弹性盒</title>
    <link href="http://example.com/2020/10/18/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-css-%E5%BC%B9%E6%80%A7%E7%9B%92/"/>
    <id>http://example.com/2020/10/18/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-css-%E5%BC%B9%E6%80%A7%E7%9B%92/</id>
    <published>2020-10-18T10:41:10.000Z</published>
    <updated>2024-02-28T01:55:42.810Z</updated>
    
    <content type="html"><![CDATA[<h1 id="css3弹性盒"><a href="#css3弹性盒" class="headerlink" title="css3弹性盒"></a>css3弹性盒</h1><h2 id="一、概念"><a href="#一、概念" class="headerlink" title="一、概念"></a>一、概念</h2><p>弹性盒子是CSS3的一种新布局模式。</p><p>CSS3 弹性盒（ Flexible Box 或 flexbox），是一种当页面需要适应不同的屏幕大小以及设备类型时确保元素拥有恰当的行为的布局方式。</p><p>引入弹性盒布局模型的目的是提供一种更加有效的方式来对一个容器中的子元素进行排列、对齐和分配空白空间。</p><h3 id="盒子内容"><a href="#盒子内容" class="headerlink" title="盒子内容"></a>盒子内容</h3><p>弹性盒子由弹性容器(Flex container)和弹性子元素(Flex item)组成。</p><p>弹性容器通过设置 display 属性的值为 flex 或 inline-flex将其定义为弹性容器。</p><p>弹性容器内包含了一个或多个弹性子元素。</p><p><strong>注意：</strong> 弹性容器外及弹性子元素内是正常渲染的。弹性盒子只定义了弹性子元素如何在弹性容器内布局。</p><p>弹性子元素通常在弹性盒子内一行显示。默认情况每个容器只有一行。</p><p>以下元素展示了弹性子元素在一行内显示，从左到右:</p><h2 id="二、CSS3-弹性盒子常用属性"><a href="#二、CSS3-弹性盒子常用属性" class="headerlink" title="二、CSS3 弹性盒子常用属性"></a>二、CSS3 弹性盒子常用属性</h2><table><thead><tr><th>属性</th><th>描述</th></tr></thead><tbody><tr><td>flex-direction</td><td>指定弹性容器中子元素排列方式</td></tr><tr><td>flex-wrap</td><td>设置弹性盒子的子元素超出父容器时是否换行</td></tr><tr><td>flex-flow</td><td>flex-direction 和 flex-wrap 的简写</td></tr><tr><td>align-items</td><td>设置弹性盒子元素在侧轴（纵轴）方向上的对齐方式</td></tr><tr><td>align-content</td><td>修改 flex-wrap 属性的行为，类似 align-items, 但不是设置子元素对齐，而是设置行对齐</td></tr><tr><td>justify-content</td><td>设置弹性盒子元素在主轴（横轴）方向上的对齐方式</td></tr></tbody></table><h3 id="1-flex-direction-属性"><a href="#1-flex-direction-属性" class="headerlink" title="1. flex-direction 属性"></a>1. flex-direction 属性</h3><p>flex-direction主要是决定项目的方向。</p><p><strong>注意：</strong>如果元素不是弹性盒对象的元素，则 flex-direction 属性不起作用。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> &#123; <span class="attribute">flex-direction</span>: row | row-reverse | column | column-reverse; &#125;</span><br></pre></td></tr></table></figure><p> <strong>属性值</strong></p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>row</td><td>默认值。元素将水平显示，正如一个行一样。</td></tr><tr><td>row-reverse</td><td>与 row 相同，但是以相反的顺序。</td></tr><tr><td>column</td><td>元素将垂直显示，正如一个列一样。</td></tr><tr><td>column-reverse</td><td>与 column 相同，但是以相反的顺序。</td></tr></tbody></table><p><img src="https://gitee.com/victory_na/my-img-host/raw/master/img/image-20220401134932215.png"></p><h3 id="2-align-items属性"><a href="#2-align-items属性" class="headerlink" title="2. align-items属性"></a>2. align-items属性</h3><p>align-items 属性定义flex子项在flex容器的当前行的侧轴（纵轴）方向上的对齐方式。</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>stretch</td><td>默认值。项目被拉伸以适应容器。</td></tr><tr><td>center</td><td>项目位于容器的中心。</td></tr><tr><td>flex-start</td><td>项目位于容器的开头。</td></tr><tr><td>flex-end</td><td>项目位于容器的结尾。</td></tr><tr><td>baseline</td><td>项目位于容器的基线上。</td></tr></tbody></table><h3 id="3-justify-content属性"><a href="#3-justify-content属性" class="headerlink" title="3. justify-content属性"></a>3. justify-content属性</h3><p>justify-content 用于设置或检索弹性盒子元素在主轴（横轴）方向上的对齐方式。</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>flex-start</td><td>默认值。项目位于容器的开头。</td></tr><tr><td>flex-end</td><td>项目位于容器的结尾。</td></tr><tr><td>center</td><td>项目位于容器的中心。</td></tr><tr><td>space-between</td><td>项目位于各行之间留有空白的容器内。</td></tr><tr><td>space-around</td><td>项目位于各行之前、之间、之后都留有空白的容器内。</td></tr></tbody></table><h3 id="4-flex-wrap-属性"><a href="#4-flex-wrap-属性" class="headerlink" title="4. flex-wrap 属性"></a>4. flex-wrap 属性</h3><p>flex-wrap 属性规定flex容器是单行或者多行，同时横轴的方向决定了新行堆叠的方向。</p><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>nowrap</td><td>默认值。规定元素不拆行或不拆列。</td></tr><tr><td>wrap</td><td>规定元素在必要的时候拆行或拆列。</td></tr><tr><td>wrap-reverse</td><td>规定元素在必要的时候拆行或拆列，但是以相反的顺序。</td></tr></tbody></table><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> &#123; <span class="attribute">flex-wrap</span>: nowrap | wrap | wrap-reverse; &#125;</span><br></pre></td></tr></table></figure><p>可以取三个值：<br>（1） nowrap (默认)：不换行。</p><p><img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220402135821.png" alt="img"></p><p>（2）wrap：换行，第一行在上方。</p><p><img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220402135847.png" alt="img"></p><p>（3）wrap-reverse：换行，第一行在下方。</p><p><img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220402135908.png" alt="img"></p><h3 id="5-flex-flow-属性"><a href="#5-flex-flow-属性" class="headerlink" title="5. flex-flow 属性"></a>5. flex-flow 属性</h3><p>flex-flow属性是flex-direction属性和flex-wrap属性的简写形式，默认值为row nowrap。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> &#123; <span class="attribute">flex-flow</span>: &lt;flex-direction&gt; &lt;flex-wrap&gt; &#125;</span><br></pre></td></tr></table></figure><h2 id="三、弹性子元素属性"><a href="#三、弹性子元素属性" class="headerlink" title="三、弹性子元素属性"></a>三、弹性子元素属性</h2><table><thead><tr><th>属     性</th><th>描述</th></tr></thead><tbody><tr><td>order</td><td>设置弹性盒子的子元素排列顺序。</td></tr><tr><td>flex-grow</td><td>设置或检索弹性盒子元素的扩展比率。</td></tr><tr><td>flex-shrink</td><td>指定了 flex 元素的收缩规则。flex 元素仅在默认宽度之和大于容器的时候才会发生收缩，其收缩的大小是依据 flex-shrink 的值。</td></tr><tr><td>flex-basis</td><td>用于设置或检索弹性盒伸缩基准值。</td></tr><tr><td>flex</td><td>设置弹性盒子的子元素如何分配空间。</td></tr><tr><td>align-self</td><td>在弹性子元素上使用。覆盖容器的 align-items 属性。</td></tr></tbody></table><h3 id="1-order属性"><a href="#1-order属性" class="headerlink" title="1. order属性"></a>1. order属性</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> <span class="selector-class">.flex-item</span> &#123; <span class="attribute">order</span>: &lt;integer&gt;; &#125;</span><br></pre></td></tr></table></figure><p><integer>：用整数值来定义<strong>排列顺序</strong>，数值小的排在前面。可以为负值，默认为0。</p><h3 id="2-flex-grow属性"><a href="#2-flex-grow属性" class="headerlink" title="2. flex-grow属性"></a>2. flex-grow属性</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> <span class="selector-class">.flex-item</span> &#123; <span class="attribute">flex-grow</span>: &lt;integer&gt;; &#125;</span><br></pre></td></tr></table></figure><p><integer>：一个数字，规定项目将相对于其他灵活的项目进行扩展的量。默认值是 0。</p><p><img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220402135928.png" alt="img"></p><h3 id="3-flex-shrink属性"><a href="#3-flex-shrink属性" class="headerlink" title="3. flex-shrink属性"></a>3. flex-shrink属性</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> <span class="selector-class">.flex-item</span> &#123; <span class="attribute">flex-shrink</span>: &lt;integer&gt;; &#125;</span><br></pre></td></tr></table></figure><p><integer>：一个数字，规定项目将相对于其他灵活的项目进行收缩的量。默认值是 1。</p><p><img src="https://gitee.com/victory_na/my-img-host/raw/master/img/20220402135943.png" alt="img"></p><h3 id="4-flex-basis属性"><a href="#4-flex-basis属性" class="headerlink" title="4. flex-basis属性"></a>4. flex-basis属性</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> <span class="selector-class">.flex-item</span> &#123; <span class="attribute">flex-basis</span>: &lt;integer&gt; | auto; &#125;</span><br></pre></td></tr></table></figure><p><integer>：一个长度单位或者一个百分比，规定元素的初始长度。<br>auto：默认值。长度等于元素的长度。如果该项目未指定长度，则长度将根据内容决定。</p><h3 id="5-flex属性"><a href="#5-flex属性" class="headerlink" title="5. flex属性"></a>5. flex属性</h3><p>flex 属性用于设置或检索弹性盒模型对象的子元素如何分配空间。</p><p>flex 属性是 flex-grow、flex-shrink 和 flex-basis 属性的简写属性。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> <span class="selector-class">.flex-item</span> &#123; <span class="attribute">flex</span>: flex-grow flex-shrink flex-basis | auto | initial | inherit; &#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>flex-grow</td><td>一个数字，规定项目将相对于其他元素进行扩展的量。</td></tr><tr><td>flex-shrink</td><td>一个数字，规定项目将相对于其他元素进行收缩的量。</td></tr><tr><td>flex-basis</td><td>项目的长度。合法值：”auto”、”inherit” 或一个后跟 “%”、”px”、”em” 或任何其他长度单位的数字。</td></tr><tr><td>auto</td><td>与 1 1 auto 相同。</td></tr><tr><td>none</td><td>与 0 0 auto 相同。</td></tr><tr><td>initial</td><td>设置该属性为它的默认值，即为 0 1 auto。</td></tr><tr><td>inherit</td><td>从父元素继承该属性。</td></tr></tbody></table><h3 id="6-align-self属性"><a href="#6-align-self属性" class="headerlink" title="6. align-self属性"></a>6. align-self属性</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> <span class="selector-class">.flex-item</span> &#123;</span><br><span class="line">    <span class="attribute">align-self</span>: auto | stretch | center | flex-start | flex-end | baseline | initial | inherit;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td>auto</td><td>默认值。元素继承了它的父容器的 align-items 属性。如果没有父容器则为 “stretch”。</td></tr><tr><td>stretch</td><td>元素被拉伸以适应容器。</td></tr><tr><td>center</td><td>元素位于容器的中心。</td></tr><tr><td>flex-start</td><td>元素位于容器的开头。</td></tr><tr><td>flex-end</td><td>元素位于容器的结尾。</td></tr><tr><td>baseline</td><td>元素位于容器的基线上。</td></tr><tr><td>initial</td><td>设置该属性为它的默认值。</td></tr><tr><td>inherit</td><td>从父元素继承该属性。</td></tr></tbody></table><p>取值同 align-items。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;css3弹性盒&quot;&gt;&lt;a href=&quot;#css3弹性盒&quot; class=&quot;headerlink&quot; title=&quot;css3弹性盒&quot;&gt;&lt;/a&gt;css3弹性盒&lt;/h1&gt;&lt;h2 id=&quot;一、概念&quot;&gt;&lt;a href=&quot;#一、概念&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="css" scheme="http://example.com/categories/css/"/>
    
    
    <category term="前端技术基础" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/"/>
    
    <category term="css" scheme="http://example.com/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>js-ES6新增</title>
    <link href="http://example.com/2020/09/30/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-js-ES6%E6%96%B0%E5%A2%9E/"/>
    <id>http://example.com/2020/09/30/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-js-ES6%E6%96%B0%E5%A2%9E/</id>
    <published>2020-09-30T14:50:11.000Z</published>
    <updated>2024-02-28T01:46:07.449Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ES6新增特性"><a href="#ES6新增特性" class="headerlink" title="ES6新增特性"></a>ES6新增特性</h1><h2 id="一、let和const"><a href="#一、let和const" class="headerlink" title="一、let和const"></a>一、let和const</h2><h4 id="1-let"><a href="#1-let" class="headerlink" title="1.let"></a>1.let</h4><ul><li>let 定义变量，变量不可以再次定义，但可以改变其值</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;zhangsan&#x27;</span>;</span><br><span class="line">name = <span class="string">&#x27;lisi&#x27;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// lisi</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;wangwu&#x27;</span>; <span class="comment">// 再次定义，报错：Identifier &#x27;name&#x27; has already been declared</span></span><br></pre></td></tr></table></figure><ul><li>具有块级作用域。（即大括号）</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> age = <span class="number">18</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(age); <span class="comment">// 18</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(age); <span class="comment">// 报错，此作用域中没有age的定义</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="comment">// i 只能在此范围内使用，因为有块级作用域</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(i);  <span class="comment">// 报错，此作用域中没有i的定义</span></span><br></pre></td></tr></table></figure><ul><li>没有变量提升，必须先定义再使用</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(gender); <span class="comment">// 报错，此时还没有定义gender</span></span><br><span class="line"><span class="keyword">let</span> gender = <span class="string">&#x27;男&#x27;</span>; </span><br></pre></td></tr></table></figure><ul><li>let声明的变量不会压到window对象中，是独立的</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> hobby = <span class="string">&#x27;吃饭&#x27;</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.hobby); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><p><strong>如果使用var声明了变量，也不能再次用let声明了，反之也是不行的。原因也是这个变量已经被声明过了。</strong></p><h4 id="2-const"><a href="#2-const" class="headerlink" title="2.const"></a>2.const</h4><ul><li>使用const关键字定义常量</li><li>常量是不可变的，一旦定义，则不能修改其值</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 使用const关键字定义常量，常量名一般大写</span></span><br><span class="line"><span class="comment">// 2. 常量是不可变的，一旦定义，则不能修改其值</span></span><br><span class="line"><span class="keyword">const</span> PI = <span class="number">3.1415926</span>；</span><br><span class="line">PI = <span class="number">3.14</span>; <span class="comment">// 报错，常用一旦被初始化，则不能被修改</span></span><br></pre></td></tr></table></figure><ul><li>初始化常量时，必须给初始值</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PI; </span><br><span class="line"><span class="comment">// 报错，Missing initializer in const declaration</span></span><br></pre></td></tr></table></figure><ul><li>具有块级作用域</li><li>没有变量提升，必须先定义再使用</li><li>常量也是独立的，定义后不会压入到window对象中</li></ul><h4 id="3-总结"><a href="#3-总结" class="headerlink" title="3.总结"></a>3.总结</h4><table><thead><tr><th align="left">关 键字</th><th align="left">变量提升</th><th align="left">块级作用域</th><th>更   改</th><th>通过window调用</th></tr></thead><tbody><tr><td align="left">let</td><td align="left">no</td><td align="left">yes</td><td>yes</td><td>no</td></tr><tr><td align="left">const</td><td align="left">no</td><td align="left">yes</td><td>no</td><td>no</td></tr><tr><td align="left">var</td><td align="left">yes</td><td align="left">no</td><td>yes</td><td>yes</td></tr></tbody></table><h2 id="二、解构赋值"><a href="#二、解构赋值" class="headerlink" title="二、解构赋值"></a>二、解构赋值</h2><h4 id="1-数组解构"><a href="#1-数组解构" class="headerlink" title="1.数组解构"></a>1.数组解构</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 情况1，变量和值一一对应</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line"><span class="keyword">let</span> [a, b, c] = arr;</span><br><span class="line"><span class="built_in">console</span>.log(a, b, c); <span class="comment">// 输出 5 9 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况2，变量多，值少</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line"><span class="keyword">let</span> [a, b, c, d] = arr;</span><br><span class="line"><span class="built_in">console</span>.log(a, b, c, d); <span class="comment">// 输出 5 9 10 undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况3，变量少，值多</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">let</span> [a, b] = arr;</span><br><span class="line"><span class="built_in">console</span>.log(a, b); <span class="comment">// 5, 9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况4，按需取值</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">let</span> [, , a, , b] = arr; <span class="comment">// 不需要用变量接收的值，用空位占位</span></span><br><span class="line"><span class="built_in">console</span>.log(a, b); <span class="comment">// 10, 3 </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况5，剩余值</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">5</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">let</span> [a, b, ...c] = arr; <span class="comment">// ...c 接收剩余的其他值，得到的c是一个数组</span></span><br><span class="line"><span class="built_in">console</span>.log(a, b, c); </span><br><span class="line"><span class="comment">// 结果：</span></span><br><span class="line"><span class="comment">// a = 5, </span></span><br><span class="line"><span class="comment">// b = 9, </span></span><br><span class="line"><span class="comment">// c = [10, 8, 3, 2]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况6，复杂的情况，只要符合模式，即可解构</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">&#x27;zhangsan&#x27;</span>, <span class="number">18</span>, [<span class="string">&#x27;175cm&#x27;</span>, <span class="string">&#x27;65kg&#x27;</span>]];</span><br><span class="line"><span class="keyword">let</span> [, , [a, b]] = arr;</span><br><span class="line"><span class="built_in">console</span>.log(a, b); <span class="comment">// 175cm 65kg</span></span><br></pre></td></tr></table></figure><h4 id="2-对象解构"><a href="#2-对象解构" class="headerlink" title="2.对象解构"></a>2.对象解构</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 情况1，默认要求变量名和属性名一样</span></span><br><span class="line"><span class="keyword">let</span> &#123; foo, bar &#125; = &#123;<span class="attr">foo</span>: <span class="string">&#x27;aaa&#x27;</span>, <span class="attr">bar</span>: <span class="string">&#x27;bbb&#x27;</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(foo, bar); <span class="comment">// aaa, bbb</span></span><br><span class="line"><span class="keyword">let</span> &#123;a, c&#125; = &#123;<span class="attr">a</span>: <span class="string">&#x27;hello&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;world&#x27;</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(a, c); <span class="comment">// hello, undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况2，可以通过:为变量改名</span></span><br><span class="line"><span class="keyword">let</span> &#123;a, <span class="attr">b</span>:c&#125; = &#123;<span class="attr">a</span>: <span class="string">&#x27;hello&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;world&#x27;</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(a, c); <span class="comment">// hello, world</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况3，变量名和属性名一致即可获取到值，不一定要一一对应</span></span><br><span class="line"><span class="keyword">let</span> &#123;b&#125; = &#123;<span class="attr">a</span>: <span class="string">&#x27;hello&#x27;</span>, <span class="attr">b</span>: <span class="string">&#x27;world&#x27;</span>&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(b); <span class="comment">// world</span></span><br><span class="line"><span class="comment">// 此时，没有定义变量a，所以使用a会报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况4，剩余值</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">name</span>:<span class="string">&#x27;zs&#x27;</span>, <span class="attr">age</span>:<span class="number">20</span>, <span class="attr">gender</span>:<span class="string">&#x27;男&#x27;</span>&#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;name, ...a&#125; = obj;</span><br><span class="line"><span class="built_in">console</span>.log(name, a);</span><br><span class="line"><span class="comment">// 结果：</span></span><br><span class="line"><span class="comment">// name = zs</span></span><br><span class="line"><span class="comment">// a = &#123;age: 20, gender: &quot;男&quot;&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 情况5，复杂的情况，只要符合模式，即可解构</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zhangsan&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">22</span>,</span><br><span class="line">    <span class="attr">dog</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;毛毛&#x27;</span>,</span><br><span class="line">        <span class="attr">age</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> &#123;<span class="attr">dog</span>: &#123;name, age&#125;&#125; = obj;</span><br><span class="line"><span class="built_in">console</span>.log(name, age); <span class="comment">// 毛毛 3</span></span><br></pre></td></tr></table></figure><h2 id="三、箭头函数"><a href="#三、箭头函数" class="headerlink" title="三、箭头函数"></a>三、箭头函数</h2><p>使用箭头定义函数 <code>=&gt; goes to</code>，目的是<strong>简化函数的定义</strong>并且里面的this也比较特殊。</p><p>基本定义：</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 非箭头函数</span></span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 箭头函数，等同于上面的函数</span></span><br><span class="line"><span class="keyword">let</span> fn = <span class="function">(<span class="params">x</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>形参只有一个可以省略小括号</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="function">(<span class="params">x</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">let</span> fn = <span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>函数体只有一句话，可以省略大括号，并且表示返回函数体的内容</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="function">(<span class="params">x, y</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">let</span> fn = <span class="function">(<span class="params">x, y</span>) =&gt;</span> x + y;</span><br></pre></td></tr></table></figure><ul><li>箭头函数内部没有 arguments</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> fn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">arguments</span>); <span class="comment">// 报错，arguments is not defined</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>箭头函数内部的 <code>this</code> 指向外部作用域中的 <code>this</code> ，或者可以认为箭头函数没有自己的 <code>this</code></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里必须用var，因为用let声明的变量不能使用window调用</span></span><br><span class="line">   <span class="keyword">var</span> name = <span class="string">&#x27;lisi&#x27;</span>;</span><br><span class="line">   <span class="keyword">let</span> obj = &#123;</span><br><span class="line">       <span class="attr">name</span>: <span class="string">&#x27;zhangsan&#x27;</span>,</span><br><span class="line">       <span class="attr">fn</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">           <span class="built_in">console</span>.log(<span class="built_in">this</span>); <span class="comment">// window对象</span></span><br><span class="line">           <span class="built_in">console</span>.log(<span class="built_in">this</span>.name); <span class="comment">// lisi</span></span><br><span class="line">       &#125;</span><br><span class="line">   &#125;;</span><br><span class="line">   obj.fn();</span><br></pre></td></tr></table></figure><ul><li>箭头函数不能作为构造函数</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Person = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> Person(); <span class="comment">// 报错，Person is not a constructor</span></span><br><span class="line"><span class="comment">// 箭头函数中都没有自己的this，不能处理成员，所以不能当构造函数</span></span><br></pre></td></tr></table></figure><h2 id="四、内置函数的扩展"><a href="#四、内置函数的扩展" class="headerlink" title="四、内置函数的扩展"></a>四、内置函数的扩展</h2><h4 id="1-扩展运算符：…"><a href="#1-扩展运算符：…" class="headerlink" title="1.扩展运算符：…"></a>1.扩展运算符：…</h4><p><code>...</code>可以把数组中的每一项展开</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 合并两个数组</span></span><br><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="keyword">let</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">let</span> arr3 = [...arr1, ...arr2];</span><br><span class="line"><span class="built_in">console</span>.log(arr3); <span class="comment">// [1, 2, 3, 4]</span></span><br><span class="line"><span class="comment">// 把数组展开作为参数，可以替代 apply</span></span><br><span class="line"><span class="comment">// 求数组的最大值</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">6</span>, <span class="number">99</span>, <span class="number">10</span>, <span class="number">1</span>];</span><br><span class="line"><span class="keyword">let</span> max = <span class="built_in">Math</span>.max(...arr); <span class="comment">// 等同于 Math.max(6, 99, 10, 1);</span></span><br></pre></td></tr></table></figure><h4 id="2-find-方法和findIndex-方法"><a href="#2-find-方法和findIndex-方法" class="headerlink" title="2.find()方法和findIndex()方法"></a>2.find()方法和findIndex()方法</h4><p>find()：用于查找数组中的值<br> findIndex()：用于查找数组的下标，用法与find一样</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> value = [<span class="number">3</span>, <span class="number">5</span>, -<span class="number">1</span>, -<span class="number">4</span>, <span class="number">6</span>].find(<span class="function">(<span class="params">item, index, arr</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(item); <span class="comment">//表示数组的每个值</span></span><br><span class="line">    <span class="built_in">console</span>.log(index); <span class="comment">//表示数组的每个下标</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr); <span class="comment">//表示整个数组</span></span><br><span class="line">    <span class="comment">//如果需要查找，要用到return 条件；</span></span><br><span class="line">    <span class="keyword">return</span> item &lt; <span class="number">0</span>; <span class="comment">//find方法会返回第一个满足条件的值，-1</span></span><br><span class="line">    <span class="comment">//如果是findIndex方法，会返回第一个满足条件的值的下标，2</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(value);</span><br></pre></td></tr></table></figure><ul><li><strong>find</strong> 找到数组中第一个满足条件的成员并<strong>返回该成员</strong>，如果找不到返回<strong>undefined</strong>。</li><li><strong>findIndex</strong> 找到数组中第一个满足条件的成员并<strong>返回该成员的索引</strong>，如果找不到返回 <strong>-1</strong>。</li></ul><h4 id="3-includes-方法"><a href="#3-includes-方法" class="headerlink" title="3.includes()方法"></a>3.includes()方法</h4><ul><li>判断数组是否包含某个值，返回 true / false</li><li>参数1，必须，表示查找的内容</li><li>参数2，可选，表示开始查找的位置，0表示开头的位置</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">9</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.includes(<span class="number">4</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.includes(<span class="number">4</span>, <span class="number">2</span>)); <span class="comment">// false， 从2的位置开始查，所以没有找到4</span></span><br><span class="line"><span class="built_in">console</span>.log(arr.includes(<span class="number">5</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><h4 id="5-includes"><a href="#5-includes" class="headerlink" title="5.includes()"></a>5.includes()</h4><p>includes(str, [position])  返回布尔值，表示是否找到了参数字符串</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello world&#x27;</span>.includes(<span class="string">&#x27;e&#x27;</span>, <span class="number">2</span>)); <span class="comment">// false 从位置2开始查找e，没有找到</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello world&#x27;</span>.includes(<span class="string">&#x27;e&#x27;</span>)); <span class="comment">// true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello world&#x27;</span>.startsWith(<span class="string">&#x27;h&#x27;</span>)); <span class="comment">// 未指定位置，看开头是否是h，返回true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello world&#x27;</span>.startsWith(<span class="string">&#x27;l&#x27;</span>, <span class="number">2</span>)); <span class="comment">// 指定位置的字符是l，返回true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello world&#x27;</span>.endsWith(<span class="string">&#x27;d&#x27;</span>)); <span class="comment">// 未指定位置，结尾是d，返回true</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;hello world&#x27;</span>.endsWith(<span class="string">&#x27;r&#x27;</span>, <span class="number">9</span>)); <span class="comment">// 指定位置的字符是r，返回true</span></span><br></pre></td></tr></table></figure><h4 id="6-repeat-方法"><a href="#6-repeat-方法" class="headerlink" title="6.repeat()方法"></a>6.repeat()方法</h4><p><code>repeat</code>方法返回一个新字符串，表示将原字符串重复<code>n</code>次。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">let</span> html = <span class="string">&#x27;&lt;li&gt;itheima&lt;/li&gt;&#x27;</span>;</span><br><span class="line">html = html.repeat(10);</span><br></pre></td></tr></table></figure><h2 id="五、新增对象Set"><a href="#五、新增对象Set" class="headerlink" title="五、新增对象Set"></a>五、新增对象Set</h2><p>数据结构 Set。它类似于数组，但是成员的值都是唯一的，没有重复的值。<br> <code>Set</code>本身是一个构造函数，用来生成 Set 数据结构。<br> Set的特点就是该对象里面的成员不会有重复。</p><p><strong>1.基本使用：</strong><br> <code>let set = new Set();</code> 得到一个空的Set对象。</p><p><strong>2.Set的成员</strong></p><ul><li><code>size</code>：属性，获取 <code>set</code> 中成员的个数，相当于数组中的 <code>length</code></li><li><code>add(value)</code>：添加某个值，返回 Set 结构本身。</li><li><code>delete(value)</code>：删除某个值，返回一个布尔值，表示删除是否成功。</li><li><code>has(value)</code>：返回一个布尔值，表示该值是否为<code>Set</code>的成员。</li><li><code>clear()</code>：清除所有成员，没有返回值。</li></ul><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="keyword">set</span> = <span class="keyword">new</span> Set();</span><br><span class="line"><span class="comment">//调用set对象内置的add方法，想set中添加数据。</span></span><br><span class="line"><span class="keyword">set</span>.<span class="keyword">add</span>(<span class="number">3</span>);</span><br><span class="line"><span class="keyword">set</span>.<span class="keyword">add</span>(<span class="number">8</span>);</span><br><span class="line"><span class="keyword">set</span>.<span class="keyword">add</span>(<span class="number">9</span>);</span><br><span class="line"><span class="keyword">set</span>.<span class="keyword">add</span>(<span class="number">3</span>); <span class="comment">//添加失败但不报错，set中的成员不能重复</span></span><br><span class="line">console.log(<span class="keyword">set</span>); <span class="comment">// &#123;3,8,9&#125;</span></span><br><span class="line">console.log(<span class="keyword">set</span>.size); <span class="comment">//3</span></span><br></pre></td></tr></table></figure><p>初始化Set的时候，也可以为其传入数组或字符串，得到的Set对象中的成员不会有重复。根据这个特点可以完成数组或字符串去重。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let set = new Set([4, 8, 9, 5, 4, 8, 4, 2]);</span><br><span class="line">console.log(set); //Set(5) &#123;4,8,9,5,2&#125;</span><br><span class="line">let arr = [...set]; //将set中的每个值展开，然后放到数组中</span><br><span class="line">console.log(arr); //(5) [4, 8, 9, 5, 2]</span><br><span class="line">let str = new Set(&#x27;abcdacbdcbac&#x27;); </span><br><span class="line">console.log(str); //Set(4) &#123;&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;&#125;</span><br><span class="line">console.log([...str].join(&#x27;&#x27;)); //abcd</span><br></pre></td></tr></table></figure><h2 id="六、promise"><a href="#六、promise" class="headerlink" title="六、promise"></a>六、promise</h2><p>Promise是异步编程的一种解决方案，它有三种状态，分别是<strong>pending-进行中</strong>、<strong>resolved-已完成</strong>、<strong>rejected-已失败</strong></p><p>当Promise的状态又pending转变为resolved或rejected时，会执行相应的方法，并且状态一旦改变，就无法再次改变状态，这也是它名字promise-承诺的由来</p><p>具体可看<a href="https://victory-na.github.io/2020/10/18/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-js-%E5%BC%B9%E6%80%A7%E7%9B%92/">promise详解</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ES6新增特性&quot;&gt;&lt;a href=&quot;#ES6新增特性&quot; class=&quot;headerlink&quot; title=&quot;ES6新增特性&quot;&gt;&lt;/a&gt;ES6新增特性&lt;/h1&gt;&lt;h2 id=&quot;一、let和const&quot;&gt;&lt;a href=&quot;#一、let和const&quot; class=&quot;he</summary>
      
    
    
    
    <category term="js" scheme="http://example.com/categories/js/"/>
    
    
    <category term="前端技术基础" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/"/>
    
    <category term="js" scheme="http://example.com/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>js-js数组常用方法</title>
    <link href="http://example.com/2020/09/02/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-js-%E6%95%B0%E7%BB%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <id>http://example.com/2020/09/02/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-js-%E6%95%B0%E7%BB%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95/</id>
    <published>2020-09-02T13:11:46.000Z</published>
    <updated>2024-02-28T01:45:52.899Z</updated>
    
    <content type="html"><![CDATA[<h1 id="js数组常用方法"><a href="#js数组常用方法" class="headerlink" title="js数组常用方法"></a>js数组常用方法</h1><h2 id="一、数组常用方法"><a href="#一、数组常用方法" class="headerlink" title="一、数组常用方法"></a>一、数组常用方法</h2><ul><li>concat()–合并数组</li><li>join()–使用分隔符将数组转为字符串</li><li>pop()–删除最后一位</li><li>shift()–删除第一位</li><li>unshift()–在第一位新增数据</li><li>push()–在最后一位新增数据</li><li>reverse()–反转数组</li><li>sort()–排序</li><li>slice()–截取指定位置的数组</li><li>splice()–删除指定位置，替换</li><li>toString()–直接转为字符串</li><li>IndexOf()–查询并返回数据的索引</li><li>forEach()–遍历数组</li><li>map()–遍历数组回调返回数据</li><li>filter()–过滤数组</li><li>every()–遍历数组，全部为true返回true</li><li>some()–遍历数组，只要有一个为true，返回true</li></ul><h2 id="二、数组常用方法解析"><a href="#二、数组常用方法解析" class="headerlink" title="二、数组常用方法解析"></a>二、数组常用方法解析</h2><h3 id="1、concat"><a href="#1、concat" class="headerlink" title="1、concat()"></a>1、concat()</h3><blockquote><p>功能：<strong>合并数组</strong>，可以合并一个或多个数组，会返回合并数组之后的数据，<strong>不会改变原来的数组</strong>；</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="string">&quot;hello&quot;</span>];<span class="keyword">var</span> str2 = [<span class="string">&quot;world&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.concat(str2));　　　　　　　　<span class="comment">//[12, 2, &quot;hello&quot;, &quot;world&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);　　　　　　　　　　　　　　　　<span class="comment">//[12,2,&quot;hello&quot;];</span></span><br></pre></td></tr></table></figure><h3 id="2、join"><a href="#2、join" class="headerlink" title="2、join()"></a>2、join()</h3><blockquote><p>功能：将数组转为字符串并返回转化的字符串数据，<strong>不会改变原来的数组；</strong></p></blockquote><p>注意：()中用双引号包括自己想用的分隔符，默认为逗号　</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="string">&quot;hello&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> str2 = [<span class="string">&quot;world&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.join(<span class="string">&quot;-&quot;</span>));　　　　　　　　<span class="comment">//12-2-hello</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);　　　　　　　　　　　　　　<span class="comment">//[12, 2, &quot;hello&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="3、pop"><a href="#3、pop" class="headerlink" title="3、pop()"></a>3、pop()</h3><blockquote><p>功能：<strong>删除数组的最后一位</strong>，并且<strong>返回删除的数据，会改变原来的数组</strong></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="string">&quot;hello&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.pop()　　　　　　　　<span class="comment">//hello</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);　　　　　　　　　　<span class="comment">//[12, 2]</span></span><br></pre></td></tr></table></figure><h3 id="4、shift"><a href="#4、shift" class="headerlink" title="4、shift()"></a>4、shift()</h3><blockquote><p>功能：<strong>删除数组的第一位数据</strong>，并且<strong>返回删除的数据，会改变原来的数组</strong>。</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="string">&quot;hello&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.shift()　　　　　　　　<span class="comment">//hello</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);　　　　　　　　　　<span class="comment">//[2,&quot;hello&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="5、unshift"><a href="#5、unshift" class="headerlink" title="5、unshift()"></a>5、unshift()</h3><blockquote><p>功能：在数组的<strong>首位新增一个或多数据</strong>，并且<strong>返回新数组的长度，会改变原来的数组</strong></p></blockquote><p>注意：<code>unshift()</code>方法返回的数据是新数组的长度，它增加的数据可以是一个也可以是多个，可以理解为增加一连串的数据，</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="string">&quot;hello&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> str2 = [<span class="number">43</span>,<span class="number">2</span>,<span class="string">&quot;test&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.unshift(<span class="string">&quot;你好&quot;</span>));　　　　　　　　　　　　　　<span class="comment">//4</span></span><br><span class="line"><span class="built_in">console</span>.log(str2.unshift(<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;world&quot;</span>));　　　　　　　　<span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);　　　　　　　　　　　　　　　　　　　　　　　<span class="comment">//[&quot;你好&quot;, 12, 2, &quot;hello&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(str2);　　　　　　　　　　　　　　　　　　　　　　　<span class="comment">//[&quot;hello&quot;, &quot;world&quot;, 43, 2, &quot;test&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="6、push"><a href="#6、push" class="headerlink" title="6、push()"></a>6、push()</h3><blockquote><p>功能：在数组的最后一位新增一个或多个数据，并且返回新数组的长度，会改变原来的数组</p></blockquote><p>注意：push()方法返回的是数据是新数组的长度，它增加的数据可以是一个也可以是多个，可以理解为增加一连串的数据。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="string">&quot;hello&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> str2 = [<span class="number">43</span>,<span class="number">2</span>,<span class="string">&quot;test&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.push(<span class="string">&quot;你好&quot;</span>));　　　　　　　　　　<span class="comment">//4</span></span><br><span class="line"><span class="built_in">console</span>.log(str2.push(<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;world&quot;</span>));　　　　<span class="comment">//5</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);　　　　　　　　　　　　　　　　　<span class="comment">//[12, 2, &quot;hello&quot;,&quot;你好&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(str2);　　　　　　　　　　　　　　　　　<span class="comment">//[43, 2, &quot;test&quot;,&quot;hello&quot;, &quot;world&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="7、reverse"><a href="#7、reverse" class="headerlink" title="7、reverse()"></a>7、reverse()</h3><blockquote><p>功能：将数组的数据进行反转，并且返回反转后的数组，会改变原数组</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="string">&quot;hello&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.reverse());　　　　　　<span class="comment">//[&quot;hello&quot;, 2, 12]</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);　　　　　　　　　　　　<span class="comment">//[&quot;hello&quot;, 2, 12]</span></span><br></pre></td></tr></table></figure><h3 id="8、sort"><a href="#8、sort" class="headerlink" title="8、sort()"></a>8、sort()</h3><blockquote><p>功能：对数组内的数据进行排序(默认为升序)，并且返回排过序的新数组，会改变原来的数组</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str1 = [<span class="number">12</span>,<span class="number">2</span>,<span class="number">43</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">var</span> str2 = [<span class="number">92</span>,<span class="number">2</span>,<span class="number">43</span>,<span class="string">&quot;hello&quot;</span>,<span class="string">&#x27;zoom&#x27;</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">5</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str1.sort());<span class="comment">//[12, 2, 2, 43, 5, 5]</span></span><br><span class="line"><span class="built_in">console</span>.log(str1);<span class="comment">//[12, 2, 2, 43, 5, 5]</span></span><br><span class="line"><span class="built_in">console</span>.log(str2.sort());<span class="comment">//[2, 2, 43, 5, 5, 92, &quot;abc&quot;, &quot;hello&quot;, &quot;zoom&quot;]</span></span><br><span class="line"><span class="built_in">console</span>.log(str2);<span class="comment">//[2, 2, 43, 5, 5, 92, &quot;abc&quot;, &quot;hello&quot;, &quot;zoom&quot;]</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>这里的排序是<code>针对字符的排序</code>，先使用数组的<code>toString()</code>方法转为字符串，再逐位比较，3是大于12的，因为首位<code>3&gt;1</code>，不要与<code>Number</code>型的数据排序混淆</li><li><code>str2</code>数组中增加了三个字符，可以看到，比较的时候，<code>zoom</code>是最大的，因为首位的英文字母通过<code>ASCII</code>码可以转为相应的数值，再根据数值比较</li><li>排序问题</li></ul><p>参数：<code>sort(callback)</code> 如果需要按照数值排序，需要传参。<code>sort(callback)</code>，<code>callback</code>为回调函数，该函数应该具有两个参数，比较这两个参数，然后返回一个用于说明这两个值的相对顺序的数字<code>（a-b）</code>。其返回值如下：</p><p>若 a 小于 b，返回一个小于 0 的值。</p><p>若 a 等于 b，则返回 0。</p><p>若 a 大于 b，则返回一个大于 0 的值。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str3 = [<span class="number">92</span>,<span class="number">2</span>,<span class="number">43</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">5</span>];     </span><br><span class="line"><span class="built_in">console</span>.log(str3.sort(fn));　　　　　　　　　　　　　　　　　<span class="comment">//[2, 2, 5, 5, 43, 92]</span></span><br><span class="line"><span class="built_in">console</span>.log(str3);　　　　　　　　　　　　　　　　　　　　　　<span class="comment">//[2, 2, 5, 5, 43, 92]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span> (<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">　　　　<span class="keyword">return</span> a-b;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="9、slice"><a href="#9、slice" class="headerlink" title="9、slice()"></a>9、slice()</h3><blockquote><p>功能：截取指定位置的数组，并且返回截取的数组，不会改变原数组</p></blockquote><p>参数：<code>slice(startIndex, endIndex)</code></p><p>注意：可从已有的数组中返回选定的元素。该方法接收两个参数<code>slice(start,end)</code>，<code>stsrt</code>为必选，表示从第几位开始；<code>end</code>为可选，表示到第几位结束(不包含end位)，省略表示到最后一位；start和end都可以为负数，负数时表示从最后一位开始算起，如-1表示最后一位。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;T1&quot;</span>,<span class="string">&quot;J1&quot;</span>,<span class="string">&quot;L1&quot;</span>,<span class="string">&quot;L2&quot;</span>,<span class="string">&quot;M1&quot;</span>];</span><br><span class="line">    <span class="built_in">console</span>.log(arr.slice(<span class="number">1</span>,<span class="number">3</span>));        <span class="comment">//[&quot;J1&quot;,&quot;L1&quot;]</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr.slice(<span class="number">1</span>));          <span class="comment">//[&quot;J1&quot;,&quot;L1&quot;,&quot;L2&quot;,&quot;M1&quot;]</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr.slice(-<span class="number">4</span>,-<span class="number">1</span>));      <span class="comment">//[&quot;J1&quot;,&quot;L1&quot;,&quot;L2&quot;]</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr.slice(-<span class="number">2</span>));         <span class="comment">//[&quot;Lily&quot;,&quot;M1&quot;]</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr.slice(<span class="number">1</span>,-<span class="number">2</span>));       <span class="comment">//[&quot;J1&quot;,&quot;L1&quot;]</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr);                   <span class="comment">//[&quot;T1&quot;,&quot;J1&quot;,&quot;L1&quot;,&quot;L2&quot;,&quot;M1&quot;]</span></span><br></pre></td></tr></table></figure><h3 id="10、splice"><a href="#10、splice" class="headerlink" title="10、splice()"></a>10、splice()</h3><blockquote><p>功能：向数组中添加，或从数组删除，或替换数组中的元素，然后返回被删除/替换的元素。</p></blockquote><p>参数：<code>splice(start,num,data1,data2,...)</code>; 所有参数全部可选。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr.splice(<span class="number">2</span>,<span class="number">0</span>,<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>));<span class="comment">//[]</span></span><br><span class="line"><span class="built_in">console</span>.log(arr);<span class="comment">//[&quot;Tom&quot;, &quot;Jack&quot;, &quot;a&quot;, &quot;b&quot;, &quot;Lucy&quot;, &quot;Lily&quot;, &quot;May&quot;]---原数组改变</span></span><br></pre></td></tr></table></figure><h3 id="11、toString"><a href="#11、toString" class="headerlink" title="11、toString()"></a>11、toString()</h3><blockquote><p>功能：将数组转换成字符串，<code>类似于没有参数的join()</code>。该方法会在数据发生隐式类型转换时被自动调用，如果手动调用，就是直接转为字符串。不会改变原数组</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(str.toString()); <span class="comment">//1,2,3</span></span><br><span class="line"><span class="built_in">console</span>.log(str);<span class="comment">//[1,2,3]</span></span><br></pre></td></tr></table></figure><h3 id="12、IndexOf"><a href="#12、IndexOf" class="headerlink" title="12、IndexOf()"></a>12、IndexOf()</h3><blockquote><p>功能：根据指定的数据，从左向右，查询在数组中出现的位置，如果不存在指定的数据，返回-1，找到了指定的数据返回该数据的索引</p></blockquote><p>参数：indexOf(value, start);value为要查询的数据；start为可选，表示开始查询的位置，当start为负数时，从数组的尾部向前数；如果查询不到value的存在，则方法返回-1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">注意：如果找到该数据，立即返回该数据的索引，不再往后继续查找</span><br><span class="line">var str = [&quot;h&quot;,&quot;e&quot;,&quot;l&quot;,&quot;l&quot;,&quot;o&quot;];</span><br><span class="line"> console.log(str.indexOf(&quot;l&quot;));        //2</span><br><span class="line"> console.log(str.indexOf(&quot;l&quot;,3));      //3</span><br><span class="line"> console.log(str.indexOf(&quot;l&quot;,4));      //-1</span><br><span class="line"> console.log(str.indexOf(&quot;l&quot;,-1));     //-1</span><br><span class="line"> console.log(str.indexOf(&quot;l&quot;,-3));     //2</span><br></pre></td></tr></table></figure><h3 id="13、forEach"><a href="#13、forEach" class="headerlink" title="13、forEach()"></a>13、forEach()</h3><blockquote><p>功能：ES5新增的方法，用来遍历数组，没有返回值，</p></blockquote><p>参数：forEach(callback);callback默认有三个参数，分别为value(遍历到的数组的数据)，index(对应的索引)，self(数组自身)。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line"><span class="keyword">var</span> a = arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">     <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr === self));</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// 打印结果为：</span></span><br><span class="line"><span class="comment">// Tom--0--true</span></span><br><span class="line"><span class="comment">// Jack--1--true</span></span><br><span class="line"><span class="comment">// Lucy--2--true</span></span><br><span class="line"><span class="comment">// Lily--3--true</span></span><br><span class="line"><span class="comment">// May--4--true</span></span><br><span class="line"><span class="built_in">console</span>.log(a);     <span class="comment">//undefined---forEach没有返回值</span></span><br><span class="line"><span class="comment">//该方法为遍历方法，不会修改原数组</span></span><br></pre></td></tr></table></figure><h3 id="14、map"><a href="#14、map" class="headerlink" title="14、map()"></a>14、map()</h3><blockquote><p>功能：同forEach功能；map的回调函数会将执行结果返回，最后map将所有回调函数的返回值组成新数组返回。</p></blockquote><p>参数：<code>map(callback)</code>;callback默认有三个参数，分别为<code>value，index，self</code>。跟上面的forEach()的参数一样</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//功能1：同forEach</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr === self))</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line">    <span class="comment">// Jack--1--true</span></span><br><span class="line">    <span class="comment">// Lucy--2--true</span></span><br><span class="line">    <span class="comment">// Lily--3--true</span></span><br><span class="line">    <span class="comment">// May--4--true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//功能2：每次回调函数的返回值被map组成新数组返回</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.map(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hi:&quot;</span>+value;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(a);     <span class="comment">//[&quot;hi:Tom&quot;, &quot;hi:Jack&quot;, &quot;hi:Lucy&quot;, &quot;hi:Lily&quot;, &quot;hi:May&quot;]</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr);   <span class="comment">//[&quot;Tom&quot;, &quot;Jack&quot;, &quot;Lucy&quot;, &quot;Lily&quot;, &quot;May&quot;]---原数组未改变</span></span><br></pre></td></tr></table></figure><h3 id="15、filter"><a href="#15、filter" class="headerlink" title="15、filter()"></a>15、filter()</h3><blockquote><p>功能： 1.同forEach功能； 2.<code>filter的回调函数需要返回布尔值，当为true时，将本次数组的数据返回给filter，最后filter将所有回调函数的返回值组成新数组返回（此功能可理解为“过滤”）</code>。</p></blockquote><p>参数：filter(callback);callback默认有三个参数，分别为value，index，self。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//功能1：同forEach</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.filter(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr === self))</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line">    <span class="comment">// Jack--1--true</span></span><br><span class="line">    <span class="comment">// Lucy--2--true</span></span><br><span class="line">    <span class="comment">// Lily--3--true</span></span><br><span class="line">    <span class="comment">// May--4--true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//功能2：当回调函数的返回值为true时，本次的数组值返回给filter，被filter组成新数组返回</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.filter(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.length &gt; <span class="number">3</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(a);         <span class="comment">//[&quot;Jack&quot;, &quot;Lucy&quot;, &quot;Lily&quot;]</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr);       <span class="comment">//[&quot;Tom&quot;, &quot;Jack&quot;, &quot;Lucy&quot;, &quot;Lily&quot;, &quot;May&quot;]---原数组未改变</span></span><br></pre></td></tr></table></figure><h3 id="16、every"><a href="#16、every" class="headerlink" title="16、every()"></a>16、every()</h3><blockquote><p>功能：<code>判断数组中每一项是否都满足条件，只有所有项都满足条件，才会返回true</code>。</p></blockquote><p>参数：every()接收一个回调函数作为参数，这个回调函数需要有返回值，every(callback);callback默认有三个参数，分别为value，index，self。</p><p>注：1、当回调函数的返回值为true时，类似于forEach的功能，遍历所有；如果为false，那么停止执行，后面的        数据不再遍历，<code>停在第一个返回false的位置</code>。</p><p>​        2、当每个回调函数的返回值都为true时，every的返回值为true，只要有一个回调函数的返回值为false，        every的返回值都为false</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo1:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.every(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr == self))</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line">    <span class="comment">//因为回调函数中没有return true，默认返回undefined，等同于返回false</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//demo2:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.every(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr == self))</span><br><span class="line">        <span class="keyword">return</span> value.length &lt; <span class="number">4</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line">    <span class="comment">// abc--1--true</span></span><br><span class="line">    <span class="comment">// Jack--2--true</span></span><br><span class="line">    <span class="comment">//因为当遍历到Jack时，回调函数到return返回false，此时Jack已经遍历，但是后面数据就不再被遍历了</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//demo3:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.every(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr == self))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line">    <span class="comment">// abc--1--true</span></span><br><span class="line">    <span class="comment">// Jack--2--true</span></span><br><span class="line">    <span class="comment">// Lucy--3--true</span></span><br><span class="line">    <span class="comment">// Lily--4--true</span></span><br><span class="line">    <span class="comment">// May--5--true</span></span><br><span class="line">    <span class="comment">//因为每个回调函数的返回值都是true，那么会遍历数组所有数据，等同于forEach功能</span></span><br></pre></td></tr></table></figure><h3 id="17、some"><a href="#17、some" class="headerlink" title="17、some()"></a>17、some()</h3><blockquote><p>功能：<code>判断数组中是否存在满足条件的项，只要有一项满足条件，就会返回true</code>。</p></blockquote><p>参数：some()接收一个回调函数作为参数，这个回调函数需要有返回值，some(callback);callback默认有三个参数，分别为value，index，self。</p><p>功能1：因为要判断数组中的每一项，只要有一个回调函数返回true，some都会返回true，所以与every正好相反，当遇到一个回调函数的返回值为true时，可以确定结果，那么停止执行，后面都数据不再遍历，停在第一个返回true的位置；当回调函数的返回值为false时，需要继续向后执行，到最后才能确定结果，所以会遍历所有数据，实现类似于forEach的功能，遍历所有。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo1:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr == self))</span><br><span class="line">        <span class="keyword">return</span> value.length &gt; <span class="number">3</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line">    <span class="comment">// abc--1--true</span></span><br><span class="line">    <span class="comment">// Jack--2--true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//demo2:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr == self))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//demo3:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(value + <span class="string">&quot;--&quot;</span> + index + <span class="string">&quot;--&quot;</span> + (arr == self))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 打印结果为：</span></span><br><span class="line">    <span class="comment">// Tom--0--true</span></span><br><span class="line">    <span class="comment">// abc--1--true</span></span><br><span class="line">    <span class="comment">// Jack--2--true</span></span><br><span class="line">    <span class="comment">// Lucy--3--true</span></span><br><span class="line">    <span class="comment">// Lily--4--true</span></span><br><span class="line">    <span class="comment">// May--5--true</span></span><br></pre></td></tr></table></figure><p>功能2：与every相反，只要有一个回调函数的返回值都为true，some的返回值为true，所有回调函数的返回值为false，some的返回值才为false</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo1:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.length &gt; <span class="number">3</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(a);             <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//demo2:</span></span><br><span class="line">    <span class="keyword">var</span> arr = [<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Lucy&quot;</span>,<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;May&quot;</span>];</span><br><span class="line">    <span class="keyword">var</span> a = arr.some(<span class="function"><span class="keyword">function</span>(<span class="params">value,index,self</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value.length &gt; <span class="number">4</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="built_in">console</span>.log(a);             <span class="comment">//false</span></span><br></pre></td></tr></table></figure><h2 id="三、哪些数组方法会改变原数组"><a href="#三、哪些数组方法会改变原数组" class="headerlink" title="三、哪些数组方法会改变原数组"></a>三、哪些数组方法会改变原数组</h2><p>unshift();</p><p>push()；</p><p>shift();</p><p>pop();</p><p>sort();</p><p>reverse();</p><p>splice();</p><p>这七个数组方法在上面都有过介绍了，可以看出，再用这些方法的时候，原数组是会被改变的。</p><h2 id="四、js数组去重常用方法总结"><a href="#四、js数组去重常用方法总结" class="headerlink" title="四、js数组去重常用方法总结"></a>四、js数组去重常用方法总结</h2><h3 id="1、简单数组去重（IE8以下不支持数组的indexOf-方法）"><a href="#1、简单数组去重（IE8以下不支持数组的indexOf-方法）" class="headerlink" title="1、简单数组去重（IE8以下不支持数组的indexOf()方法）"></a>1、简单数组去重（IE8以下不支持数组的indexOf()方法）</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isDuplicate</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> temp = []   <span class="comment">//临时数组</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (temp.indexOf(arr[i]) == -<span class="number">1</span>) &#123;</span><br><span class="line">      temp.push(arr[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> temp</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> array = [<span class="number">12</span>, <span class="number">87</span>, <span class="number">45</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">9</span>];</span><br><span class="line"><span class="built_in">console</span>.log(isDuplicate(array));  <span class="comment">//[12, 87, 45, 9, 8, 3]</span></span><br></pre></td></tr></table></figure><h3 id="2、数组键值对去重"><a href="#2、数组键值对去重" class="headerlink" title="2、数组键值对去重"></a>2、数组键值对去重</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [&#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;01&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;张三&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;02&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;李四&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;03&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;王二&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;04&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;李四&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">var</span> result = [], obj = &#123;&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!obj[arr[i].key]) &#123;</span><br><span class="line">    result.push(arr[i])</span><br><span class="line">    obj[arr[i].key] = <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(result); <span class="comment">// [ &#123;key: &#x27;01&#x27;,value: &#x27;张三&#x27;&#125;, &#123;key: &#x27;02&#x27;,value: &#x27;李四&#x27;&#125;, &#123;key: &#x27;03&#x27;,value: &#x27;王二&#x27;&#125;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3、利用reduce方法遍历数组"><a href="#3、利用reduce方法遍历数组" class="headerlink" title="3、利用reduce方法遍历数组"></a>3、利用reduce方法遍历数组</h3><p>reduce第一个参数是遍历需要执行的函数，第二个参数是item的初始值</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [&#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;01&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;张三&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;02&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;李四&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;03&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;王二&#x27;</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">  <span class="attr">key</span>: <span class="string">&#x27;04&#x27;</span>,</span><br><span class="line">  <span class="attr">value</span>: <span class="string">&#x27;李四&#x27;</span></span><br><span class="line">&#125;];</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line">arr = arr.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">item, next</span>) </span>&#123;</span><br><span class="line">  obj[next.key] ? <span class="string">&#x27;&#x27;</span> : obj[next.key] = <span class="literal">true</span> &amp;&amp; item.push(next)</span><br><span class="line">  <span class="keyword">return</span> item</span><br><span class="line">&#125;, []);</span><br><span class="line"><span class="built_in">console</span>.log(arr);  <span class="comment">// [ &#123;key: &#x27;01&#x27;,value: &#x27;张三&#x27;&#125;, &#123;key: &#x27;02&#x27;,value: &#x27;李四&#x27;&#125;, &#123;key: &#x27;03&#x27;,value: &#x27;王二&#x27;&#125;]</span></span><br></pre></td></tr></table></figure><h3 id="4、利用js的filter方法"><a href="#4、利用js的filter方法" class="headerlink" title="4、利用js的filter方法"></a>4、利用js的filter方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">6</span>];</span><br><span class="line"><span class="keyword">var</span> newArr = arr.filter(<span class="function">(<span class="params">items, index, arry</span>) =&gt;</span> &#123; <span class="comment">//按照条件过滤，返回满足条件的新数组</span></span><br><span class="line">  <span class="keyword">return</span> arry.indexOf(items) === index <span class="comment">//过滤掉下标相同的值</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(newArr) <span class="comment">// [5, 6, 8]</span></span><br></pre></td></tr></table></figure><h3 id="5、利用-ES6的set-方法"><a href="#5、利用-ES6的set-方法" class="headerlink" title="5、利用 ES6的set 方法"></a>5、利用 ES6的set 方法</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">6</span>];</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr))); <span class="comment">// 利用Array.from将Set结构转换成数组// [5, 6, 8]</span></span><br></pre></td></tr></table></figure><p>[…new Set(array)] 也可以粗暴直接使用</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;js数组常用方法&quot;&gt;&lt;a href=&quot;#js数组常用方法&quot; class=&quot;headerlink&quot; title=&quot;js数组常用方法&quot;&gt;&lt;/a&gt;js数组常用方法&lt;/h1&gt;&lt;h2 id=&quot;一、数组常用方法&quot;&gt;&lt;a href=&quot;#一、数组常用方法&quot; class=&quot;head</summary>
      
    
    
    
    <category term="js" scheme="http://example.com/categories/js/"/>
    
    
    <category term="前端技术基础" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/"/>
    
    <category term="js" scheme="http://example.com/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>css-css3新增</title>
    <link href="http://example.com/2020/07/30/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-css-CSS3%E6%96%B0%E5%A2%9E/"/>
    <id>http://example.com/2020/07/30/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80-css-CSS3%E6%96%B0%E5%A2%9E/</id>
    <published>2020-07-30T10:51:06.000Z</published>
    <updated>2024-02-28T01:45:43.870Z</updated>
    
    <content type="html"><![CDATA[<p>@<a href="css">css3新增</a></p><blockquote><p>css3新增的属性大概有以下几类</p><p>1、新增了一些边框属性</p><p>2、新增背景属性</p><p>3、新增了一些文字效果</p><p>4、新增动画效果</p><p>4、新增过渡效果</p></blockquote><h1 id="css3新增边框属性"><a href="#css3新增边框属性" class="headerlink" title="css3新增边框属性"></a>css3新增边框属性</h1><p>border-clolor</p><p>border-image</p><p>border-radius</p><p>box-shadow</p><h1 id="css3新增背景属性"><a href="#css3新增背景属性" class="headerlink" title="css3新增背景属性"></a>css3新增背景属性</h1><p>background-size</p><p>background-origin</p><p>background-clip</p><h1 id="css3新增文字效果"><a href="#css3新增文字效果" class="headerlink" title="css3新增文字效果"></a>css3新增文字效果</h1><ul><li>text-shadow</li><li>word-wrap</li></ul><h1 id="css3新增动画效果"><a href="#css3新增动画效果" class="headerlink" title="css3新增动画效果"></a>css3新增动画效果</h1><p>transform</p><p>animation</p><h1 id="css3新增过渡"><a href="#css3新增过渡" class="headerlink" title="css3新增过渡"></a>css3新增过渡</h1><p>transition</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;@&lt;a href=&quot;css&quot;&gt;css3新增&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;css3新增的属性大概有以下几类&lt;/p&gt;
&lt;p&gt;1、新增了一些边框属性&lt;/p&gt;
&lt;p&gt;2、新增背景属性&lt;/p&gt;
&lt;p&gt;3、新增了一些文字效果&lt;/p&gt;
&lt;p&gt;4、新增动画效果&lt;/p&gt;
</summary>
      
    
    
    
    <category term="css" scheme="http://example.com/categories/css/"/>
    
    
    <category term="前端技术基础" scheme="http://example.com/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF%E5%9F%BA%E7%A1%80/"/>
    
    <category term="css" scheme="http://example.com/tags/css/"/>
    
  </entry>
  
</feed>
